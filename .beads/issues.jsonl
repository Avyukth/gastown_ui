{"id":"gu-034d","title":"Implement Known Bug Detection system","description":"# Known Bug Detection System\n\n## Background\nThe Known Bug Detection system identifies common CLI errors and provides user-friendly\nmessages with specific workarounds. This is CRITICAL for good UX.\n\n## Why This Matters\nInstead of showing raw stderr like:\n```\nError: command failed with exit code 1\n```\n\nWe show:\n```\nMail inbox unavailable (daemon not running)\nWorkaround: Run 'gt start' to start the daemon, then retry.\n```\n\n## Implementation\n\n### Known Bugs Registry\n```typescript\n// src/lib/errors/known-bugs.ts\n\nexport interface KnownBug {\n  id: string;\n  pattern: RegExp | string;\n  category: ErrorCategory;\n  userMessage: string;\n  workaround: string;\n  ticketUrl?: string;\n  addedInVersion?: string;\n}\n\nexport type ErrorCategory = \n  | 'KNOWN_BUG'\n  | 'CLI_ERROR'\n  | 'NETWORK'\n  | 'PARSE_ERROR'\n  | 'TIMEOUT'\n  | 'AUTH'\n  | 'UNKNOWN';\n\nexport const KNOWN_BUGS: KnownBug[] = [\n  {\n    id: 'mail-inbox-daemon',\n    pattern: /gt mail inbox.*daemon.*not running/i,\n    category: 'KNOWN_BUG',\n    userMessage: 'Mail inbox unavailable (daemon not running)',\n    workaround: \"Run 'gt start' to start the daemon, then retry.\",\n  },\n  {\n    id: 'rig-add-timeout',\n    pattern: /gt rig add.*timed out|clone.*timeout/i,\n    category: 'TIMEOUT',\n    userMessage: 'Rig add timed out (large repository)',\n    workaround: 'Try again - large repos can take several minutes.',\n  },\n  {\n    id: 'beads-database-locked',\n    pattern: /database.*locked|SQLITE_BUSY/i,\n    category: 'KNOWN_BUG',\n    userMessage: 'Database is locked by another process',\n    workaround: 'Wait a moment and retry. If persistent, restart the daemon.',\n  },\n  {\n    id: 'network-unreachable',\n    pattern: /network.*unreachable|ECONNREFUSED|ETIMEDOUT/i,\n    category: 'NETWORK',\n    userMessage: 'Network connection failed',\n    workaround: 'Check your internet connection and try again.',\n  },\n  {\n    id: 'json-parse-error',\n    pattern: /unexpected token|JSON.*parse|invalid JSON/i,\n    category: 'PARSE_ERROR',\n    userMessage: 'Invalid response from CLI',\n    workaround: 'This may be a CLI version mismatch. Check gt --version.',\n  },\n  {\n    id: 'auth-expired',\n    pattern: /authentication.*expired|401|not authorized/i,\n    category: 'AUTH',\n    userMessage: 'Authentication required',\n    workaround: 'Sign in again to continue.',\n  },\n  // Add more known bugs as discovered\n];\n```\n\n### Detection Functions\n```typescript\nexport function identifyKnownBug(errorMessage: string): KnownBug | null {\n  for (const bug of KNOWN_BUGS) {\n    const pattern = typeof bug.pattern === 'string' \n      ? new RegExp(bug.pattern, 'i')\n      : bug.pattern;\n    \n    if (pattern.test(errorMessage)) {\n      return bug;\n    }\n  }\n  return null;\n}\n\nexport function getErrorCategory(error: Error | string): {\n  category: ErrorCategory;\n  defaultMessage: string;\n  suggestedAction: string;\n  icon: string;\n} {\n  const message = typeof error === 'string' ? error : error.message;\n  const bug = identifyKnownBug(message);\n  \n  if (bug) {\n    return {\n      category: bug.category,\n      defaultMessage: bug.userMessage,\n      suggestedAction: bug.workaround,\n      icon: CATEGORY_ICONS[bug.category]\n    };\n  }\n  \n  // Fallback categorization\n  if (/timeout/i.test(message)) {\n    return {\n      category: 'TIMEOUT',\n      defaultMessage: 'Request timed out',\n      suggestedAction: 'Try again in a moment',\n      icon: '‚è±Ô∏è'\n    };\n  }\n  \n  // ... more fallbacks\n  \n  return {\n    category: 'UNKNOWN',\n    defaultMessage: 'Something went wrong',\n    suggestedAction: 'Please try again',\n    icon: '‚ùå'\n  };\n}\n\nconst CATEGORY_ICONS: Record\u003cErrorCategory, string\u003e = {\n  KNOWN_BUG: 'üêõ',\n  CLI_ERROR: '‚ö†Ô∏è',\n  NETWORK: 'üåê',\n  PARSE_ERROR: 'üìÑ',\n  TIMEOUT: '‚è±Ô∏è',\n  AUTH: 'üîê',\n  UNKNOWN: '‚ùå'\n};\n```\n\n### Integration with API Routes\n```typescript\n// In API route error handling:\nimport { identifyKnownBug, getErrorCategory } from '$lib/errors/known-bugs';\n\ncatch (error) {\n  const bug = identifyKnownBug(error.message);\n  const category = getErrorCategory(error);\n  \n  return json({\n    error: {\n      code: bug?.id ?? 'UNKNOWN',\n      message: category.defaultMessage,\n      category: category.category,\n      details: {\n        stderr: error.stderr,\n        command: error.command\n      },\n      recoverable: category.category !== 'AUTH',\n      suggestedAction: category.suggestedAction,\n      knownBug: bug?.id\n    }\n  }, { status: mapCategoryToStatus(category.category) });\n}\n```\n\n## Acceptance Criteria\n- [ ] Known bugs registry with 6+ entries\n- [ ] Pattern matching for error messages\n- [ ] User-friendly messages for each category\n- [ ] Workaround suggestions\n- [ ] Category icons for UI\n- [ ] Integration with API error responses\n- [ ] Unit tests for pattern matching\n- [ ] Easy to add new known bugs\n\n## Files\n- src/lib/errors/known-bugs.ts\n- src/lib/errors/categories.ts\n- src/lib/errors/index.ts\n- src/lib/errors/__tests__/known-bugs.test.ts\n\n## References\n- INTEGRATION_PLAN: Known Bug Detection section\n- Error Boundary integration (gu-gj4)","status":"open","priority":1,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-13T01:04:34.345167+05:30","created_by":"Avyukth","updated_at":"2026-01-13T01:04:34.345167+05:30","labels":["layer:foundation","phase:1","priority:critical"]}
{"id":"gu-0bz","title":"Implement List Virtualization for long lists","description":"# List Virtualization\n\nImplements virtual scrolling for lists with 100+ items to maintain 60fps.\n\n## Implementation\n\nUse `svelte-virtual-list` or custom implementation:\n\n```svelte\n\u003c!-- src/lib/components/VirtualList.svelte --\u003e\n\u003cscript lang=\"ts\"\u003e\n  import type { Snippet } from \"svelte\";\n  \n  interface Props\u003cT\u003e {\n    items: T[];\n    itemHeight: number;\n    overscan?: number;\n    children: Snippet\u003c[item: T, index: number]\u003e;\n  }\n  \n  let { items, itemHeight, overscan = 3, children }: Props\u003cT\u003e = $props();\n  \n  let container: HTMLElement;\n  let scrollTop = $state(0);\n  let containerHeight = $state(0);\n  \n  const visibleRange = $derived(() =\u003e {\n    const start = Math.max(0, Math.floor(scrollTop / itemHeight) - overscan);\n    const end = Math.min(\n      items.length,\n      Math.ceil((scrollTop + containerHeight) / itemHeight) + overscan\n    );\n    return { start, end };\n  });\n  \n  const visibleItems = $derived(\n    items.slice(visibleRange.start, visibleRange.end)\n  );\n  \n  const totalHeight = $derived(items.length * itemHeight);\n  const offsetY = $derived(visibleRange.start * itemHeight);\n\u003c/script\u003e\n\n\u003cdiv\n  bind:this={container}\n  bind:clientHeight={containerHeight}\n  onscroll={() =\u003e scrollTop = container.scrollTop}\n  class=\"virtual-container\"\n\u003e\n  \u003cdiv style=\"height: {totalHeight}px; position: relative;\"\u003e\n    \u003cdiv style=\"transform: translateY({offsetY}px);\"\u003e\n      {#each visibleItems as item, i}\n        {@render children(item, visibleRange.start + i)}\n      {/each}\n    \u003c/div\u003e\n  \u003c/div\u003e\n\u003c/div\u003e\n```\n\n## Usage\n\n```svelte\n\u003cVirtualList items={beads} itemHeight={72}\u003e\n  {#snippet children(bead, index)}\n    \u003cBeadCard {bead} /\u003e\n  {/snippet}\n\u003c/VirtualList\u003e\n```\n\n## Performance Targets\n\n- 60fps scroll at 10,000 items\n- \u003c 16ms paint time\n- No jank on mobile\n\n## Apply To\n\n- Work items list\n- Agent list\n- Event feed\n- Queue view\n\n## Tests\n\n- Unit: Range calculations\n- Performance: 10k item scroll benchmark\n- Visual: No flicker during scroll\n\n\n(Moved from hq-e56)","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-12T23:12:54.069373+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:12:54.069373+05:30","labels":["layer:perf","phase:1"]}
{"id":"gu-0hi","title":"Implement /api/gastown/workflows endpoints","description":"# Workflows Endpoints\n\nImplements the `/api/gastown/workflows` routes for multi-step workflow orchestration.\n\n## Routes\n\n### GET /api/gastown/workflows\nList active workflows.\n\n### POST /api/gastown/workflows\nCreate new workflow (e.g., \"merge-and-deploy\").\n\n### GET /api/gastown/workflows/[id]\nGet workflow status and steps.\n\n### POST /api/gastown/workflows/[id]/retry\nRetry a failed workflow step.\n\n## Implementation\n\n```typescript\n// src/routes/api/gastown/workflows/+server.ts\nexport const GET: RequestHandler = async ({ url }) =\u003e {\n  const workflows = await workflowsStore.list({\n    status: url.searchParams.get(\"status\") as WorkflowStatus\n  });\n  return json({ data: workflows });\n};\n\nexport const POST: RequestHandler = async ({ request }) =\u003e {\n  const body = await request.json();\n  const parsed = CreateWorkflowSchema.safeParse(body);\n  \n  if (!parsed.success) {\n    throw error(400, { errors: parsed.error.issues });\n  }\n  \n  const workflow = await workflowsStore.create(parsed.data);\n  return json({ data: workflow }, { status: 201 });\n};\n```\n\n## Schemas\n\n```typescript\nexport const WorkflowStepSchema = z.object({\n  id: z.string(),\n  name: z.string(),\n  status: z.enum([\"pending\", \"running\", \"completed\", \"failed\", \"skipped\"]),\n  duration: z.number().optional(),\n  output: z.unknown().optional()\n});\n\nexport const WorkflowSchema = z.object({\n  id: z.string().uuid(),\n  name: z.string(),\n  type: z.enum([\"merge-deploy\", \"test-merge\", \"full-ci\"]),\n  status: z.enum([\"pending\", \"running\", \"completed\", \"failed\"]),\n  steps: z.array(WorkflowStepSchema),\n  createdAt: z.string().datetime(),\n  completedAt: z.string().datetime().nullable()\n});\n\nexport const CreateWorkflowSchema = z.object({\n  type: WorkflowSchema.shape.type,\n  params: z.record(z.unknown()).optional()\n});\n```\n\n## Tests\n\n- Unit: Workflow state machine transitions\n- Integration: Full workflow execution\n\n\n(Moved from hq-mgo)","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-12T23:12:54.275556+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:12:54.275556+05:30","labels":["layer:api","phase:1"]}
{"id":"gu-0pq3","title":"Implement Dashboard page component","description":"# Dashboard Page Component\n\n## Background\nThe Dashboard is the main landing page showing system health, recent activity,\nand quick actions. It combines the Snapshot endpoint with Operation Center.\n\n## Component Structure\n```svelte\n\u003c!-- src/routes/(app)/+page.svelte --\u003e\n\u003cscript lang=\"ts\"\u003e\n  import { onMount } from 'svelte';\n  import { operationsStore } from '$lib/stores/operations.svelte';\n  import OperationCenter from '$lib/components/OperationCenter.svelte';\n  import ActivityFeed from '$lib/components/ActivityFeed.svelte';\n  import StatusCards from '$lib/components/StatusCards.svelte';\n  import QuickActions from '$lib/components/QuickActions.svelte';\n  \n  let snapshot = $state\u003cGtSnapshot | null\u003e(null);\n  let loading = $state(true);\n  let error = $state\u003cstring | null\u003e(null);\n  \n  async function fetchSnapshot() {\n    try {\n      loading = true;\n      const res = await fetch('/api/gastown/snapshot');\n      if (!res.ok) throw new Error(await res.text());\n      snapshot = await res.json();\n    } catch (e) {\n      error = e instanceof Error ? e.message : 'Unknown error';\n    } finally {\n      loading = false;\n    }\n  }\n  \n  onMount(() =\u003e {\n    fetchSnapshot();\n    // Refresh every 10s\n    const interval = setInterval(fetchSnapshot, 10000);\n    return () =\u003e clearInterval(interval);\n  });\n\u003c/script\u003e\n\n\u003csvelte:head\u003e\n  \u003ctitle\u003eDashboard - Gas Town\u003c/title\u003e\n\u003c/svelte:head\u003e\n\n\u003cmain class=\"dashboard\" data-testid=\"dashboard\"\u003e\n  \u003cheader class=\"dashboard-header\"\u003e\n    \u003ch1\u003eDashboard\u003c/h1\u003e\n    \u003cdiv class=\"header-actions\"\u003e\n      \u003cbutton onclick={fetchSnapshot} disabled={loading} data-testid=\"refresh-btn\"\u003e\n        {loading ? 'Refreshing...' : 'Refresh'}\n      \u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/header\u003e\n\n  {#if error}\n    \u003cdiv class=\"error-banner\" role=\"alert\" data-testid=\"dashboard-error\"\u003e\n      \u003cp\u003e{error}\u003c/p\u003e\n      \u003cbutton onclick={fetchSnapshot}\u003eRetry\u003c/button\u003e\n    \u003c/div\u003e\n  {/if}\n\n  {#if snapshot}\n    \u003c!-- Status Cards Row --\u003e\n    \u003csection class=\"status-cards\" data-testid=\"status-cards\"\u003e\n      \u003cStatusCards {snapshot} /\u003e\n    \u003c/section\u003e\n\n    \u003c!-- Quick Actions --\u003e\n    \u003csection class=\"quick-actions\" data-testid=\"quick-actions\"\u003e\n      \u003ch2\u003eQuick Actions\u003c/h2\u003e\n      \u003cQuickActions /\u003e\n    \u003c/section\u003e\n\n    \u003c!-- Activity Feed --\u003e\n    \u003csection class=\"activity-feed\" data-testid=\"activity-feed\"\u003e\n      \u003ch2\u003eRecent Activity\u003c/h2\u003e\n      \u003cActivityFeed items={snapshot.recentActivity} /\u003e\n    \u003c/section\u003e\n  {:else if loading}\n    \u003c!-- Skeleton Loading --\u003e\n    \u003csection class=\"status-cards skeleton\"\u003e\n      {#each {length: 4} as _}\n        \u003cdiv class=\"status-card skeleton-card\"\u003e\u003c/div\u003e\n      {/each}\n    \u003c/section\u003e\n  {/if}\n  \n  \u003c!-- Operation Center (floating) --\u003e\n  \u003cOperationCenter /\u003e\n\u003c/main\u003e\n\n\u003cstyle\u003e\n  .dashboard {\n    padding: var(--spacing-4);\n    max-width: 1200px;\n    margin: 0 auto;\n  }\n\n  .dashboard-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: var(--spacing-4);\n  }\n\n  .status-cards {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n    gap: var(--spacing-4);\n    margin-bottom: var(--spacing-6);\n  }\n\n  .error-banner {\n    background: var(--destructive);\n    color: var(--destructive-foreground);\n    padding: var(--spacing-3);\n    border-radius: var(--radius);\n    margin-bottom: var(--spacing-4);\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n  }\n\n  section {\n    margin-bottom: var(--spacing-6);\n  }\n\n  h2 {\n    font-size: var(--text-lg);\n    margin-bottom: var(--spacing-3);\n  }\n\u003c/style\u003e\n```\n\n## Status Cards Component\n```svelte\n\u003c!-- src/lib/components/StatusCards.svelte --\u003e\n\u003cscript lang=\"ts\"\u003e\n  import type { GtSnapshot } from '$lib/contracts';\n  \n  export let snapshot: GtSnapshot;\n\u003c/script\u003e\n\n\u003cdiv class=\"cards\"\u003e\n  \u003cdiv class=\"card\" data-testid=\"card-rigs\"\u003e\n    \u003cspan class=\"label\"\u003eRigs\u003c/span\u003e\n    \u003cspan class=\"value\"\u003e{snapshot.status.rigs?.length ?? 0}\u003c/span\u003e\n  \u003c/div\u003e\n  \u003cdiv class=\"card\" data-testid=\"card-agents\"\u003e\n    \u003cspan class=\"label\"\u003eAgents\u003c/span\u003e\n    \u003cspan class=\"value\"\u003e{snapshot.status.agents?.length ?? 0}\u003c/span\u003e\n  \u003c/div\u003e\n  \u003cdiv class=\"card\" data-testid=\"card-mail\"\u003e\n    \u003cspan class=\"label\"\u003eUnread Mail\u003c/span\u003e\n    \u003cspan class=\"value\"\u003e{snapshot.mailCount}\u003c/span\u003e\n  \u003c/div\u003e\n  \u003cdiv class=\"card\" data-testid=\"card-queue\"\u003e\n    \u003cspan class=\"label\"\u003eMerge Queue\u003c/span\u003e\n    \u003cspan class=\"value\"\u003e{snapshot.queueCount}\u003c/span\u003e\n  \u003c/div\u003e\n\u003c/div\u003e\n```\n\n## Quick Actions Component\n- Add Rig button ‚Üí opens Add Rig modal\n- New Work Item button ‚Üí opens Create Work modal\n- Run Doctor button ‚Üí starts health check operation\n\n## Acceptance Criteria\n- [ ] Shows status cards (rigs, agents, mail, queue)\n- [ ] Shows recent activity feed\n- [ ] Quick action buttons work\n- [ ] Auto-refresh every 10s\n- [ ] Manual refresh button\n- [ ] Skeleton loading states\n- [ ] Error state with retry\n- [ ] Operation Center floating component\n- [ ] data-testid for all interactive elements\n- [ ] Responsive: works on mobile/tablet/desktop\n- [ ] Keyboard navigation\n\n## Files\n- src/routes/(app)/+page.svelte\n- src/lib/components/StatusCards.svelte\n- src/lib/components/QuickActions.svelte\n- src/lib/components/__tests__/Dashboard.test.ts\n\n## Dependencies\n- gu-ygmi: Snapshot endpoint\n- gu-64cz: Operation Center UI\n- gu-ael: Activity Feed component\n\n## References\n- INTEGRATION_PLAN: CUJ-4 System Monitoring (Dashboard)","status":"open","priority":1,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-13T01:05:01.51636+05:30","created_by":"Avyukth","updated_at":"2026-01-13T01:05:01.51636+05:30","labels":["layer:ui","phase:1"]}
{"id":"gu-0s0","title":"Digest: mol-refinery-patrol","description":"Patrol: queue empty, no branches to merge","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-12T20:37:30.053263+05:30","updated_at":"2026-01-12T20:37:30.053263+05:30","closed_at":"2026-01-12T20:37:30.053218+05:30","close_reason":"Squashed from 11 wisps"}
{"id":"gu-0tj","title":"Implement /api/gastown/agents/[id] detail endpoint","description":"# Agent Detail Endpoint\n\nImplements the `/api/gastown/agents/[id]` route for individual agent details.\n\n## Implementation\n\n```typescript\n// src/routes/api/gastown/agents/[id]/+server.ts\nimport { json, error } from \"@sveltejs/kit\";\nimport type { RequestHandler } from \"./$types\";\nimport { executeGT } from \"$lib/server/cli/gt-wrapper\";\nimport { AgentDetailSchema } from \"$lib/server/cli/schemas\";\n\nexport const GET: RequestHandler = async ({ params, locals }) =\u003e {\n  const { id } = params;\n  \n  // Validate agent ID format\n  if (!/^[a-zA-Z][a-zA-Z0-9_-]{0,31}$/.test(id)) {\n    throw error(400, \"Invalid agent ID format\");\n  }\n  \n  const result = await executeGT([\"agent\", \"show\", id, \"--format=json\"]);\n  const validated = AgentDetailSchema.parse(result);\n  \n  return json({\n    data: validated,\n    meta: { fetchedAt: new Date().toISOString() }\n  });\n};\n```\n\n## Schema\n\n```typescript\nexport const AgentDetailSchema = z.object({\n  id: z.string(),\n  name: z.string(),\n  type: z.enum([\"refinery\", \"polecat\", \"mayor\"]),\n  status: z.enum([\"idle\", \"active\", \"stalled\", \"offline\"]),\n  currentTask: z.string().nullable(),\n  lastSeen: z.string().datetime(),\n  stats: z.object({\n    tasksCompleted: z.number(),\n    avgDuration: z.number(),\n    errorRate: z.number()\n  }),\n  hook: z.object({\n    attached: z.boolean(),\n    beadId: z.string().nullable()\n  }).optional()\n});\n```\n\n## Tests\n\n- Unit: Schema validation, error cases\n- Integration: E2E route tests with MSW\n\n\n(Moved from hq-cgv)","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-12T23:12:54.583046+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:12:54.583046+05:30","labels":["layer:api","phase:1"]}
{"id":"gu-0ual","title":"Smoke tests: CUJ-5 Mail View","description":"# Smoke Tests: CUJ-5 Mail View\n\n## Background\nAutomated smoke test script that validates the Mail inbox journey with comprehensive logging for debugging.\n\n## Test Script\n```typescript\n// scripts/smoke/cuj-5-mail.ts\n\nimport { expect, test, describe, beforeAll, afterAll } from \"bun:test\";\nimport { createTestLogger, type TestLogger } from \"../lib/logger\";\n\nconst BASE_URL = process.env.BASE_URL || \"http://localhost:3000\";\nlet logger: TestLogger;\nlet testStartTime: number;\n\nbeforeAll(() =\u003e {\n  logger = createTestLogger(\"CUJ-5: Mail View\");\n  testStartTime = Date.now();\n  logger.banner(\"CUJ-5: MAIL VIEW SMOKE TESTS\");\n});\n\nafterAll(() =\u003e {\n  const duration = Date.now() - testStartTime;\n  logger.summary(\"CUJ-5\", true, duration, 4);\n});\n\ndescribe(\"CUJ-5: Mail Inbox Flow\", () =\u003e {\n  let messages: any[] = [];\n\n  test(\"Step 1: Fetch mail list\", async () =\u003e {\n    const stepStart = Date.now();\n    logger.step(\"1. Fetching mail list from /api/gastown/mail\");\n    \n    const url = `${BASE_URL}/api/gastown/mail`;\n    logger.request(\"GET\", url);\n    \n    const res = await fetch(url);\n    messages = await res.json();\n    \n    logger.response(res.status, messages);\n    expect(res.ok).toBe(true);\n    expect(Array.isArray(messages)).toBe(true);\n    \n    logger.info(`Found ${messages.length} messages in inbox`);\n    for (const msg of messages.slice(0, 3)) {\n      logger.info(`  - [${msg.type}] ${msg.subject} (${msg.priority})`);\n    }\n    \n    logger.success(\"Mail list endpoint validated\");\n    logger.timing(\"Step 1\", Date.now() - stepStart);\n  });\n\n  test(\"Step 2: Fetch message detail (if messages exist)\", async () =\u003e {\n    const stepStart = Date.now();\n    logger.step(\"2. Fetching message detail\");\n    \n    if (messages.length === 0) {\n      logger.warn(\"No messages in inbox - skipping detail test\");\n      logger.timing(\"Step 2\", Date.now() - stepStart);\n      return;\n    }\n    \n    const msg = messages[0];\n    const url = `${BASE_URL}/api/gastown/mail/${msg.id}`;\n    logger.request(\"GET\", url);\n    logger.info(`Fetching detail for message: ${msg.id}`);\n    \n    const res = await fetch(url);\n    const detail = await res.json();\n    \n    logger.response(res.status, detail);\n    expect(res.ok).toBe(true);\n    \n    // Validate detail fields\n    logger.info(\"Validating message detail fields...\");\n    expect(detail.id).toBe(msg.id);\n    logger.info(`  ‚úì id: ${detail.id}`);\n    expect(detail.subject).toBeTruthy();\n    logger.info(`  ‚úì subject: ${detail.subject}`);\n    expect(detail.from).toBeTruthy();\n    logger.info(`  ‚úì from: ${detail.from}`);\n    expect(detail.body).toBeDefined();\n    logger.info(`  ‚úì body: ${detail.body?.substring(0, 50)}...`);\n    \n    logger.success(\"Message detail validated\");\n    logger.timing(\"Step 2\", Date.now() - stepStart);\n  });\n\n  test(\"Step 3: Validate message structure\", async () =\u003e {\n    const stepStart = Date.now();\n    logger.step(\"3. Validating message structure for all messages\");\n    \n    if (messages.length === 0) {\n      logger.warn(\"No messages to validate\");\n      logger.timing(\"Step 3\", Date.now() - stepStart);\n      return;\n    }\n    \n    const validTypes = [\"task\", \"scavenge\", \"notification\", \"reply\"];\n    const validPriorities = [\"low\", \"normal\", \"high\", \"urgent\"];\n    \n    logger.info(`Validating ${Math.min(messages.length, 5)} messages...`);\n    \n    for (const msg of messages.slice(0, 5)) {\n      logger.info(`  Checking message ${msg.id}...`);\n      \n      expect(msg.id).toBeTruthy();\n      logger.info(`    ‚úì id present: ${msg.id}`);\n      \n      if (msg.type) {\n        expect(validTypes).toContain(msg.type);\n        logger.info(`    ‚úì type valid: ${msg.type}`);\n      }\n      \n      if (msg.priority) {\n        expect(validPriorities).toContain(msg.priority);\n        logger.info(`    ‚úì priority valid: ${msg.priority}`);\n      }\n    }\n    \n    logger.success(\"All message structures validated\");\n    logger.timing(\"Step 3\", Date.now() - stepStart);\n  });\n\n  test(\"Step 4: Test mail filtering (if supported)\", async () =\u003e {\n    const stepStart = Date.now();\n    logger.step(\"4. Testing mail filtering capabilities\");\n    \n    // Test filter by type\n    const url = `${BASE_URL}/api/gastown/mail?type=task`;\n    logger.request(\"GET\", url);\n    logger.info(\"Testing filter: type=task\");\n    \n    const res = await fetch(url);\n    \n    if (res.ok) {\n      const filtered = await res.json();\n      logger.response(res.status, filtered);\n      logger.info(`Found ${filtered.length} task messages`);\n      \n      // Verify all returned are tasks\n      for (const msg of filtered) {\n        expect(msg.type).toBe(\"task\");\n      }\n      logger.success(\"Mail filtering works correctly\");\n    } else {\n      logger.warn(\"Mail filtering not supported (endpoint returned error)\");\n    }\n    \n    logger.timing(\"Step 4\", Date.now() - stepStart);\n  });\n});\n```\n\n## Manual Verification Checklist\n- [ ] Navigate to /mail\n- [ ] Verify inbox shows message list\n- [ ] Verify message preview shows subject, sender, priority\n- [ ] Click message to view detail\n- [ ] Verify detail shows full body\n- [ ] Test back navigation\n- [ ] Verify empty state when no messages\n\n## Test Logging Utilities\nUses shared logger from `scripts/lib/logger.ts` (see gu-335i)","status":"open","priority":1,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-12T23:59:24.02875+05:30","created_by":"Avyukth","updated_at":"2026-01-13T01:33:44.129926+05:30","labels":["layer:testing","phase:1","type:smoke"]}
{"id":"gu-14h","title":"Implement Vim-Style Keyboard Navigation","description":"# Vim-Style Keyboard Navigation\n\n## Background (from INTEGRATION_PLAN v4.0 Innovation #7)\nPower users expect vim-style navigation. This is SEPARATE from Command Palette -\nit's about navigating lists and pages with j/k, g+key sequences, etc.\n\n## Key Bindings\n```typescript\nexport const KEYBOARD_SHORTCUTS = {\n  global: {\n    'g d': 'Navigate to Dashboard',\n    'g r': 'Navigate to Rigs',\n    'g w': 'Navigate to Work',\n    'g m': 'Navigate to Mail',\n    'g q': 'Navigate to Queue',\n    '?': 'Show keyboard shortcuts',\n    '/': 'Focus search',\n    'Escape': 'Close modal/dialog',\n  },\n  dashboard: {\n    'r': 'Refresh data',\n    'j': 'Next agent',\n    'k': 'Previous agent',\n    'Enter': 'View agent details',\n  },\n  lists: {\n    'j': 'Next item',\n    'k': 'Previous item',\n    'Enter': 'Select/Open item',\n    'x': 'Toggle selection',\n    'a': 'Select all',\n  },\n};\n```\n\n## Implementation\n```typescript\n// src/lib/utils/keyboard-vim.ts\n\nclass VimKeyboardManager {\n  private keyBuffer: string[] = [];\n  private bufferTimeout: number | null = null;\n  \n  handleKey(event: KeyboardEvent) {\n    if (this.shouldIgnore(event)) return;\n    \n    this.keyBuffer.push(event.key);\n    this.resetBufferTimeout();\n    \n    const sequence = this.keyBuffer.join(' ');\n    const action = this.matchSequence(sequence);\n    \n    if (action) {\n      event.preventDefault();\n      action();\n      this.clearBuffer();\n    }\n  }\n  \n  private matchSequence(seq: string): (() =\u003e void) | null {\n    // g d -\u003e dashboard, g r -\u003e rigs, etc.\n    const routes: Record\u003cstring, string\u003e = {\n      'g d': '/',\n      'g r': '/rigs',\n      'g w': '/work',\n      'g m': '/mail',\n      'g q': '/queue',\n    };\n    \n    if (routes[seq]) {\n      return () =\u003e goto(routes[seq]);\n    }\n    return null;\n  }\n}\n```\n\n## Acceptance Criteria\n- [ ] Multi-key sequence handling (g+key)\n- [ ] j/k navigation in all lists\n- [ ] ? shows keyboard shortcuts overlay\n- [ ] / focuses search input\n- [ ] Escape closes modals\n- [ ] Works with Command Palette (not conflicts)\n- [ ] Disabled when typing in inputs\n- [ ] Unit tests for key sequence matching\n\n## Files\n- src/lib/utils/keyboard-vim.ts\n- src/lib/components/KeyboardHelp.svelte\n- src/routes/+layout.svelte (integration)\n- src/lib/utils/__tests__/keyboard-vim.test.ts\n\n## References\n- INTEGRATION_PLAN: Vim-Style Keyboard Navigation section\n\n(Moved from hq-wbe.12)","status":"open","priority":1,"issue_type":"task","estimated_minutes":150,"created_at":"2026-01-12T23:12:55.506383+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:12:55.506383+05:30","labels":["layer:ui","phase:1"]}
{"id":"gu-15c","title":"Digest: mol-refinery-patrol","description":"Patrol: queue empty, no branches to process","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-12T21:54:25.52355+05:30","updated_at":"2026-01-12T21:54:25.52355+05:30","closed_at":"2026-01-12T21:54:25.523491+05:30","close_reason":"Squashed from 11 wisps","dependencies":[{"issue_id":"gu-15c","depends_on_id":"gu-wisp-39g","type":"parent-child","created_at":"2026-01-12T21:54:25.524157+05:30","created_by":"gastown_ui/refinery"}]}
{"id":"gu-18h","title":"Wire beads watcher to SWR cache invalidation","description":"# Beads Watcher ‚Üí SWR Cache Integration\n\n## Background\nWhen .beads/ directory changes (file created/modified/deleted), the SWR cache must invalidate relevant keys to trigger background revalidation.\n\n## Invalidation Cascade Map\n```typescript\n// File change ‚Üí Cache keys to invalidate\nconst INVALIDATION_MAP: Record\u003cstring, string[]\u003e = {\n  '*.bead':     ['work:list', 'work:*', 'convoys:list'],\n  '*.message':  ['mail:list', 'mail:*'],\n  'config.yaml': ['capabilities', 'diagnostics'],\n};\n```\n\n## Implementation\n```typescript\n// src/lib/server/watchers/beads-watcher.ts\nimport { watch } from 'chokidar';\nimport { invalidatePattern } from '$lib/server/cache/swr';\n\nconst watcher = watch('.beads/**/*', {\n  ignoreInitial: true,\n  persistent: true\n});\n\nwatcher.on('all', (event, path) =\u003e {\n  if (path.endsWith('.bead')) {\n    invalidatePattern(/^work:/);\n    invalidatePattern(/^convoys:/);\n  }\n  // ... more patterns\n});\n```\n\n## Acceptance Criteria\n- [ ] Watcher detects file changes in .beads/\n- [ ] Relevant SWR cache keys invalidated\n- [ ] UI shows fresh data after .beads/ change\n- [ ] No memory leaks from watcher\n- [ ] Watcher handles directory not existing gracefully\n\n## Files\n- src/lib/server/watchers/beads-watcher.ts (enhance)\n- src/lib/server/watchers/index.ts (export watcher init)\n\n## References\n- INTEGRATION_PLAN D0.7: Watch-First Updates\n- Key Innovation #5","status":"open","priority":1,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-12T23:44:06.331408+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:44:06.331408+05:30","labels":["layer:data","phase:1"]}
{"id":"gu-1f0","title":"Implement /api/gastown/operations endpoints for Operation Center","description":"# Operations Endpoints (v5.0)\n\n## Background\nSupport the Operation Center UI with endpoints to track running operations.\n\n## Endpoints\n\n### GET /api/gastown/operations\nList all running and recent operations.\n\n```typescript\ninterface OperationSummary {\n  id: string;\n  type: string;\n  status: 'pending' | 'running' | 'completed' | 'failed' | 'cancelled';\n  startedAt: number;\n  completedAt?: number;\n  progress?: number;\n}\n```\n\n### GET /api/gastown/operations/[id]\nGet detailed operation status including logs.\n\n```typescript\ninterface OperationDetail extends OperationSummary {\n  logs: string[];\n  result?: unknown;\n  error?: string;\n  requestId: string;\n}\n```\n\n## Implementation Notes\n- Operations stored in memory (not persisted)\n- Cleared after 1 hour or on server restart\n- Linked to Process Supervisor\n\n## Acceptance Criteria\n- [ ] List endpoint returns all operations\n- [ ] Detail endpoint includes logs\n- [ ] Cancellation endpoint works\n- [ ] Memory cleanup after 1 hour\n- [ ] Unit tests\n\n## Files\n- src/routes/api/gastown/operations/+server.ts\n- src/routes/api/gastown/operations/[id]/+server.ts\n- src/routes/api/gastown/operations/[id]/cancel/+server.ts\n\n## References\n- INTEGRATION_PLAN: Operation Center section\n\n(Moved from hq-0er.14)","status":"closed","priority":2,"issue_type":"task","estimated_minutes":90,"created_at":"2026-01-12T23:13:25.748655+05:30","created_by":"Avyukth","updated_at":"2026-01-13T01:12:38.804927+05:30","closed_at":"2026-01-13T01:12:38.804927+05:30","close_reason":"Duplicate of gu-mao (operations endpoints)","labels":["layer:api","phase:1"]}
{"id":"gu-1l7","title":"Create component tests with @testing-library/svelte","description":"# Component Tests with @testing-library/svelte\n\n## Background\nComponent tests verify UI behavior without full E2E complexity.\nUse Vitest + @testing-library/svelte.\n\n## Setup\n```bash\nbun add -D @testing-library/svelte @testing-library/jest-dom vitest\n```\n\n## Test Examples\n```typescript\n// src/lib/components/__tests__/OperationCenter.test.ts\n\nimport { describe, it, expect } from 'vitest';\nimport { render, screen, fireEvent } from '@testing-library/svelte';\nimport OperationCenter from '../OperationCenter.svelte';\n\ndescribe('OperationCenter', () =\u003e {\n  it('shows running operation count', () =\u003e {\n    render(OperationCenter, { \n      props: { operations: [{ id: '1', status: 'running' }] }\n    });\n    expect(screen.getByText('1 running')).toBeInTheDocument();\n  });\n\n  it('expands panel on click', async () =\u003e {\n    render(OperationCenter);\n    await fireEvent.click(screen.getByRole('button'));\n    expect(screen.getByText('Operation Center')).toBeInTheDocument();\n  });\n\n  it('shows cancel button for running ops', () =\u003e {\n    render(OperationCenter, {\n      props: { operations: [{ id: '1', status: 'running' }] }\n    });\n    expect(screen.getByText('Cancel')).toBeInTheDocument();\n  });\n});\n```\n\n## Components to Test\n- OperationCenter.svelte\n- CommandPalette.svelte\n- Toast.svelte\n- ErrorBoundary.svelte\n- WorkItemCard.svelte\n- AgentCard.svelte\n- ConvoyCard.svelte\n- DegradedModeBanner.svelte\n\n## Acceptance Criteria\n- [ ] Test setup configured\n- [ ] All major components have tests\n- [ ] Tests cover user interactions\n- [ ] Accessibility queries used (getByRole)\n- [ ] Tests run in CI\n\n## Files\n- src/lib/components/__tests__/*.test.ts\n- vitest.config.ts (component test config)\n\n## References\n- INTEGRATION_PLAN: Testing Strategy section\n\n(Moved from hq-nbf.8)","status":"open","priority":1,"issue_type":"task","estimated_minutes":240,"created_at":"2026-01-12T23:12:55.000132+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:12:55.000132+05:30","labels":["layer:testing","phase:1"]}
{"id":"gu-1rb","title":"Implement /api/gastown/work/sling POST endpoint","description":"# Sling Work Endpoint\n\n## Background\nSling assigns a work item to an agent for execution.\nThis is a write operation (requires GASTOWN_ENABLE_WRITES=true).\n\n## CLI Command\n```bash\ngt sling \u003cbead-id\u003e \u003crig/agent\u003e\n```\n\n## Request Schema\n```typescript\nconst SlingSchema = z.object({\n  beadId: z.string().regex(/^[a-z]+-[a-z0-9]+$/, 'Invalid bead ID'),\n  target: z.string().regex(/^[a-z0-9-]+\\/[a-z0-9-]+$/, 'rig/agent format'),\n});\n```\n\n## Response\n```typescript\ninterface SlingResponse {\n  success: boolean;\n  status: 'slung' | 'queued';\n  target: string;\n  message?: string;\n}\n```\n\n## Long-Running Notes\n- Timeout: 60s\n- May return 202 if daemon queues the sling\n- Known bug: may fail silently if daemon not running\n\n## Acceptance Criteria\n- [ ] Validates input with SlingSchema\n- [ ] Uses Process Supervisor\n- [ ] Handles daemon not running gracefully\n- [ ] Returns appropriate status codes\n- [ ] Requires GASTOWN_ENABLE_WRITES flag\n- [ ] Unit test with mocked CLI\n\n## Files\n- src/routes/api/gastown/work/sling/+server.ts\n- src/routes/api/gastown/work/sling/__tests__/server.test.ts\n\n## References\n- INTEGRATION_PLAN: Sling endpoint in API Specifications\n\n(Moved from hq-0er.13)","status":"closed","priority":2,"issue_type":"task","estimated_minutes":90,"created_at":"2026-01-12T23:13:25.85195+05:30","created_by":"Avyukth","updated_at":"2026-01-13T01:12:31.651298+05:30","closed_at":"2026-01-13T01:12:31.651298+05:30","close_reason":"Duplicate of gu-u4e (work/sling endpoint)","labels":["layer:api","phase:1"]}
{"id":"gu-1ut","title":"[P1] Security Hardening: CSP, Rate Limiting, Input Validation","description":"# Phase 1 Security Hardening\n\n## Background\nSecurity must be built-in from Phase 1, not bolted on later.\nThe INTEGRATION_PLAN defines comprehensive security requirements.\n\n## Core Principle (v5.0 - #11)\n**No-Shell Execution**: All CLI invocations use arg-arrays (spawn/execFile), never shell strings\n\n## Security Requirements\n\n### Content Security Policy (CSP)\n- Strict CSP headers in hooks.server.ts\n- Prevent XSS attacks\n\n### Input Validation\n- Zod schemas for all inputs\n- Strict validation (not sanitization) for CLI args\n- BeadIdSchema, AgentNameSchema, RigNameSchema\n- SlingSchema, CreateWorkItemSchema, AddRigSchema\n\n### Rate Limiting\n- Per-endpoint rate limits\n- Prevent DoS attacks\n- Clear error messages when rate limited\n\n### CSRF Protection\n- SameSite cookies\n- Origin validation\n\n## Acceptance Criteria\n- [ ] CSP headers configured\n- [ ] All POST bodies validated with Zod\n- [ ] Rate limiting on all endpoints\n- [ ] No shell command injection possible\n- [ ] Security checklist from INTEGRATION_PLAN complete\n\n## References\n- INTEGRATION_PLAN: Security Hardening section\n- INTEGRATION_PLAN: Security Checklist table\n\n(Moved from hq-m9x)","status":"open","priority":1,"issue_type":"epic","created_at":"2026-01-12T23:11:32.405756+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:11:32.405756+05:30","labels":["critical:yes","layer:security","phase:1"]}
{"id":"gu-1zc","title":"Implement Operation Center FAB component","description":"# Operation Center FAB Implementation\n\n## Background\nThe Operation Center is a floating action button (FAB) in the bottom-right corner\nthat shows running operations and provides quick access to operation history.\n\n## UI Behavior\n- Collapsed: Shows icon + count of running operations\n- Expanded: Shows list of recent operations with details\n- Running operations show progress bar and cancel button\n- Failed operations show error and retry button\n\n## Component Structure\n```svelte\n\u003c!-- src/lib/components/OperationCenter.svelte --\u003e\n\n\u003cscript lang=\"ts\"\u003e\n  import { operationsStore } from '$lib/stores/operations.svelte';\n  \n  let expanded = $state(false);\n  \n  const hasRunning = $derived(operationsStore.hasRunning);\n  const runningOps = $derived(operationsStore.running);\n  const recentOps = $derived(operationsStore.recent);\n\u003c/script\u003e\n\n\u003cdiv class=\"operation-center\" class:expanded\u003e\n  \u003cbutton class=\"toggle-btn\" onclick={() =\u003e expanded = !expanded}\u003e\n    \u003cspan class=\"icon\"\u003e{hasRunning ? '‚è≥' : '‚úì'}\u003c/span\u003e\n    \u003cspan class=\"label\"\u003e\n      {#if hasRunning}\n        {runningOps.length} running\n      {:else}\n        Operations\n      {/if}\n    \u003c/span\u003e\n    \u003cChevronIcon direction={expanded ? 'down' : 'up'} /\u003e\n  \u003c/button\u003e\n\n  {#if expanded}\n    \u003cdiv class=\"panel\"\u003e\n      \u003cheader\u003e\n        \u003ch3\u003eOperation Center\u003c/h3\u003e\n        \u003cbutton onclick={() =\u003e operationsStore.clearCompleted()}\u003e\n          Clear completed\n        \u003c/button\u003e\n      \u003c/header\u003e\n      \n      \u003cul class=\"operation-list\"\u003e\n        {#each recentOps as op (op.id)}\n          \u003cOperationItem {op} /\u003e\n        {:else}\n          \u003cli\u003eNo recent operations\u003c/li\u003e\n        {/each}\n      \u003c/ul\u003e\n    \u003c/div\u003e\n  {/if}\n\u003c/div\u003e\n```\n\n## Features\n- [x] Floating position (bottom-right, z-50)\n- [x] Badge shows running count\n- [x] Expand/collapse panel\n- [x] Operation list with status\n- [x] Progress bar for running ops\n- [x] Cancel button for running ops\n- [x] Retry button for failed ops\n- [x] Logs expandable per operation\n- [x] Copy debug bundle button\n\n## Platform Considerations (AGENTS.md)\n- Mobile: Full-width panel, larger touch targets\n- Tablet: Fixed width panel, standard targets\n- Desktop: Fixed width panel, hover states\n\n## Acceptance Criteria\n- [ ] FAB positioned bottom-right\n- [ ] Shows running operation count\n- [ ] Panel expands/collapses\n- [ ] Operations listed with status icons\n- [ ] Progress bar for running operations\n- [ ] Cancel and retry buttons work\n- [ ] Works on mobile, tablet, desktop\n- [ ] Keyboard accessible (Tab, Enter, Escape)\n\n## Files\n- src/lib/components/OperationCenter.svelte\n- src/lib/components/OperationItem.svelte\n- src/lib/components/__tests__/OperationCenter.test.ts\n\n## References\n- INTEGRATION_PLAN D0.10: Observable Operations\n- INTEGRATION_PLAN: Operation Center UI section\n\n(Moved from hq-wbe.1)","status":"open","priority":1,"issue_type":"task","estimated_minutes":180,"created_at":"2026-01-12T23:12:57.137996+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:12:57.137996+05:30","labels":["layer:ui","phase:1","priority:critical"]}
{"id":"gu-20z","title":"Create comprehensive TypeScript data model types","description":"# Comprehensive TypeScript Data Models\n\n## Background\nAll CLI output types must be defined in TypeScript with corresponding\nZod schemas for runtime validation.\n\n## Types to Define\n```typescript\n// src/lib/types/gastown.ts\n\n// Status types\nexport interface GtStatus { ... }\nexport interface GtDaemonStatus { ... }\nexport interface GtAgent { ... }\nexport interface GtRigSummary { ... }\nexport interface GtQueueSummary { ... }\n\n// Convoy types\nexport interface GtConvoy { ... }\nexport interface GtTrackedIssue { ... }\n\n// Bead types\nexport interface BdBead { ... }\n\n// Mail types\nexport interface GtMailMessage { ... }\n\n// Queue types\nexport interface GtMergeQueueItem { ... }\n\n// Workflow types\nexport interface GtFormula { ... }\nexport interface GtFormulaStep { ... }\nexport interface GtFormulaParam { ... }\nexport interface GtMolecule { ... }\nexport interface GtMoleculeStep { ... }\n\n// Health types\nexport interface GtDoctorResult { ... }\nexport interface GtHealthCheck { ... }\n\n// Rig types\nexport interface GtRig { ... }\nexport interface GtRigAgent { ... }\nexport interface GtRigConfig { ... }\n\n// Feed types\nexport interface GtFeedItem { ... }\n\n// Sling types\nexport interface SlingTarget { ... }\n```\n\n## Zod Schemas\n```typescript\n// src/lib/types/gastown.schema.ts\n\nimport { z } from 'zod';\n\nexport const GtAgentSchema = z.object({\n  name: z.string(),\n  id: z.string(),\n  status: z.enum(['idle', 'active', 'busy', 'parked', 'stuck', 'orphaned']),\n  session_id: z.string(),\n  rig: z.string(),\n  worktree: z.string(),\n  branch: z.string().optional(),\n  last_activity: z.string(),\n  last_activity_ago: z.string(),\n  current_task: z.string().optional(),\n  current_molecule: z.string().optional(),\n  health: z.enum(['healthy', 'warning', 'critical']),\n}).passthrough(); // Allow extra fields for forward compat\n\n// ... more schemas\n```\n\n## Acceptance Criteria\n- [ ] All types from INTEGRATION_PLAN defined\n- [ ] Zod schemas for all types\n- [ ] passthrough() for forward compatibility\n- [ ] Types exported for use across codebase\n- [ ] Unit tests verify type/schema alignment\n\n## Files\n- src/lib/types/gastown.ts\n- src/lib/types/gastown.schema.ts\n- src/lib/types/__tests__/types.test.ts\n\n## References\n- INTEGRATION_PLAN: Data Models section\n\n(Moved from hq-nbf.11)","status":"open","priority":1,"issue_type":"task","estimated_minutes":180,"created_at":"2026-01-12T23:12:54.68601+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:12:54.68601+05:30","labels":["layer:testing","phase:1"]}
{"id":"gu-21j","title":"Implement /api/gastown/queue endpoint","description":"# Queue Endpoint Implementation\n\n## Background\nReturns merge queue items. The merge queue shows branches waiting to be merged\nby the Refinery agent.\n\n## CLI Command\n```bash\ngt mq list --json\n```\n\n## Expected Response\n```json\n{\n  \"items\": [\n    {\n      \"id\": \"mq-123\",\n      \"branch\": \"polecat/avyukth-feature\",\n      \"rig\": \"gastown_ui\",\n      \"status\": \"pending\",\n      \"position\": 1,\n      \"created_at\": \"2026-01-12T10:00:00Z\"\n    }\n  ],\n  \"queue_length\": 3,\n  \"timestamp\": \"2026-01-12T10:00:00Z\"\n}\n```\n\n## Acceptance Criteria\n- [ ] Returns queue items JSON\n- [ ] Includes position in queue\n- [ ] Uses SWR cache with 5s stale time\n- [ ] Validates response with Zod contract\n- [ ] Unit test with mocked CLI\n\n## Files\n- src/routes/api/gastown/queue/+server.ts\n- src/routes/api/gastown/queue/__tests__/server.test.ts\n\n## References\n- INTEGRATION_PLAN: Queue Endpoint section\n- CLI: gt mq list --json\n\n(Moved from hq-0er.6)","status":"open","priority":1,"issue_type":"task","estimated_minutes":45,"created_at":"2026-01-12T23:12:57.636211+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:12:57.636211+05:30","labels":["layer:api","phase:1"]}
{"id":"gu-25m","title":"Integration tests: API Routes","description":"# Integration Tests: API Routes\n\n## Test Strategy\nMock the CLI (Process Supervisor) and test the full route behavior.\n\n## Test Cases\n\n### /api/gastown/status\n- [x] Returns JSON with expected structure\n- [x] Uses SWR cache\n- [x] Handles CLI errors gracefully\n\n### /api/gastown/work\n- [x] Returns work items\n- [x] Filters work correctly\n- [x] Handles empty results\n\n### /api/gastown/mail\n- [x] Uses bd list workaround\n- [x] Returns messages\n\n### Error Handling\n- [x] CLI timeout returns error response\n- [x] Parse error returns error response\n- [x] RequestId in all error responses\n\n## Test Setup\n```typescript\nimport { describe, it, expect, vi } from 'vitest';\n\n// Mock the process supervisor\nvi.mock('$lib/server/cli/process-supervisor', () =\u003e ({\n  processSupervisor: {\n    run: vi.fn()\n  }\n}));\n\ndescribe('GET /api/gastown/status', () =\u003e {\n  it('returns status JSON', async () =\u003e {\n    processSupervisor.run.mockResolvedValue({\n      stdout: JSON.stringify({ workspace: '/test' }),\n      exitCode: 0\n    });\n\n    const response = await GET({ request: new Request('http://test') });\n    const data = await response.json();\n\n    expect(data.workspace).toBe('/test');\n  });\n});\n```\n\n## Acceptance Criteria\n- [ ] All routes have integration tests\n- [ ] Mocks don't leak between tests\n- [ ] Error scenarios covered\n\n## Files\n- src/routes/api/gastown/__tests__/*.test.ts\n\n## References\n- Epic: hq-0er (API Routes)\n\n(Moved from hq-nbf.4)","status":"open","priority":1,"issue_type":"task","estimated_minutes":180,"created_at":"2026-01-12T23:12:56.228713+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:12:56.228713+05:30","labels":["layer:testing","phase:1","type:integration"]}
{"id":"gu-280","title":"Implement /api/gastown/capabilities endpoint","description":"# Capabilities Endpoint Implementation\n\n## Background\nReturns CLI capabilities and version information. Used by frontend to enable/\ndisable features based on what the CLI supports.\n\n## Response\n```json\n{\n  \"gt_version\": \"1.2.3\",\n  \"bd_version\": \"1.0.0\",\n  \"features\": {\n    \"json_output\": true,\n    \"mail_inbox\": false,\n    \"sse_tailing\": true,\n    \"convoys\": true,\n    \"formulas\": true\n  },\n  \"paths\": {\n    \"workspace\": \"/path/to/workspace\",\n    \"beads_db\": \"/path/to/.beads\",\n    \"events_file\": \"/path/to/.beads/.events.jsonl\"\n  },\n  \"timestamp\": \"2026-01-12T10:00:00Z\"\n}\n```\n\n## Implementation\nWraps the Capabilities Probe service (hq-0qb.3).\n\n## Acceptance Criteria\n- [ ] Returns capabilities JSON\n- [ ] Cached for 1 hour (rarely changes)\n- [ ] Feature flags reflect actual CLI capabilities\n- [ ] Paths auto-discovered\n- [ ] Unit test with mocked probe\n\n## Files\n- src/routes/api/gastown/capabilities/+server.ts\n\n## References\n- INTEGRATION_PLAN D0.6: Capabilities Probe\n- Depends on: hq-0qb.3 (Capabilities Probe)\n\n(Moved from hq-0er.10)","status":"open","priority":1,"issue_type":"task","estimated_minutes":30,"created_at":"2026-01-12T23:12:57.239827+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:12:57.239827+05:30","labels":["layer:api","phase:1"]}
{"id":"gu-2en","title":"Implement Concurrency Limiter for CLI operations","description":"# Concurrency Limiter Implementation\n\n## Background\nWithout concurrency limits, rapid API requests can spawn dozens of CLI processes,\nexhausting system resources and causing CPU spikes. The limiter ensures at most\nN processes run simultaneously.\n\n## Why This Matters\n- gt/bd commands are CPU-intensive\n- Parallel execution causes resource contention\n- Sequential with queue is safer for shared state\n- Deduplication prevents redundant work\n\n## Implementation Requirements\n\n### Core API\n```typescript\ninterface ConcurrencyLimiter {\n  acquire\u003cT\u003e(key: string, fn: () =\u003e Promise\u003cT\u003e): Promise\u003cT\u003e;\n  getStats(): QueueStats;\n}\n\ninterface QueueStats {\n  active: number;\n  waiting: number;\n  maxConcurrent: number;\n}\n```\n\n### Features\n1. **Configurable limit**: Default 4, configurable via env\n2. **Keyed deduplication**: Same key ‚Üí coalesce to single request\n3. **FIFO queue**: Fair ordering for waiting requests\n4. **Timeout**: Requests waiting too long get rejected\n5. **Stats**: Expose active/waiting counts for monitoring\n\n### Deduplication Logic\n```typescript\n// If same key already in-flight, return existing promise\nconst existing = inFlight.get(key);\nif (existing) return existing;\n\n// Otherwise queue new request\nconst promise = queue.add(() =\u003e fn());\ninFlight.set(key, promise);\nreturn promise;\n```\n\n## Acceptance Criteria\n- [ ] Max concurrent configurable (default 4)\n- [ ] Requests beyond limit are queued\n- [ ] Same-key requests deduplicated\n- [ ] Queue timeout rejects stale requests\n- [ ] Stats endpoint returns queue state\n- [ ] Unit tests for: limit enforcement, deduplication, timeout\n\n## Files\n- src/lib/server/cli/concurrency-limiter.ts\n- src/lib/server/cli/__tests__/concurrency-limiter.test.ts\n\n## References\n- INTEGRATION_PLAN D0.3: CLI Operations Concurrency\n- npm: p-limit, p-queue (reference implementations)\n\n(Moved from hq-0qb.2)","status":"open","priority":1,"issue_type":"task","estimated_minutes":90,"created_at":"2026-01-12T23:13:25.135743+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:13:25.135743+05:30","labels":["layer:foundation","phase:1"]}
{"id":"gu-2f0","title":"Implement /api/gastown/workflows/formulas and molecules endpoints","description":"# Workflow Endpoints\n\n## Endpoints\n\n### GET /api/gastown/workflows/formulas\n```bash\ngt formula list\n```\n\nReturns available formula definitions.\n\n### GET /api/gastown/workflows/molecules\n```bash\nbd list --type=molecule --json\n```\n\nReturns running molecule instances.\n\n## Response Schemas\n```typescript\ninterface GtFormula {\n  name: string;\n  description: string;\n  category: string;\n  steps: GtFormulaStep[];\n  parameters?: Record\u003cstring, GtFormulaParam\u003e;\n}\n\ninterface GtMolecule {\n  id: string;\n  formula: string;\n  status: 'pending' | 'running' | 'completed' | 'failed';\n  current_step?: string;\n  steps: GtMoleculeStep[];\n  started_at?: string;\n  completed_at?: string;\n  error?: string;\n  agent?: string;\n}\n```\n\n## Acceptance Criteria\n- [ ] Formulas endpoint returns all formulas\n- [ ] Molecules endpoint returns running molecules\n- [ ] Cache TTL: 30s for formulas, 10s for molecules\n- [ ] Unit tests with mocked CLI\n\n## Files\n- src/routes/api/gastown/workflows/formulas/+server.ts\n- src/routes/api/gastown/workflows/molecules/+server.ts\n\n## References\n- INTEGRATION_PLAN: Additional Workflow Routes\n\n(Moved from hq-0er.15)","status":"closed","priority":2,"issue_type":"task","estimated_minutes":60,"created_at":"2026-01-12T23:13:25.647858+05:30","created_by":"Avyukth","updated_at":"2026-01-13T01:12:39.185369+05:30","closed_at":"2026-01-13T01:12:39.185369+05:30","close_reason":"Duplicate of gu-6gcr and gu-x1zc (workflow endpoints)","labels":["layer:api","phase:1"]}
{"id":"gu-2ql","title":"Digest: mol-refinery-patrol","description":"Patrol: queue empty, no branches to process","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-12T22:58:28.948215+05:30","updated_at":"2026-01-12T22:58:28.948215+05:30","closed_at":"2026-01-12T22:58:28.948158+05:30","close_reason":"Squashed from 11 wisps","dependencies":[{"issue_id":"gu-2ql","depends_on_id":"gu-wisp-rqi","type":"parent-child","created_at":"2026-01-12T22:58:28.948824+05:30","created_by":"gastown_ui/refinery"}]}
{"id":"gu-2x5","title":"Implement Mobile Touch Targets (44px minimum)","description":"# Mobile Touch Targets\n\n## Background (from AGENTS.md)\nMobile targets must be at least 44px for comfortable tapping.\nPer AGENTS.md: \"Tap targets ‚â• 44px, readable type, no horizontal scroll\"\n\n## Implementation\n```css\n.touch-target {\n  min-width: 44px;\n  min-height: 44px;\n  padding: 12px;\n}\n\n.touch-safe-spacing {\n  gap: 8px;\n}\n```\n\n## Components to Update\n- All buttons\n- All links\n- All clickable cards\n- Form inputs\n- Dropdown triggers\n\n## Acceptance Criteria\n- [ ] All interactive elements 44px minimum\n- [ ] No elements overlap\n- [ ] Tested on mobile viewport (360√ó800)\n- [ ] Works with one-handed navigation\n\n## Files\n- src/app.css (utility classes)\n- All component files (audit and update)\n\n## References\n- AGENTS.md: Platform-mobile requirements\n- INTEGRATION_PLAN: Touch Targets section\n\n(Moved from hq-iri.3)","status":"open","priority":2,"issue_type":"task","estimated_minutes":90,"created_at":"2026-01-12T23:13:25.343224+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:13:25.343224+05:30","labels":["layer:perf-a11y","phase:1","platform:mobile"]}
{"id":"gu-2zr","title":"[P1] Performance \u0026 Accessibility: Optimization \u0026 WCAG Compliance","description":"# Performance \u0026 Accessibility Epic\n\nEnsures the Gas Town UI meets performance budgets and WCAG 2.1 AA accessibility standards.\n\n## Goals\n\n1. **Performance**\n   - LCP \u003c 2.5s on 4G mobile\n   - No layout shift (CLS \u003c 0.1)\n   - Smooth 60fps scrolling\n   - Virtualized lists for large datasets\n\n2. **Accessibility**\n   - WCAG 2.1 AA compliance\n   - Full keyboard navigation\n   - Screen reader support\n   - Reduced motion support\n   - High contrast mode\n\n## Tasks\n\n1. **List Virtualization** - Virtual scrolling for long lists\n2. **ARIA Patterns** - Proper roles, labels, live regions\n3. **Mobile Touch Targets** - 44px minimum tap targets\n4. **Keyboard Focus Management** - Visible focus, logical tab order\n5. **Reduced Motion** - Respect prefers-reduced-motion\n\n## Success Metrics\n\n- Lighthouse Performance: 90+\n- Lighthouse Accessibility: 100\n- axe-core: 0 violations\n- WebPageTest: LCP \u003c 2.5s\n\n## References\n\n- WCAG 2.1 Guidelines\n- AGENTS.md platform requirements\n- mobile-frontend-design skill\n\n\n(Moved from hq-821)","status":"open","priority":1,"issue_type":"epic","created_at":"2026-01-12T23:11:32.523604+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:11:32.523604+05:30","labels":["critical:yes","layer:a11y","layer:perf","phase:1"]}
{"id":"gu-32m","title":"Implement .beads/ directory watcher for real-time updates","description":"# Beads Directory Watcher Implementation\n\n## Background\nInstead of polling, we watch the .beads/ directory for changes. When JSONL files\nchange, we invalidate relevant caches and notify connected clients via SSE.\n\n## Why This Matters\n- Polling wastes resources\n- Watching is event-driven (efficient)\n- Near-real-time updates without overhead\n- Changes from CLI immediately reflected in UI\n\n## Implementation Requirements\n\n### Watcher Setup\n```typescript\n// src/lib/server/watch/beads-watcher.ts\n\nimport { watch, type FSWatcher } from 'chokidar';\n\ninterface WatcherConfig {\n  beadsPath: string;        // .beads/ directory\n  debounceMs: number;       // Debounce rapid changes (default 100ms)\n  onWorkChange: () =\u003e void;\n  onConvoyChange: () =\u003e void;\n  onEventAppend: (event: BeadEvent) =\u003e void;\n}\n\nexport function createBeadsWatcher(config: WatcherConfig): FSWatcher {\n  const watcher = watch(config.beadsPath, {\n    persistent: true,\n    ignoreInitial: true,\n    awaitWriteFinish: {\n      stabilityThreshold: 100,\n      pollInterval: 50\n    }\n  });\n\n  watcher.on('change', debounce((path) =\u003e {\n    if (path.includes('.events.jsonl')) {\n      // Tail new events\n      tailNewEvents(path, config.onEventAppend);\n    } else if (path.includes('work') || path.includes('issues')) {\n      config.onWorkChange();\n    } else if (path.includes('convoy')) {\n      config.onConvoyChange();\n    }\n  }, config.debounceMs));\n\n  return watcher;\n}\n```\n\n### Event Tailing\n```typescript\n// Tail .events.jsonl for new events\nlet lastPosition = 0;\n\nfunction tailNewEvents(\n  path: string,\n  onEvent: (event: BeadEvent) =\u003e void\n) {\n  const content = readFileSync(path, 'utf8');\n  const newContent = content.slice(lastPosition);\n  lastPosition = content.length;\n\n  for (const line of newContent.split('\\n').filter(Boolean)) {\n    try {\n      const event = JSON.parse(line);\n      onEvent(event);\n    } catch {\n      // Ignore malformed lines\n    }\n  }\n}\n```\n\n### Integration with SSE\n```typescript\n// When file changes, broadcast to SSE clients\nwatcher = createBeadsWatcher({\n  beadsPath: '/path/to/.beads',\n  onWorkChange: () =\u003e {\n    sseClients.broadcast({ type: 'work_changed' });\n    swrCache.invalidatePrefix('work:');\n  },\n  onConvoyChange: () =\u003e {\n    sseClients.broadcast({ type: 'convoy_changed' });\n    swrCache.invalidatePrefix('convoy:');\n  },\n  onEventAppend: (event) =\u003e {\n    sseClients.broadcast({ type: 'event', data: event });\n  }\n});\n```\n\n## Acceptance Criteria\n- [ ] Watches .beads/ directory for changes\n- [ ] Debounces rapid changes\n- [ ] Tails .events.jsonl for new events\n- [ ] Invalidates SWR cache on changes\n- [ ] Broadcasts to SSE clients\n- [ ] Handles watcher errors gracefully\n- [ ] Unit tests with mock filesystem\n\n## Files\n- src/lib/server/watch/beads-watcher.ts\n- src/lib/server/watch/__tests__/beads-watcher.test.ts\n\n## References\n- INTEGRATION_PLAN D0.7: Watch-First Updates\n- npm: chokidar\n\n(Moved from hq-bpb.3)","status":"open","priority":1,"issue_type":"task","estimated_minutes":90,"created_at":"2026-01-12T23:12:58.365169+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:12:58.365169+05:30","labels":["layer:data","phase:1"]}
{"id":"gu-335i","title":"Implement shared test logging utilities","description":"# Shared Test Logging Utilities\n\n## Background\nAll tests must have comprehensive, detailed logging for debugging. This bead creates shared utilities.\n\n## Implementation\n\n```typescript\n// scripts/smoke/lib/logger.ts\n\nexport interface TestLogger {\n  step: (name: string) =\u003e void;\n  info: (msg: string, data?: unknown) =\u003e void;\n  success: (msg: string) =\u003e void;\n  fail: (msg: string, error?: unknown) =\u003e void;\n  timing: (name: string, ms: number) =\u003e void;\n  request: (method: string, url: string, body?: unknown) =\u003e void;\n  response: (status: number, body: unknown, headers?: Headers) =\u003e void;\n  summary: (testName: string, passed: boolean, duration: number, steps: number) =\u003e void;\n}\n\nexport function createTestLogger(testName: string): TestLogger {\n  const colors = {\n    reset: '\\x1b[0m',\n    green: '\\x1b[32m',\n    red: '\\x1b[31m',\n    yellow: '\\x1b[33m',\n    blue: '\\x1b[34m',\n    cyan: '\\x1b[36m',\n    dim: '\\x1b[2m'\n  };\n\n  return {\n    step: (name: string) =\u003e {\n      const banner = '='.repeat(60);\n      console.log(`\\n${colors.cyan}${banner}${colors.reset}`);\n      console.log(`${colors.cyan}[STEP]${colors.reset} ${name}`);\n      console.log(`${colors.cyan}${banner}${colors.reset}`);\n    },\n    \n    info: (msg: string, data?: unknown) =\u003e {\n      console.log(`${colors.dim}[INFO]${colors.reset} ${msg}`);\n      if (data) {\n        console.log(`${colors.dim}${JSON.stringify(data, null, 2)}${colors.reset}`);\n      }\n    },\n    \n    success: (msg: string) =\u003e {\n      console.log(`${colors.green}[SUCCESS] ‚úì${colors.reset} ${msg}`);\n    },\n    \n    fail: (msg: string, error?: unknown) =\u003e {\n      console.error(`${colors.red}[FAIL] ‚úó${colors.reset} ${msg}`);\n      if (error) {\n        console.error(`${colors.red}${JSON.stringify(error, null, 2)}${colors.reset}`);\n      }\n    },\n    \n    timing: (name: string, ms: number) =\u003e {\n      const color = ms \u003e 1000 ? colors.yellow : colors.dim;\n      console.log(`${color}[TIMING]${colors.reset} ${name}: ${ms}ms`);\n    },\n    \n    request: (method: string, url: string, body?: unknown) =\u003e {\n      console.log(`${colors.blue}[REQUEST]${colors.reset} ${method} ${url}`);\n      if (body) {\n        console.log(`${colors.dim}[REQUEST BODY]${colors.reset}`);\n        console.log(`${colors.dim}${JSON.stringify(body, null, 2)}${colors.reset}`);\n      }\n    },\n    \n    response: (status: number, body: unknown, headers?: Headers) =\u003e {\n      const statusColor = status \u003e= 400 ? colors.red : colors.green;\n      console.log(`${statusColor}[RESPONSE] Status: ${status}${colors.reset}`);\n      if (headers) {\n        console.log(`${colors.dim}[HEADERS] Content-Type: ${headers.get('content-type')}${colors.reset}`);\n      }\n      console.log(`${colors.dim}[RESPONSE BODY]${colors.reset}`);\n      console.log(`${colors.dim}${JSON.stringify(body, null, 2)}${colors.reset}`);\n    },\n    \n    summary: (testName: string, passed: boolean, duration: number, steps: number) =\u003e {\n      const banner = '='.repeat(60);\n      const color = passed ? colors.green : colors.red;\n      console.log(`\\n${color}${banner}${colors.reset}`);\n      console.log(`${color}[${passed ? 'PASSED' : 'FAILED'}] ${testName}${colors.reset}`);\n      console.log(`${colors.dim}Duration: ${duration}ms | Steps: ${steps}${colors.reset}`);\n      console.log(`${color}${banner}${colors.reset}\\n`);\n    }\n  };\n}\n```\n\n## Usage in Tests\n```typescript\nimport { createTestLogger } from './lib/logger';\n\nconst logger = createTestLogger('CUJ-1: Rig Management');\n\ntest('CUJ-1', async () =\u003e {\n  logger.step('Step 1: Get rigs');\n  // ...\n  logger.summary('CUJ-1', true, 5000, 4);\n});\n```\n\n## Acceptance Criteria\n- [ ] Logger utility created\n- [ ] Color-coded output (green success, red fail, yellow slow)\n- [ ] Step banners clearly visible\n- [ ] Request/response logging with full bodies\n- [ ] Timing information for each step\n- [ ] Summary banner at end\n- [ ] Works in CI (respects NO_COLOR env)\n\n## Files\n- scripts/smoke/lib/logger.ts\n- scripts/smoke/lib/index.ts (exports)","status":"open","priority":1,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-13T00:59:30.790375+05:30","created_by":"Avyukth","updated_at":"2026-01-13T00:59:30.790375+05:30","labels":["layer:testing","phase:1","type:util"]}
{"id":"gu-36k","title":"Migrate all API routes to Process Supervisor","description":"# Migrate all API routes to Process Supervisor\n\n## Background\nAll existing routes that use `exec()` or `execSync()` must be migrated to the \nProcess Supervisor pattern for security (no shell injection) and reliability \n(timeout, circuit breaker, error handling).\n\n## ACTUAL Routes to Migrate (from codebase audit)\n\n| Route | Current State | Migration Needed |\n|-------|--------------|------------------|\n| `/api/gastown/status/+server.ts` | uses exec() | ‚úÖ Migrate |\n| `/api/gastown/convoys/+server.ts` | uses exec() | ‚úÖ Migrate |\n| `/api/gastown/mail/+server.ts` | uses exec() | ‚úÖ Migrate |\n| `/api/gastown/rigs/+server.ts` | uses exec() | ‚úÖ Migrate |\n| `/api/gastown/work/convoys/+server.ts` | uses exec() | ‚úÖ Migrate |\n| `/api/gastown/work/issues/+server.ts` | uses exec() | ‚úÖ Migrate |\n| `/api/gastown/work/sling/+server.ts` | uses exec() | ‚úÖ Migrate |\n| `/api/gastown/workflows/cook/+server.ts` | uses exec() | ‚úÖ Migrate |\n| `/api/gastown/workflows/formulas/+server.ts` | uses exec() | ‚úÖ Migrate |\n| `/api/gastown/workflows/formulas/[name]/+server.ts` | uses exec() | ‚úÖ Migrate |\n| `/api/gastown/workflows/molecules/+server.ts` | uses exec() | ‚úÖ Migrate |\n| `/api/gastown/workflows/pour/+server.ts` | uses exec() | ‚úÖ Migrate |\n\n**TOTAL: 12 endpoints need migration**\n\n## Migration Pattern\n\n### BEFORE (INSECURE - shell injection risk)\n```typescript\nimport { exec } from 'node:child_process';\nconst execAsync = promisify(exec);\nconst { stdout } = await execAsync('gt status --json');\n```\n\n### AFTER (SECURE - Process Supervisor pattern)\n```typescript\nimport { processSupervisor } from '$lib/server/process-supervisor';\nimport { withCircuitBreaker } from '$lib/server/circuit-breaker';\nimport { identifyKnownBug } from '$lib/errors/known-bugs';\n\nexport const GET: RequestHandler = async ({ setHeaders }) =\u003e {\n  try {\n    const result = await withCircuitBreaker(\n      'gt-status',\n      () =\u003e processSupervisor.exec('gt', ['status', '--fast', '--json']),\n      { timeout: 3000 }\n    );\n    \n    const data = GtStatusSchema.parse(JSON.parse(result.stdout));\n    \n    setHeaders({\n      'Cache-Control': 'public, max-age=10, stale-while-revalidate=30'\n    });\n    \n    return json(data);\n  } catch (error) {\n    const bug = identifyKnownBug(error.stderr ?? error.message);\n    return json({\n      error: {\n        code: bug?.id ?? 'CLI_ERROR',\n        message: bug?.userMessage ?? 'Command failed',\n        category: bug?.category ?? 'CLI_ERROR',\n        recoverable: true,\n        suggestedAction: bug?.workaround ?? 'Try again'\n      }\n    }, { status: 500 });\n  }\n};\n```\n\n## Migration Checklist (per endpoint)\nFor each endpoint:\n- [ ] Replace exec() with processSupervisor.exec()\n- [ ] Wrap in withCircuitBreaker()\n- [ ] Add appropriate timeout\n- [ ] Add Known Bug Detection for errors\n- [ ] Add Zod validation for response\n- [ ] Add Cache-Control headers\n- [ ] Add correlation ID logging\n\n## Verification Commands\n```bash\n# Should return 0 matches after migration\ngrep -r \"exec(\" src/routes/api/gastown/ | grep -v execFile\ngrep -r \"execSync\" src/routes/api/gastown/\ngrep -r \"execAsync\" src/routes/api/gastown/\n```\n\n## Acceptance Criteria\n- [ ] All 12 endpoints migrated\n- [ ] Zero grep matches for direct exec() usage\n- [ ] All endpoints have circuit breaker\n- [ ] All endpoints have timeout\n- [ ] All endpoints have Known Bug Detection\n- [ ] All endpoints have Zod validation\n- [ ] Unit tests for each migrated endpoint\n\n## Dependencies\n- gu-9t4: Process Supervisor (MUST be complete first)\n- gu-m5o: Circuit Breaker\n- gu-034d: Known Bug Detection\n- gu-dze: Zod Contracts","status":"open","priority":1,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-12T23:44:05.642214+05:30","created_by":"Avyukth","updated_at":"2026-01-13T01:19:27.724464+05:30","labels":["layer:foundation","phase:1","priority:critical"]}
{"id":"gu-3k4","title":"Digest: mol-refinery-patrol","description":"Patrol: MQ empty, no branches to merge","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-12T22:50:30.802127+05:30","updated_at":"2026-01-12T22:50:30.802127+05:30","closed_at":"2026-01-12T22:50:30.802077+05:30","close_reason":"Squashed from 11 wisps"}
{"id":"gu-3qc","title":"Digest: mol-refinery-patrol","description":"Patrol: queue empty, no branches to merge","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-12T23:24:42.447487+05:30","updated_at":"2026-01-12T23:24:42.447487+05:30","closed_at":"2026-01-12T23:24:42.447426+05:30","close_reason":"Squashed from 11 wisps","dependencies":[{"issue_id":"gu-3qc","depends_on_id":"gu-wisp-r8f","type":"parent-child","created_at":"2026-01-12T23:24:42.448076+05:30","created_by":"gastown_ui/refinery"}]}
{"id":"gu-3xh","title":"[P1] Foundation Layer: Process Supervisor \u0026 CLI Execution","description":"# Phase 1 Foundation Layer\n\n## Background\nThe foundation layer provides the critical infrastructure for safe, observable CLI execution.\nWithout this layer, the UI cannot reliably communicate with Gas Town.\n\n## Key Innovations (from INTEGRATION_PLAN v5.0)\n1. **Process Supervisor (D0.5)**: No-shell execution with spawn/execFile\n2. **Capabilities Probe (D0.6)**: CLI version detection and feature flags\n3. **Concurrency Limiter (D0.3)**: Prevents resource exhaustion\n\n## Why This Matters\n- CLI commands can hang (known gt mail inbox bug)\n- Without process supervision, hung processes block the entire server\n- Without capability probing, UI breaks when CLI changes\n- Without concurrency limits, rapid requests cause CPU spikes\n\n## Acceptance Criteria\n- [ ] Process Supervisor implemented with spawn/execFile (no shell)\n- [ ] All CLI calls have configurable timeouts\n- [ ] Concurrency limited to configurable max (default 4)\n- [ ] In-flight request deduplication works\n- [ ] Capabilities endpoint returns CLI version and feature flags\n- [ ] Circuit breaker trips on repeated failures\n\n## Architecture Decision References\n- D0.3: CLI Operations Concurrency (Sequential with queue)\n- D0.5: Process Supervisor Pattern\n- D0.6: Capabilities Probe + CLI Contracts\n- D2.4: Effect.ts Error Handling\n\n## Dependencies\nNone - this is the foundation layer\n\n## Files to Create/Modify\n- src/lib/server/cli/process-supervisor.ts\n- src/lib/server/cli/capabilities.ts\n- src/lib/server/cli/concurrency-limiter.ts\n- src/lib/server/cli/contracts.ts\n- src/routes/api/gastown/capabilities/+server.ts\n\n(Moved from hq-0qb)","status":"open","priority":1,"issue_type":"epic","created_at":"2026-01-12T23:11:31.824983+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:11:31.824983+05:30","labels":["critical:yes","layer:foundation","phase:1"]}
{"id":"gu-3y9","title":"Witness Patrol","description":"Per-rig worker monitor patrol loop with progressive nudging.","status":"open","priority":2,"issue_type":"molecule","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-12T19:41:20.225614+05:30","created_by":"Avyukth","updated_at":"2026-01-12T19:41:20.225614+05:30"}
{"id":"gu-44ug","title":"Smoke tests: CUJ-3 Orchestration (Sling)","description":"# Smoke Tests: CUJ-3 Orchestration (Sling)\n\n## Background\nAutomated smoke test for the sling workflow - assigning work to polecats.\n\n## CRITICAL: Detailed Logging Requirements\n```typescript\nimport { createTestLogger } from './lib/logger';\nconst logger = createTestLogger('CUJ-3: Orchestration (Sling)');\n```\n\n## Test Script\n```typescript\n// scripts/smoke/cuj-3-sling.ts\n\nimport { expect, test } from 'bun:test';\nimport { createTestLogger } from './lib/logger';\n\nconst BASE_URL = process.env.BASE_URL || 'http://localhost:3000';\nconst logger = createTestLogger('CUJ-3: Orchestration (Sling)');\n\ntest('CUJ-3: Sling Work Item to Polecat', async () =\u003e {\n  const startTime = Date.now();\n  \n  // 1. Create work item to sling\n  logger.step('1. Create work item for sling test');\n  const createPayload = { title: 'Sling test item', priority: 1 };\n  logger.request('POST', `${BASE_URL}/api/gastown/work/issues`, createPayload);\n  \n  const createRes = await fetch(`${BASE_URL}/api/gastown/work/issues`, {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify(createPayload)\n  });\n  const { id } = await createRes.json();\n  logger.response(createRes.status, { id });\n  logger.success(`Created work item: ${id}`);\n  \n  // 2. Get available polecats\n  logger.step('2. Get available polecats');\n  logger.request('GET', `${BASE_URL}/api/gastown/agents`);\n  \n  const agentsRes = await fetch(`${BASE_URL}/api/gastown/agents`);\n  const agents = await agentsRes.json();\n  logger.response(agentsRes.status, agents);\n  \n  const polecats = agents.filter((a: any) =\u003e a.role === 'polecat');\n  logger.info(`Found ${polecats.length} polecats`);\n  \n  if (polecats.length === 0) {\n    logger.fail('No polecats available - skipping sling');\n    return;\n  }\n  \n  const target = polecats[0];\n  logger.success(`Selected target: ${target.name}`);\n  \n  // 3. Sling work item\n  logger.step('3. Sling work item to polecat');\n  const slingPayload = { beadId: id, target: `${target.rig}/${target.name}` };\n  logger.request('POST', `${BASE_URL}/api/gastown/work/sling`, slingPayload);\n  \n  const slingRes = await fetch(`${BASE_URL}/api/gastown/work/sling`, {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify(slingPayload)\n  });\n  const slingResult = await slingRes.json();\n  logger.response(slingRes.status, slingResult);\n  \n  // Handle known bug case\n  if (slingRes.status === 202 \u0026\u0026 slingResult.error?.code === 'KNOWN_BUG') {\n    logger.info('Known bug: daemon not running, sling queued');\n    logger.success('Sling accepted (queued)');\n  } else {\n    expect(slingRes.ok).toBe(true);\n    logger.success(`Slung ${id} to ${target.name}`);\n  }\n  \n  // 4. Verify work item assignee updated\n  logger.step('4. Verify assignee updated');\n  logger.request('GET', `${BASE_URL}/api/gastown/work/issues/${id}`);\n  \n  const verifyRes = await fetch(`${BASE_URL}/api/gastown/work/issues/${id}`);\n  const updated = await verifyRes.json();\n  logger.response(verifyRes.status, updated);\n  \n  logger.summary('CUJ-3', true, Date.now() - startTime, 4);\n});\n```\n\n## Manual Verification Checklist\n- [ ] Navigate to /work\n- [ ] Select a work item\n- [ ] Click \"Sling\" button\n- [ ] Select target polecat from dropdown\n- [ ] Click \"Confirm Sling\"\n- [ ] Verify toast shows \"Slinging...\"\n- [ ] Verify toast shows \"Slung to \u003cagent\u003e\"\n- [ ] Verify assignee badge updates\n\n## Acceptance Criteria\n- [ ] Script runs without errors\n- [ ] Creates and slings work item\n- [ ] Handles \"no polecats available\" gracefully\n- [ ] Handles known bug (daemon not running) gracefully\n- [ ] **DETAILED LOGGING**: Every request/response logged\n- [ ] **TIMING**: Each step timed\n- [ ] **SUMMARY**: Final pass/fail\n\n## Dependencies\n- gu-335i: Shared test logging utilities\n- gu-u4e: /api/gastown/work/sling endpoint","status":"open","priority":1,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-12T23:56:24.343538+05:30","created_by":"Avyukth","updated_at":"2026-01-13T01:31:40.490972+05:30","labels":["layer:testing","phase:1","type:smoke"]}
{"id":"gu-48y","title":"Digest: mol-refinery-patrol","description":"Patrol: queue empty, no work to process","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-12T19:50:14.168974+05:30","updated_at":"2026-01-12T19:50:14.168974+05:30","closed_at":"2026-01-12T19:50:14.168917+05:30","close_reason":"Squashed from 11 wisps"}
{"id":"gu-4he","title":"Phase 1 Performance \u0026 A11y Sprint","description":"# Phase 1 Performance \u0026 Accessibility Sprint\n\nOptimization and accessibility compliance work.\n\n## Scope\n- List virtualization for large datasets\n- ARIA patterns for screen readers\n- Mobile touch targets (44px minimum)\n- Keyboard focus management\n\n## Dependencies\nDepends on UI Layer components being in place.\n\n## Exit Criteria\n- Lighthouse Performance: 90+\n- Lighthouse Accessibility: 100\n- axe-core: 0 violations\n- All touch targets \u003e= 44px\n- Full keyboard navigation\n\n\n(Moved from hq-dw3)","status":"open","priority":1,"issue_type":"convoy","created_at":"2026-01-12T23:11:41.029228+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:11:41.029228+05:30","labels":["phase:1","sprint:perf-a11y"],"dependencies":[{"issue_id":"gu-4he","depends_on_id":"gu-0bz","type":"blocks","created_at":"2026-01-12T23:23:47.823643+05:30","created_by":"Avyukth"},{"issue_id":"gu-4he","depends_on_id":"gu-eqv","type":"blocks","created_at":"2026-01-12T23:24:45.71292+05:30","created_by":"Avyukth"},{"issue_id":"gu-4he","depends_on_id":"gu-60m","type":"blocks","created_at":"2026-01-12T23:24:45.787479+05:30","created_by":"Avyukth"},{"issue_id":"gu-4he","depends_on_id":"gu-598","type":"blocks","created_at":"2026-01-12T23:25:18.768181+05:30","created_by":"Avyukth"}]}
{"id":"gu-4op","title":"Implement Dashboard page with system overview","description":"# Dashboard Page Implementation\n\n## Background\nThe Dashboard is the landing page showing system overview: agent status,\nrecent activity, quick actions, and health indicators.\n\n## Layout\n```\n+--------------------------------------------------+\n| Header: Gas Town Dashboard                        |\n+--------------------------------------------------+\n| Agent Status Grid    | Recent Activity           |\n| +-------+ +-------+  | - Work item created       |\n| | Mayor | |Witness|  | - Merge completed         |\n| |  ‚úì    | |  ‚è≥   |  | - Mail received           |\n| +-------+ +-------+  +---------------------------+\n| Quick Actions        | Health Summary            |\n| [+ New Work]         | Workspace: ‚úì              |\n| [Run Doctor]         | Git: ‚ö† uncommitted        |\n| [View Queue]         | Daemon: ‚úì                 |\n+--------------------------------------------------+\n```\n\n## Data Requirements\n- System status (agents, rigs)\n- Recent events from feed\n- Health check summary\n- Quick action buttons\n\n## Platform Variants (AGENTS.md)\n- **Mobile**: Single column, cards stacked\n- **Tablet**: Two columns\n- **Desktop**: Full layout with sidebar\n\n## Acceptance Criteria\n- [ ] Shows agent status with icons\n- [ ] Recent activity feed (last 10 events)\n- [ ] Health summary from diagnostics\n- [ ] Quick action buttons work\n- [ ] Loading skeletons (no spinners)\n- [ ] Responsive across platforms\n- [ ] Auto-refresh via SSE\n\n## Files\n- src/routes/+page.svelte (Dashboard)\n- src/routes/+page.server.ts\n\n## References\n- INTEGRATION_PLAN: CUJ-4 System Monitoring\n\n(Moved from hq-wbe.6)","status":"closed","priority":1,"issue_type":"task","estimated_minutes":180,"created_at":"2026-01-12T23:12:56.733638+05:30","created_by":"Avyukth","updated_at":"2026-01-13T01:20:13.354261+05:30","closed_at":"2026-01-13T01:20:13.354261+05:30","close_reason":"Duplicate of gu-0pq3 (Dashboard page)","labels":["layer:ui","phase:1"]}
{"id":"gu-4po","title":"Implement /api/gastown/work endpoint","description":"# Work Endpoint Implementation\n\n## Background\nThe work endpoint returns all work items (tasks, bugs, epics, etc.) from the\nbeads database. This is one of the most frequently called endpoints.\n\n## CLI Command\n```bash\nbd list --json\n```\n\n## Expected Response\n```json\n{\n  \"items\": [\n    {\n      \"id\": \"bd-123\",\n      \"title\": \"Implement feature X\",\n      \"status\": \"open\",\n      \"priority\": 2,\n      \"issue_type\": \"task\",\n      \"assignee\": \"avyukth\",\n      \"labels\": [\"phase:1\"],\n      \"created_at\": \"2026-01-12T10:00:00Z\",\n      \"updated_at\": \"2026-01-12T10:00:00Z\"\n    }\n  ],\n  \"total\": 42,\n  \"timestamp\": \"2026-01-12T10:00:00Z\"\n}\n```\n\n## Query Parameters\n- `type`: Filter by issue type (task, bug, epic, etc.)\n- `status`: Filter by status (open, closed, in_progress)\n- `priority`: Filter by priority (0-4)\n- `assignee`: Filter by assignee\n- `labels`: Filter by labels (comma-separated)\n\n## Implementation\n```typescript\n// src/routes/api/gastown/work/+server.ts\n\nimport { json } from '@sveltejs/kit';\nimport { processSupervisor } from '$lib/server/cli/process-supervisor';\nimport { WorkItemContract } from '$lib/server/cli/contracts';\nimport { z } from 'zod';\n\nexport async function GET({ url, request }) {\n  const requestId = request.headers.get('x-request-id') || crypto.randomUUID();\n  \n  // Build CLI args from query params\n  const args = ['list', '--json'];\n  const type = url.searchParams.get('type');\n  if (type) args.push('--type', type);\n  const status = url.searchParams.get('status');\n  if (status) args.push('--status', status);\n  // ... more filters\n  \n  try {\n    const data = await swrCache.get(\n      `work:${url.search}`,\n      async () =\u003e {\n        const result = await processSupervisor.run('bd', args, {\n          timeout: 15000,\n          requestId\n        });\n        return JSON.parse(result.stdout);\n      },\n      { staleTime: 10000 }\n    );\n    \n    const items = z.array(WorkItemContract).parse(data);\n    return json({ items, total: items.length });\n  } catch (error) {\n    return json(error.toJSON(), { status: 500 });\n  }\n}\n```\n\n## Acceptance Criteria\n- [ ] Returns work items JSON\n- [ ] Supports filtering by type, status, priority, assignee, labels\n- [ ] Uses SWR cache with 10s stale time\n- [ ] Validates response with Zod contract\n- [ ] Handles empty results gracefully\n- [ ] Unit test with mocked CLI\n\n## Files\n- src/routes/api/gastown/work/+server.ts\n- src/routes/api/gastown/work/__tests__/server.test.ts\n\n## References\n- INTEGRATION_PLAN: Work Endpoint section\n- CLI: bd list --json\n\n(Moved from hq-0er.2)","status":"open","priority":1,"issue_type":"task","estimated_minutes":90,"created_at":"2026-01-12T23:12:58.051903+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:12:58.051903+05:30","labels":["layer:api","phase:1"]}
{"id":"gu-4s20","title":"Implement typed error hierarchy for CLI operations","description":"# Typed Error Hierarchy Implementation\n\n## Background\nAll CLI operations can fail in various ways. A typed error hierarchy enables\nconsistent error handling and informative error responses.\n\n## Error Types\n\n### Base Error\n```typescript\nexport class CliError extends Error {\n  constructor(\n    message: string,\n    public code: string,\n    public requestId: string,\n    public details?: unknown\n  ) {\n    super(message);\n    this.name = 'CliError';\n  }\n\n  toJSON() {\n    return {\n      error: this.code,\n      message: this.message,\n      requestId: this.requestId,\n      details: this.details\n    };\n  }\n}\n```\n\n### Specific Errors\n```typescript\n// CLI command timed out\nexport class TimeoutError extends CliError {\n  constructor(command: string, timeout: number, requestId: string) {\n    super(\n      `Command '${command}' timed out after ${timeout}ms`,\n      'TIMEOUT',\n      requestId,\n      { command, timeout }\n    );\n  }\n}\n\n// CLI exited with non-zero\nexport class ExitError extends CliError {\n  constructor(command: string, exitCode: number, stderr: string, requestId: string) {\n    super(\n      `Command '${command}' failed with exit code ${exitCode}`,\n      'CLI_ERROR',\n      requestId,\n      { command, exitCode, stderr }\n    );\n  }\n}\n\n// JSON parse failed\nexport class ParseError extends CliError {\n  constructor(command: string, output: string, requestId: string) {\n    super(\n      `Failed to parse JSON output from '${command}'`,\n      'PARSE_ERROR',\n      requestId,\n      { command, output: output.substring(0, 500) }\n    );\n  }\n}\n\n// Schema validation failed\nexport class ContractMismatchError extends CliError {\n  constructor(context: string, issues: z.ZodIssue[], requestId: string) {\n    super(\n      `Schema mismatch: ${context}`,\n      'SCHEMA_MISMATCH',\n      requestId,\n      { issues }\n    );\n  }\n}\n\n// Known bug with workaround\nexport class KnownBugError extends CliError {\n  constructor(bug: string, workaround: string, requestId: string) {\n    super(\n      `Known bug: ${bug}. Workaround: ${workaround}`,\n      'KNOWN_BUG',\n      requestId,\n      { bug, workaround }\n    );\n  }\n}\n```\n\n## Acceptance Criteria\n- [ ] All error types extend CliError\n- [ ] toJSON() returns consistent error structure\n- [ ] requestId included in all errors\n- [ ] Error codes documented\n- [ ] Unit tests for each error type\n\n## Files\n- src/lib/server/cli/errors.ts\n- src/lib/server/cli/__tests__/errors.test.ts\n\n## References\n- INTEGRATION_PLAN D2.4: Effect.ts Error Handling\n- INTEGRATION_PLAN: Error Codes section\n\n(Moved from hq-0qb.6)","status":"open","priority":2,"issue_type":"task","estimated_minutes":60,"created_at":"2026-01-12T23:13:27.082593+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:13:27.082593+05:30","labels":["layer:foundation","phase:1"]}
{"id":"gu-4sg","title":"[P1] Testing: Unit, Integration \u0026 Manual Verification","description":"# Phase 1 Testing Layer\n\n## Background\nTesting ensures reliability and prevents regressions. The INTEGRATION_PLAN specifies\na comprehensive testing strategy with unit tests, integration tests, and manual\nverification checklists.\n\n## Testing Strategy (from INTEGRATION_PLAN v5.0)\n\n### Unit Tests (Vitest)\n- Process Supervisor: spawn behavior, timeout handling\n- SWR Cache: TTL expiry, invalidation, race conditions\n- Stores: reactive updates, computed values\n- CLI Contracts: Zod schema validation\n\n### Integration Tests (Vitest)\n- API routes with mocked CLI\n- SSE stream behavior\n- Error propagation\n\n### Manual Verification (No Playwright - repo posture)\n- CUJ-1: Rig Management flow\n- CUJ-2: Work Item Lifecycle flow\n- CUJ-3: Sling (Orchestration) flow\n- CUJ-4: System Monitoring flow\n- CUJ-5: Mail View flow\n\n## Why This Matters\n- Unit tests catch logic errors early\n- Integration tests verify component interaction\n- Manual CUJ verification ensures real-world usability\n- Contract tests prevent CLI output format regressions\n\n## Acceptance Criteria\n- [ ] Unit test coverage \u003e 80% for server code\n- [ ] All API routes have integration tests\n- [ ] CUJ verification checklists documented\n- [ ] Contract tests for all CLI JSON outputs\n- [ ] Test fixtures for known CLI outputs\n- [ ] CI runs tests on every PR\n\n## Architecture Decision References\n- D4.1: Testing Strategy\n- D4.2: CI/CD Requirements\n\n## Dependencies\n- EPIC: Foundation Layer (hq-0qb)\n- EPIC: Data Layer (hq-bpb)\n- EPIC: API Routes (hq-0er)\n- EPIC: UI Layer (hq-wbe)\n\n## Files to Create/Modify\n- src/lib/server/cli/__tests__/process-supervisor.test.ts\n- src/lib/server/cli/__tests__/capabilities.test.ts\n- src/lib/stores/__tests__/swr.test.ts\n- src/routes/api/gastown/__tests__/*.test.ts\n- docs/TESTING.md\n- docs/CUJ_VERIFICATION.md\n\n(Moved from hq-nbf)","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-12T23:11:32.632796+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:11:32.632796+05:30","labels":["layer:testing","phase:1"]}
{"id":"gu-4si","title":"Phase 1 Data Layer Sprint","description":"# Phase 1 Data Layer Sprint\n\nData layer work including SWR caching, reactive stores, and file watchers.\n\n## Scope\n- SWR Cache implementation\n- Svelte 5 reactive stores\n- Beads directory watcher\n- Operations store\n\n## Dependencies\nFoundation convoy (hq-ve0)\n\n## Exit Criteria\nAll data layer components implemented and unit tested.\n\n(Moved from hq-bto)","status":"open","priority":1,"issue_type":"convoy","created_at":"2026-01-12T23:11:40.451896+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:11:40.451896+05:30","labels":["phase:1","sprint:data"],"dependencies":[{"issue_id":"gu-4si","depends_on_id":"gu-xif","type":"blocks","created_at":"2026-01-12T23:23:04.16745+05:30","created_by":"Avyukth"},{"issue_id":"gu-4si","depends_on_id":"gu-xcm","type":"blocks","created_at":"2026-01-12T23:23:04.240996+05:30","created_by":"Avyukth"},{"issue_id":"gu-4si","depends_on_id":"gu-32m","type":"blocks","created_at":"2026-01-12T23:23:04.327106+05:30","created_by":"Avyukth"},{"issue_id":"gu-4si","depends_on_id":"gu-cn7","type":"blocks","created_at":"2026-01-12T23:23:04.408359+05:30","created_by":"Avyukth"},{"issue_id":"gu-4si","depends_on_id":"gu-pod","type":"blocks","created_at":"2026-01-12T23:25:18.077755+05:30","created_by":"Avyukth"},{"issue_id":"gu-4si","depends_on_id":"gu-gwqi","type":"blocks","created_at":"2026-01-13T00:37:28.431309+05:30","created_by":"Avyukth"}]}
{"id":"gu-4t8","title":"[P1] Documentation: LLM-Friendly \u0026 Developer Guides","description":"# Phase 1 Documentation Layer\n\n## Background\nDocumentation serves two audiences: humans (developers) and LLMs (Claude Code agents).\nThe INTEGRATION_PLAN specifies serving /llms.txt and /llms-full.txt for machine-readable\ncontext.\n\n## Key Innovations (from INTEGRATION_PLAN v5.0)\n1. **LLM-Friendly Docs (D0.9)**: /llms.txt and /llms-full.txt\n2. **API Documentation**: OpenAPI-style endpoint docs\n3. **Architecture Decision Records**: Documenting the \"why\"\n\n## Documentation to Create\n\n### For LLMs\n- static/llms.txt: Concise project index\n- static/llms-full.txt: Full documentation bundle\n- scripts/generate-llms-txt.ts: Generator script\n\n### For Developers\n- docs/ARCHITECTURE.md: System architecture overview\n- docs/API.md: API endpoint reference\n- docs/DEVELOPMENT.md: Development setup guide\n- docs/DEPLOYMENT.md: Deployment guide\n- docs/TROUBLESHOOTING.md: Common issues and fixes\n\n## Why This Matters\n- LLM docs enable Claude Code to work effectively on codebase\n- Developer docs reduce onboarding time\n- ADRs preserve decision context for future maintainers\n- Troubleshooting docs prevent repeated debugging\n\n## Acceptance Criteria\n- [ ] /llms.txt accessible via static route\n- [ ] llms-full.txt includes all markdown docs\n- [ ] Generator script runs in CI on docs changes\n- [ ] Architecture doc matches implementation\n- [ ] API docs cover all endpoints with examples\n- [ ] Troubleshooting includes known CLI bugs\n\n## Architecture Decision References\n- D0.9: LLM-Friendly Docs\n- D4.3: Documentation Strategy\n\n## Dependencies\n- EPIC: API Routes (hq-0er) - for API documentation\n\n## Files to Create/Modify\n- static/llms.txt\n- static/llms-full.txt\n- scripts/generate-llms-txt.ts\n- docs/ARCHITECTURE.md\n- docs/API.md\n- docs/DEVELOPMENT.md\n- docs/DEPLOYMENT.md\n- docs/TROUBLESHOOTING.md\n\n(Moved from hq-1cj)","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-12T23:11:32.750811+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:11:32.750811+05:30","labels":["layer:docs","phase:1"]}
{"id":"gu-598","title":"Phase 1 UI Sprint","description":"# Phase 1 UI Sprint\n\nUI components and pages for Phase 1.\n\n## Scope\n- Operation Center FAB\n- Command Palette\n- Global Search\n- Toast system\n- Error Boundary\n- All page views (Dashboard, Work, Convoys, Mail, Rigs, Queue)\n\n## Dependencies\nData Layer (hq-bto) and API Routes (hq-43u) convoys\n\n## Exit Criteria\nAll UI components and pages implemented, responsive across platforms.\n\n(Moved from hq-8r4)","status":"open","priority":1,"issue_type":"convoy","created_at":"2026-01-12T23:11:40.69502+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:11:40.69502+05:30","labels":["phase:1","sprint:ui"],"dependencies":[{"issue_id":"gu-598","depends_on_id":"gu-1zc","type":"blocks","created_at":"2026-01-12T23:23:29.967979+05:30","created_by":"Avyukth"},{"issue_id":"gu-598","depends_on_id":"gu-7e5","type":"blocks","created_at":"2026-01-12T23:23:30.046945+05:30","created_by":"Avyukth"},{"issue_id":"gu-598","depends_on_id":"gu-ai5","type":"blocks","created_at":"2026-01-12T23:23:30.119001+05:30","created_by":"Avyukth"},{"issue_id":"gu-598","depends_on_id":"gu-gj4","type":"blocks","created_at":"2026-01-12T23:23:30.193081+05:30","created_by":"Avyukth"},{"issue_id":"gu-598","depends_on_id":"gu-4op","type":"blocks","created_at":"2026-01-12T23:23:30.265267+05:30","created_by":"Avyukth"},{"issue_id":"gu-598","depends_on_id":"gu-j7v","type":"blocks","created_at":"2026-01-12T23:23:30.343708+05:30","created_by":"Avyukth"},{"issue_id":"gu-598","depends_on_id":"gu-14h","type":"blocks","created_at":"2026-01-12T23:23:30.413487+05:30","created_by":"Avyukth"},{"issue_id":"gu-598","depends_on_id":"gu-tlt","type":"blocks","created_at":"2026-01-12T23:23:30.483232+05:30","created_by":"Avyukth"},{"issue_id":"gu-598","depends_on_id":"gu-cnc","type":"blocks","created_at":"2026-01-12T23:23:30.554238+05:30","created_by":"Avyukth"},{"issue_id":"gu-598","depends_on_id":"gu-yk5","type":"blocks","created_at":"2026-01-12T23:25:18.527462+05:30","created_by":"Avyukth"},{"issue_id":"gu-598","depends_on_id":"gu-4si","type":"blocks","created_at":"2026-01-12T23:25:18.645889+05:30","created_by":"Avyukth"},{"issue_id":"gu-598","depends_on_id":"gu-ayx","type":"blocks","created_at":"2026-01-13T00:03:47.486626+05:30","created_by":"Avyukth"},{"issue_id":"gu-598","depends_on_id":"gu-ael","type":"blocks","created_at":"2026-01-13T00:03:47.590697+05:30","created_by":"Avyukth"},{"issue_id":"gu-598","depends_on_id":"gu-761","type":"blocks","created_at":"2026-01-13T00:03:47.693378+05:30","created_by":"Avyukth"},{"issue_id":"gu-598","depends_on_id":"gu-x78k","type":"blocks","created_at":"2026-01-13T00:37:28.546926+05:30","created_by":"Avyukth"},{"issue_id":"gu-598","depends_on_id":"gu-83zz","type":"blocks","created_at":"2026-01-13T00:37:28.65264+05:30","created_by":"Avyukth"},{"issue_id":"gu-598","depends_on_id":"gu-64cz","type":"blocks","created_at":"2026-01-13T01:03:41.069435+05:30","created_by":"Avyukth"},{"issue_id":"gu-598","depends_on_id":"gu-0pq3","type":"blocks","created_at":"2026-01-13T01:05:09.32838+05:30","created_by":"Avyukth"}]}
{"id":"gu-5ap","title":"Implement ARIA patterns for all components","description":"# ARIA Patterns Implementation\n\n## Component Patterns\n\n| Component | ARIA Pattern | Key Attributes |\n|-----------|--------------|----------------|\n| Agent Card | Card | role=\"article\", aria-labelledby |\n| Agent List | Feed | role=\"feed\", aria-busy |\n| Status Badge | Status | role=\"status\", color + text |\n| Modal | Dialog | role=\"dialog\", aria-modal=\"true\" |\n| Dropdown | Listbox | role=\"listbox\", aria-expanded |\n| Toast | Alert | role=\"alert\", aria-live=\"polite\" |\n| Loading | Status | aria-busy=\"true\" |\n| Tabs | Tablist | role=\"tablist\", aria-selected |\n\n## Focus Management\n```css\n:focus-visible {\n  outline: 2px solid var(--color-focus);\n  outline-offset: 2px;\n}\n```\n\n## Reduced Motion\n```css\n@media (prefers-reduced-motion: reduce) {\n  *, *::before, *::after {\n    animation-duration: 0.01ms !important;\n    transition-duration: 0.01ms !important;\n  }\n}\n```\n\n## Acceptance Criteria\n- [ ] All components have correct ARIA roles\n- [ ] Focus visible on all interactive elements\n- [ ] Reduced motion respected\n- [ ] Screen reader announces state changes\n- [ ] axe-core audit passes\n\n## Files\n- All component files (audit and update)\n- src/app.css (focus styles)\n\n## References\n- INTEGRATION_PLAN: ARIA Patterns section\n\n(Moved from hq-iri.2)","status":"open","priority":2,"issue_type":"task","estimated_minutes":180,"created_at":"2026-01-12T23:13:25.445518+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:13:25.445518+05:30","labels":["layer:perf-a11y","phase:1"]}
{"id":"gu-5hp","title":"Implement /api/gastown/convoys endpoint","description":"# Convoys Endpoint Implementation\n\n## Background\nReturns convoy list with their contained work items. Convoys are batched work\ngroups used for tracking related tasks.\n\n## CLI Command\n```bash\ngt convoy list --json\n```\n\n## Expected Response\n```json\n{\n  \"convoys\": [\n    {\n      \"id\": \"convoy-abc\",\n      \"title\": \"Phase 1 Implementation\",\n      \"status\": \"active\",\n      \"items\": [\"bd-123\", \"bd-124\", \"bd-125\"],\n      \"progress\": 33,\n      \"created_at\": \"2026-01-12T10:00:00Z\"\n    }\n  ],\n  \"timestamp\": \"2026-01-12T10:00:00Z\"\n}\n```\n\n## Implementation Notes\n- Convoy progress calculated from contained items\n- Items array contains bead IDs, not full objects\n- Use /api/gastown/convoys/[id] for full convoy details\n\n## Acceptance Criteria\n- [ ] Returns convoy list JSON\n- [ ] Progress calculated from item statuses\n- [ ] Uses SWR cache with 30s stale time\n- [ ] Validates response with Zod contract\n- [ ] Unit test with mocked CLI\n\n## Files\n- src/routes/api/gastown/convoys/+server.ts\n- src/routes/api/gastown/convoys/__tests__/server.test.ts\n\n## References\n- INTEGRATION_PLAN: Convoys Endpoint section\n- CLI: gt convoy list --json\n\n(Moved from hq-0er.3)","status":"open","priority":1,"issue_type":"task","estimated_minutes":60,"created_at":"2026-01-12T23:12:57.945904+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:12:57.945904+05:30","labels":["layer:api","phase:1"]}
{"id":"gu-5ze","title":"Implement Rate Limiting Middleware","description":"# Rate Limiting Middleware\n\n## Implementation\n```typescript\n// src/lib/server/rate-limit.ts\n\nconst RATE_LIMITS: Record\u003cstring, { windowMs: number; maxRequests: number }\u003e = {\n  'GET:/api/gastown/status': { windowMs: 1000, maxRequests: 10 },\n  'GET:/api/gastown/*': { windowMs: 1000, maxRequests: 20 },\n  'POST:/api/gastown/rigs': { windowMs: 60000, maxRequests: 5 },\n  'POST:/api/gastown/work/*': { windowMs: 10000, maxRequests: 10 },\n  'POST:/api/gastown/work/sling': { windowMs: 5000, maxRequests: 5 },\n  'default': { windowMs: 1000, maxRequests: 50 },\n};\n\ninterface RateLimitState {\n  count: number;\n  resetAt: number;\n}\n\nconst clients = new Map\u003cstring, Map\u003cstring, RateLimitState\u003e\u003e();\n\nexport function checkRateLimit(\n  clientId: string,\n  path: string,\n  method: string\n): { allowed: boolean; retryAfter?: number } {\n  const key = `${method}:${path}`;\n  const limit = RATE_LIMITS[key] ?? RATE_LIMITS['default'];\n  // ... implementation\n}\n```\n\n## Acceptance Criteria\n- [ ] Per-endpoint rate limits\n- [ ] Returns 429 with Retry-After header\n- [ ] Clear error messages\n- [ ] Unit tests for rate limiting logic\n- [ ] Configurable via environment\n\n## Files\n- src/lib/server/rate-limit.ts\n- src/lib/server/__tests__/rate-limit.test.ts\n- src/hooks.server.ts (integration)\n\n## References\n- INTEGRATION_PLAN: Rate Limiting section\n\n(Moved from hq-m9x.3)","status":"open","priority":1,"issue_type":"task","estimated_minutes":90,"created_at":"2026-01-12T23:12:55.605335+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:12:55.605335+05:30","labels":["layer:security","phase:1"]}
{"id":"gu-60m","title":"Implement Mobile Touch Targets (44px minimum)","description":"# Mobile Touch Targets\n\nEnsures all interactive elements meet 44x44px minimum touch target size per WCAG 2.5.5.\n\n## Requirements\n\nPer AGENTS.md and WCAG guidelines:\n- Minimum 44x44px touch target\n- 8px minimum spacing between targets\n- No overlapping touch areas\n\n## Implementation\n\n### Base Button Styles\n\n```css\n/* src/lib/styles/touch-targets.css */\n:root {\n  --touch-target-min: 44px;\n  --touch-target-spacing: 8px;\n}\n\n/* Ensure all buttons meet minimum size */\nbutton,\na[role=\"button\"],\n[role=\"button\"],\ninput[type=\"checkbox\"],\ninput[type=\"radio\"] {\n  min-width: var(--touch-target-min);\n  min-height: var(--touch-target-min);\n}\n\n/* Icon buttons with padding for touch area */\n.icon-btn {\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  min-width: var(--touch-target-min);\n  min-height: var(--touch-target-min);\n  padding: 10px;\n}\n\n/* List items as touch targets */\n.touch-list-item {\n  min-height: var(--touch-target-min);\n  padding: 12px 16px;\n}\n```\n\n### Touch Target Component\n\n```svelte\n\u003c!-- src/lib/components/TouchTarget.svelte --\u003e\n\u003cscript lang=\"ts\"\u003e\n  import type { Snippet } from \"svelte\";\n  \n  interface Props {\n    as?: \"button\" | \"a\" | \"div\";\n    children: Snippet;\n    onclick?: () =\u003e void;\n  }\n  \n  let { as = \"button\", children, onclick }: Props = $props();\n\u003c/script\u003e\n\n\u003csvelte:element\n  this={as}\n  class=\"touch-target\"\n  role={as === \"div\" ? \"button\" : undefined}\n  tabindex={as === \"div\" ? 0 : undefined}\n  {onclick}\n\u003e\n  {@render children()}\n\u003c/svelte:element\u003e\n\n\u003cstyle\u003e\n  .touch-target {\n    min-width: 44px;\n    min-height: 44px;\n    display: inline-flex;\n    align-items: center;\n    justify-content: center;\n  }\n\u003c/style\u003e\n```\n\n## Audit Checklist\n\n- [ ] All buttons \u003e= 44x44px\n- [ ] All links in navigation \u003e= 44x44px\n- [ ] Form inputs and checkboxes \u003e= 44x44px\n- [ ] Close buttons and icons \u003e= 44x44px\n- [ ] List items tappable area \u003e= 44x44px\n- [ ] 8px spacing between adjacent targets\n\n## Tests\n\n- Visual regression: Touch target size overlay\n- Automated: CSS computed size check\n- Manual: Test on actual mobile device\n\n\n(Moved from hq-etz)","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-12T23:12:53.85486+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:12:53.85486+05:30","labels":["layer:a11y","layer:mobile","phase:1"]}
{"id":"gu-64cz","title":"Implement Operation Center UI component","description":"# Operation Center UI Component\n\n## Background\nThe Operation Center shows all running and recent operations, providing visibility\ninto long-running tasks like rig adds, formula runs, etc.\n\n## CRITICAL UX Requirements\n- UI must NEVER freeze during long operations\n- Operations must show progress\n- Cancel and retry buttons must work\n- \"Copy debug bundle\" for failed operations\n\n## Component Structure\n```svelte\n\u003c!-- src/lib/components/OperationCenter.svelte --\u003e\n\u003cscript lang=\"ts\"\u003e\n  import { operationsStore } from '$lib/stores/operations.svelte';\n  import { onMount } from 'svelte';\n  \n  let expanded = $state(false);\n  \n  // Auto-expand when operations start\n  $effect(() =\u003e {\n    if (operationsStore.hasRunning \u0026\u0026 !expanded) {\n      expanded = true;\n    }\n  });\n\u003c/script\u003e\n\n\u003c!-- Collapsed: floating badge --\u003e\n{#if !expanded}\n  \u003cbutton \n    class=\"operation-badge\"\n    onclick={() =\u003e expanded = true}\n    data-testid=\"operation-center-badge\"\n    aria-label=\"View operations\"\n  \u003e\n    {#if operationsStore.hasRunning}\n      \u003cspan class=\"pulse\"\u003e\u003c/span\u003e\n      \u003cspan\u003e{operationsStore.running.length} running\u003c/span\u003e\n    {:else}\n      \u003cspan\u003eOperations\u003c/span\u003e\n    {/if}\n  \u003c/button\u003e\n{/if}\n\n\u003c!-- Expanded: slide-out panel --\u003e\n{#if expanded}\n  \u003caside \n    class=\"operation-panel\"\n    data-testid=\"operation-center-panel\"\n    role=\"region\"\n    aria-label=\"Operation center\"\n  \u003e\n    \u003cheader\u003e\n      \u003ch2\u003eOperations\u003c/h2\u003e\n      \u003cbutton onclick={() =\u003e expanded = false} aria-label=\"Close\"\u003e√ó\u003c/button\u003e\n    \u003c/header\u003e\n    \n    \u003cdiv class=\"operation-list\"\u003e\n      {#each operationsStore.recent as op (op.id)}\n        \u003carticle \n          class=\"operation-item\" \n          data-status={op.status}\n          data-testid=\"operation-item\"\n          data-operation-id={op.id}\n        \u003e\n          \u003cdiv class=\"operation-header\"\u003e\n            \u003cspan class=\"operation-type\"\u003e{op.type}\u003c/span\u003e\n            \u003cspan class=\"operation-status\"\u003e{op.status}\u003c/span\u003e\n          \u003c/div\u003e\n          \n          {#if op.status === 'running' \u0026\u0026 op.progress !== undefined}\n            \u003cprogress value={op.progress} max=\"100\" aria-label=\"Progress\"\u003e\n              {op.progress}%\n            \u003c/progress\u003e\n          {/if}\n          \n          {#if op.logs.length \u003e 0}\n            \u003cdetails\u003e\n              \u003csummary\u003eLogs ({op.logs.length})\u003c/summary\u003e\n              \u003cpre class=\"operation-logs\"\u003e{op.logs.join('\\n')}\u003c/pre\u003e\n            \u003c/details\u003e\n          {/if}\n          \n          \u003cdiv class=\"operation-actions\"\u003e\n            {#if op.status === 'running'}\n              \u003cbutton \n                onclick={() =\u003e operationsStore.cancel(op.id)}\n                data-testid=\"operation-cancel\"\n              \u003e\n                Cancel\n              \u003c/button\u003e\n            {/if}\n            {#if op.status === 'failed'}\n              \u003cbutton \n                onclick={() =\u003e operationsStore.retry(op.id)}\n                data-testid=\"operation-retry\"\n              \u003e\n                Retry\n              \u003c/button\u003e\n              \u003cbutton \n                onclick={() =\u003e copyDebugBundle(op)}\n                data-testid=\"operation-copy-debug\"\n              \u003e\n                Copy debug info\n              \u003c/button\u003e\n            {/if}\n          \u003c/div\u003e\n          \n          {#if op.error}\n            \u003cp class=\"operation-error\"\u003e{op.error}\u003c/p\u003e\n          {/if}\n          \n          \u003ctime class=\"operation-time\"\u003e\n            {formatDuration(op.startedAt, op.completedAt)}\n          \u003c/time\u003e\n        \u003c/article\u003e\n      {:else}\n        \u003cp class=\"empty-state\"\u003eNo operations yet\u003c/p\u003e\n      {/each}\n    \u003c/div\u003e\n    \n    {#if operationsStore.operations.some(o =\u003e o.status === 'completed' || o.status === 'failed')}\n      \u003cbutton \n        class=\"clear-completed\"\n        onclick={() =\u003e operationsStore.clearCompleted()}\n        data-testid=\"clear-completed\"\n      \u003e\n        Clear completed\n      \u003c/button\u003e\n    {/if}\n  \u003c/aside\u003e\n{/if}\n```\n\n## Styling\n- Floating badge in bottom-right corner\n- Slide-out panel from right\n- Status colors: running=blue, completed=green, failed=red, cancelled=gray\n- Progress bar for operations with progress\n- Collapsible logs section\n\n## Keyboard Navigation\n- Escape closes panel\n- Arrow keys navigate operations\n- Enter expands/collapses logs\n\n## Acceptance Criteria\n- [ ] Shows running/recent operations\n- [ ] Progress bar when progress available\n- [ ] Expandable logs\n- [ ] Cancel button for running operations\n- [ ] Retry button for failed operations\n- [ ] Copy debug bundle for failed operations\n- [ ] Clear completed button\n- [ ] Auto-expands when operations start\n- [ ] data-testid attributes for testing\n- [ ] ARIA labels for accessibility\n- [ ] Keyboard navigation works\n- [ ] Responsive: works on mobile\n\n## Files\n- src/lib/components/OperationCenter.svelte\n- src/lib/components/__tests__/OperationCenter.test.ts\n\n## Dependencies\n- gu-cn7: Operations Store (must be complete first)\n\n## References\n- INTEGRATION_PLAN: Long-Running Operations section\n- INTEGRATION_PLAN: D0.10 Observable Operations","status":"open","priority":1,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-13T01:03:32.194084+05:30","created_by":"Avyukth","updated_at":"2026-01-13T01:03:32.194084+05:30","labels":["layer:ui","phase:1","priority:critical"]}
{"id":"gu-6gcr","title":"Implement /api/gastown/workflows/formulas endpoint","description":"## Overview\nImplement the formulas listing endpoint for workflow management.\n\n## API Specification (from INTEGRATION_PLAN.md v5.1)\n- **Route**: `/api/gastown/workflows/formulas`\n- **Method**: GET\n- **CLI Command**: `gt formula list`\n- **Response**: `GtFormula[]`\n- **Timeout**: 30s\n- **Cache TTL**: 30s\n\n## Implementation Requirements\n\n### 1. SvelteKit Route Handler\n```typescript\n// src/routes/api/gastown/workflows/formulas/+server.ts\nimport { json, error } from '@sveltejs/kit';\nimport { processSupervisor } from '$lib/server/process-supervisor';\nimport { withCircuitBreaker } from '$lib/server/circuit-breaker';\nimport { GtFormulaArraySchema } from '$lib/contracts/workflows';\n\nexport async function GET({ setHeaders }) {\n  const result = await withCircuitBreaker(\n    'formula-list',\n    () =\u003e processSupervisor.exec('gt', ['formula', 'list', '--json']),\n    { timeout: 30000 }\n  );\n  \n  const formulas = GtFormulaArraySchema.parse(JSON.parse(result.stdout));\n  \n  setHeaders({\n    'Cache-Control': 'public, max-age=30, stale-while-revalidate=60'\n  });\n  \n  return json(formulas);\n}\n```\n\n### 2. Zod Contract\n```typescript\n// Add to lib/contracts/workflows.ts\nexport const GtFormulaSchema = z.object({\n  name: z.string(),\n  description: z.string().optional(),\n  steps: z.array(z.object({\n    id: z.string(),\n    name: z.string(),\n    command: z.string().optional()\n  })),\n});\n\nexport const GtFormulaArraySchema = z.array(GtFormulaSchema);\n```\n\n### 3. Two-Phase Feedback (if called from UI)\nWhen listing formulas from UI:\n- Phase 1: \"Loading formulas...\"\n- Phase 2: \"Loaded {count} formulas\"\n\n### 4. Error Handling\n- Timeout after 30s with user-friendly message\n- Circuit breaker prevents cascade failures\n- Log stderr to server logs for debugging\n\n## Acceptance Criteria\n- [ ] Route returns valid JSON array of formulas\n- [ ] Response validates against Zod schema\n- [ ] Timeout properly configured (30s)\n- [ ] Cache headers set (30s TTL, 60s stale-while-revalidate)\n- [ ] Uses Process Supervisor (no execSync)\n- [ ] Circuit breaker protects against failures\n- [ ] Errors return proper ApiErrorResponse format\n\n## Testing\n- [ ] Unit test: mock CLI output, verify parsing\n- [ ] Integration test: call real gt formula list, verify response\n- [ ] Error test: verify timeout handling\n- [ ] Contract test: verify Zod schema matches real output","status":"closed","priority":1,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-13T00:56:52.606206+05:30","created_by":"Avyukth","updated_at":"2026-01-13T01:17:43.492877+05:30","closed_at":"2026-01-13T01:17:43.492877+05:30","close_reason":"Already implemented: /api/gastown/workflows/formulas exists","labels":["layer:api","phase:1"]}
{"id":"gu-6gf","title":"Digest: mol-refinery-patrol","description":"Patrol: queue empty, no branches to merge","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-12T20:58:02.686286+05:30","updated_at":"2026-01-12T20:58:02.686286+05:30","closed_at":"2026-01-12T20:58:02.686233+05:30","close_reason":"Squashed from 11 wisps"}
{"id":"gu-731","title":"Implement Capabilities Probe for CLI version detection","description":"# Capabilities Probe Implementation\n\n## Background\nThe Capabilities Probe detects CLI version and available features at startup.\nThis enables graceful degradation when CLI versions differ between environments.\n\n## Why This Matters\n- CLI changes over time (new flags, changed output)\n- UI needs to know what features are available\n- Graceful degradation better than hard failures\n- Enables feature flags based on CLI version\n\n## Implementation Requirements\n\n### Probe Logic\n```typescript\ninterface Capabilities {\n  gtVersion: string;       // \"1.2.3\"\n  bdVersion: string;       // \"1.0.0\"\n  features: {\n    jsonOutput: boolean;   // Supports --json flag\n    mailInbox: boolean;    // gt mail inbox works (false if Node hang bug)\n    sseTailing: boolean;   // .events.jsonl exists\n    convoys: boolean;      // Convoy support available\n    formulas: boolean;     // Formula/molecule support\n  };\n  paths: {\n    workspace: string;     // Gas Town workspace path\n    beadsDb: string;       // .beads/ directory\n    eventsFile: string;    // .beads/.events.jsonl (if exists)\n  };\n}\n```\n\n### Detection Methods\n1. **Version**: Run `gt version` and `bd version`\n2. **JSON support**: Run `gt status --json` and check for valid JSON\n3. **Mail bug**: Probe with short timeout, set feature=false if hangs\n4. **SSE tailing**: Check if .events.jsonl exists\n5. **Paths**: Auto-discover from environment\n\n### Caching\n- Probe once at server startup\n- Re-probe on explicit refresh request\n- Cache for 1 hour (version unlikely to change)\n\n## Acceptance Criteria\n- [ ] Detects gt and bd versions\n- [ ] Probes all feature flags\n- [ ] Handles missing commands gracefully\n- [ ] Caches results appropriately\n- [ ] Exposed via /api/gastown/capabilities endpoint\n- [ ] Unit tests mock CLI responses\n\n## Files\n- src/lib/server/cli/capabilities.ts\n- src/lib/server/cli/__tests__/capabilities.test.ts\n- src/routes/api/gastown/capabilities/+server.ts\n\n## References\n- INTEGRATION_PLAN D0.6: Capabilities Probe + CLI Contracts\n\n(Moved from hq-0qb.3)","status":"open","priority":1,"issue_type":"task","estimated_minutes":90,"created_at":"2026-01-12T23:12:58.874935+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:12:58.874935+05:30","labels":["layer:foundation","phase:1"]}
{"id":"gu-73p","title":"Unit tests: SWR Cache","description":"# Unit Tests: SWR Cache\n\n## Test Cases\n\n### Fresh Cache\n- [x] Cache miss calls fetcher\n- [x] Cache hit returns cached data\n- [x] Fresh data returned immediately\n\n### Stale Cache\n- [x] Stale data returned immediately\n- [x] Background revalidation triggered\n- [x] Cache updated after revalidation\n\n### Invalidation\n- [x] Single key invalidation works\n- [x] Prefix invalidation works\n- [x] Invalidated keys refetch on next access\n\n### TTL\n- [x] Data becomes stale after staleTime\n- [x] Data deleted after cacheTime\n- [x] Custom TTLs respected\n\n### Race Conditions\n- [x] Concurrent requests deduplicated\n- [x] Revalidation doesn't block reads\n\n## Test Setup\n```typescript\nimport { describe, it, expect, vi } from 'vitest';\nimport { SWRCache } from '../swr';\n\ndescribe('SWRCache', () =\u003e {\n  it('returns cached data on hit', async () =\u003e {\n    const cache = new SWRCache();\n    const fetcher = vi.fn().mockResolvedValue({ data: 'test' });\n\n    await cache.get('key', fetcher);\n    const result = await cache.get('key', fetcher);\n\n    expect(fetcher).toHaveBeenCalledTimes(1);\n    expect(result).toEqual({ data: 'test' });\n  });\n});\n```\n\n## Acceptance Criteria\n- [ ] All test cases pass\n- [ ] Coverage \u003e 90%\n- [ ] Race conditions handled correctly\n\n## Files\n- src/lib/server/cache/__tests__/swr.test.ts\n\n## References\n- Task: hq-bpb.1 (SWR Cache implementation)\n\n(Moved from hq-nbf.2)","status":"open","priority":1,"issue_type":"task","estimated_minutes":90,"created_at":"2026-01-12T23:12:56.433112+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:12:56.433112+05:30","labels":["layer:testing","phase:1","type:unit"]}
{"id":"gu-761","title":"Implement Keyboard Help overlay component","description":"# Keyboard Help Overlay Component\n\n## Background\nShows all available keyboard shortcuts when user presses `?`.\n\n## Trigger\n- Press `?` anywhere (except in input fields)\n- Press `Escape` to close\n\n## Layout\n```\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ  Keyboard Shortcuts                    [X]  ‚îÇ\n‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n‚îÇ  Navigation                                  ‚îÇ\n‚îÇ  g d    Go to Dashboard                     ‚îÇ\n‚îÇ  g w    Go to Work Items                    ‚îÇ\n‚îÇ  g r    Go to Rigs                          ‚îÇ\n‚îÇ  g m    Go to Mail                          ‚îÇ\n‚îÇ  g c    Go to Convoys                       ‚îÇ\n‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n‚îÇ  Lists                                       ‚îÇ\n‚îÇ  j      Next item                           ‚îÇ\n‚îÇ  k      Previous item                       ‚îÇ\n‚îÇ  Enter  Open selected                       ‚îÇ\n‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n‚îÇ  Actions                                     ‚îÇ\n‚îÇ  /      Focus search                        ‚îÇ\n‚îÇ  ‚åòK     Command palette                     ‚îÇ\n‚îÇ  r      Refresh data                        ‚îÇ\n‚îÇ  ?      Show this help                      ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n```\n\n## Implementation\n- Modal overlay with semi-transparent backdrop\n- Organized by category\n- Platform-aware (‚åò on Mac, Ctrl on Windows)\n- Accessible (focus trap, Escape to close)\n\n## Acceptance Criteria\n- [ ] `?` opens overlay\n- [ ] Escape closes overlay\n- [ ] All shortcuts documented\n- [ ] Platform-specific modifier keys shown\n- [ ] Focus trapped in modal\n- [ ] Click outside closes\n\n## Files\n- src/lib/components/KeyboardHelp.svelte\n\n## References\n- INTEGRATION_PLAN CUJ-6: Keyboard Navigation\n- Manual Verification Checklist CUJ-6","status":"closed","priority":1,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-12T23:40:23.575109+05:30","created_by":"Avyukth","updated_at":"2026-01-13T01:17:44.283226+05:30","closed_at":"2026-01-13T01:17:44.283226+05:30","close_reason":"Already implemented: KeyboardHelpDialog.svelte exists","labels":["layer:ui","phase:1"]}
{"id":"gu-7e5","title":"Implement Command Palette (Cmd+K)","description":"# Command Palette Implementation\n\n## Background\nPower users expect keyboard-driven navigation. The Command Palette (Cmd+K) provides\nquick access to all actions and navigation without touching the mouse.\n\n## UI Behavior\n- Trigger: Cmd+K (Mac) / Ctrl+K (Windows/Linux)\n- Modal overlay with search input\n- Fuzzy search across commands\n- Recent commands shown first\n- Keyboard navigation (arrows, Enter, Escape)\n\n## Command Categories\n1. **Navigation**: Go to Dashboard, Convoys, Work, Mail, Rigs, Queue\n2. **Actions**: Create work item, Refresh data, Run doctor\n3. **Search**: Search work items, Search mail\n4. **Settings**: Toggle theme, Open settings\n\n## Component Structure\n```svelte\n\u003c!-- src/lib/components/CommandPalette.svelte --\u003e\n\n\u003cscript lang=\"ts\"\u003e\n  import { goto } from '$app/navigation';\n  \n  let open = $state(false);\n  let query = $state('');\n  let selectedIndex = $state(0);\n  \n  const commands = [\n    { id: 'nav-dashboard', label: 'Go to Dashboard', action: () =\u003e goto('/') },\n    { id: 'nav-work', label: 'Go to Work Items', action: () =\u003e goto('/work') },\n    { id: 'nav-convoys', label: 'Go to Convoys', action: () =\u003e goto('/convoys') },\n    // ...\n  ];\n  \n  const filtered = $derived(\n    query \n      ? commands.filter(c =\u003e fuzzyMatch(c.label, query))\n      : commands\n  );\n  \n  function handleKeydown(event: KeyboardEvent) {\n    if ((event.metaKey || event.ctrlKey) \u0026\u0026 event.key === 'k') {\n      event.preventDefault();\n      open = true;\n    }\n    if (event.key === 'Escape') {\n      open = false;\n    }\n    if (event.key === 'ArrowDown') {\n      selectedIndex = Math.min(selectedIndex + 1, filtered.length - 1);\n    }\n    if (event.key === 'ArrowUp') {\n      selectedIndex = Math.max(selectedIndex - 1, 0);\n    }\n    if (event.key === 'Enter' \u0026\u0026 filtered[selectedIndex]) {\n      filtered[selectedIndex].action();\n      open = false;\n    }\n  }\n\u003c/script\u003e\n\n\u003csvelte:window onkeydown={handleKeydown} /\u003e\n\n{#if open}\n  \u003cdiv class=\"command-palette-overlay\" onclick={() =\u003e open = false}\u003e\n    \u003cdiv class=\"command-palette\" onclick|stopPropagation\u003e\n      \u003cinput\n        type=\"text\"\n        placeholder=\"Type a command...\"\n        bind:value={query}\n        autofocus\n      /\u003e\n      \u003cul\u003e\n        {#each filtered as command, i (command.id)}\n          \u003cli \n            class:selected={i === selectedIndex}\n            onclick={() =\u003e { command.action(); open = false; }}\n          \u003e\n            {command.label}\n          \u003c/li\u003e\n        {/each}\n      \u003c/ul\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n{/if}\n```\n\n## Acceptance Criteria\n- [ ] Opens with Cmd+K / Ctrl+K\n- [ ] Closes with Escape or click outside\n- [ ] Fuzzy search works\n- [ ] Arrow keys navigate\n- [ ] Enter executes command\n- [ ] Recent commands shown first\n- [ ] Accessible (focus trap, aria labels)\n- [ ] Works on all platforms\n\n## Files\n- src/lib/components/CommandPalette.svelte\n- src/lib/utils/fuzzy-match.ts\n- src/lib/components/__tests__/CommandPalette.test.ts\n\n## References\n- INTEGRATION_PLAN D0.8: Power-User Ergonomics\n- Pattern: VS Code, Raycast command palettes\n\n(Moved from hq-wbe.2)","status":"closed","priority":1,"issue_type":"task","estimated_minutes":120,"created_at":"2026-01-12T23:12:57.038561+05:30","created_by":"Avyukth","updated_at":"2026-01-13T01:20:58.492724+05:30","closed_at":"2026-01-13T01:20:58.492724+05:30","close_reason":"Already implemented: src/lib/components/command-palette/ exists","labels":["layer:ui","phase:1"]}
{"id":"gu-7isd","title":"Create golden fixtures for contract tests","description":"# Golden Fixtures for Contract Tests\n\n## Background\nGolden fixtures are recorded CLI output samples that contract tests validate against.\nThey ensure Zod schemas stay in sync with actual CLI behavior.\n\n## Implementation\n\n### Fixture Structure\n```\nsrc/lib/test/fixtures/\n‚îú‚îÄ‚îÄ gt/\n‚îÇ   ‚îú‚îÄ‚îÄ status.json       # gt status --fast --json\n‚îÇ   ‚îú‚îÄ‚îÄ rig-list.json     # gt rig list --json\n‚îÇ   ‚îú‚îÄ‚îÄ convoy-list.json  # gt convoy list --json\n‚îÇ   ‚îú‚îÄ‚îÄ mq-list.json      # gt mq list --json\n‚îÇ   ‚îî‚îÄ‚îÄ doctor.json       # gt doctor --json\n‚îú‚îÄ‚îÄ bd/\n‚îÇ   ‚îú‚îÄ‚îÄ list-tasks.json   # bd list --type=task --json\n‚îÇ   ‚îú‚îÄ‚îÄ show.json         # bd show \u003cid\u003e --json\n‚îÇ   ‚îú‚îÄ‚îÄ list-messages.json # bd list --type=message --json\n‚îÇ   ‚îî‚îÄ‚îÄ list-molecules.json # bd list --type=molecule --json\n‚îî‚îÄ‚îÄ README.md             # How to update fixtures\n```\n\n### Fixture Recording Script\n```typescript\n// scripts/record-fixtures.ts\n\nimport { execSync } from 'child_process';\nimport { writeFileSync, mkdirSync } from 'fs';\nimport { join } from 'path';\n\nconst FIXTURE_DIR = 'src/lib/test/fixtures';\n\nconst GT_COMMANDS = [\n  { name: 'status', cmd: 'gt status --fast --json' },\n  { name: 'rig-list', cmd: 'gt rig list --json' },\n  { name: 'convoy-list', cmd: 'gt convoy list --json' },\n  { name: 'mq-list', cmd: 'gt mq list --json' },\n  { name: 'doctor', cmd: 'gt doctor --json' }\n];\n\nconst BD_COMMANDS = [\n  { name: 'list-tasks', cmd: 'bd list --type=task --json' },\n  { name: 'list-messages', cmd: 'bd list --type=message --json' },\n  { name: 'list-molecules', cmd: 'bd list --type=molecule --json' }\n];\n\nasync function recordFixtures() {\n  console.log('Recording golden fixtures...\\n');\n  \n  mkdirSync(join(FIXTURE_DIR, 'gt'), { recursive: true });\n  mkdirSync(join(FIXTURE_DIR, 'bd'), { recursive: true });\n  \n  for (const { name, cmd } of GT_COMMANDS) {\n    console.log(\\`[gt] Recording \\${name}...\\`);\n    try {\n      const output = execSync(cmd, { encoding: 'utf8', timeout: 30000 });\n      const path = join(FIXTURE_DIR, 'gt', \\`\\${name}.json\\`);\n      writeFileSync(path, output);\n      console.log(\\`  ‚úì Saved to \\${path}\\`);\n    } catch (e) {\n      console.error(\\`  ‚úó Failed: \\${e.message}\\`);\n    }\n  }\n  \n  for (const { name, cmd } of BD_COMMANDS) {\n    console.log(\\`[bd] Recording \\${name}...\\`);\n    try {\n      const output = execSync(cmd, { encoding: 'utf8', timeout: 5000 });\n      const path = join(FIXTURE_DIR, 'bd', \\`\\${name}.json\\`);\n      writeFileSync(path, output);\n      console.log(\\`  ‚úì Saved to \\${path}\\`);\n    } catch (e) {\n      console.error(\\`  ‚úó Failed: \\${e.message}\\`);\n    }\n  }\n  \n  console.log('\\nDone! Review and commit the fixtures.');\n}\n\nrecordFixtures();\n```\n\n### Contract Test Example\n```typescript\n// src/lib/server/cli/__tests__/contracts.test.ts\nimport { describe, it, expect } from 'vitest';\nimport { GtStatusSchema, GtRigArraySchema } from '$lib/contracts';\nimport statusFixture from '$lib/test/fixtures/gt/status.json';\nimport rigsFixture from '$lib/test/fixtures/gt/rig-list.json';\n\ndescribe('CLI Contract Tests', () =\u003e {\n  describe('gt status', () =\u003e {\n    it('matches GtStatusSchema', () =\u003e {\n      const result = GtStatusSchema.safeParse(statusFixture);\n      expect(result.success).toBe(true);\n      if (!result.success) {\n        console.error('Schema validation failed:', result.error.format());\n      }\n    });\n  });\n\n  describe('gt rig list', () =\u003e {\n    it('matches GtRigArraySchema', () =\u003e {\n      const result = GtRigArraySchema.safeParse(rigsFixture);\n      expect(result.success).toBe(true);\n      if (!result.success) {\n        console.error('Schema validation failed:', result.error.format());\n      }\n    });\n  });\n});\n```\n\n### Fixture README\n```markdown\n# Golden Fixtures\n\nThese are recorded CLI output samples for contract testing.\n\n## When to Update\n- After CLI tool updates that change JSON output\n- When adding new API endpoints\n- When Zod schemas fail validation\n\n## How to Update\n\\`\\`\\`bash\nbun run scripts/record-fixtures.ts\n\\`\\`\\`\n\nReview the diff carefully before committing!\n\n## DO NOT\n- Hand-edit fixtures (always re-record)\n- Commit fixtures with sensitive data\n- Delete fixtures without updating tests\n```\n\n## Acceptance Criteria\n- [ ] Fixture directory structure created\n- [ ] Recording script implemented\n- [ ] README documents update process\n- [ ] Contract tests validate fixtures against Zod schemas\n- [ ] All API endpoint outputs have fixtures\n- [ ] CI fails if schema validation fails\n- [ ] Detailed logging in recording script\n\n## Files\n- src/lib/test/fixtures/gt/*.json\n- src/lib/test/fixtures/bd/*.json\n- src/lib/test/fixtures/README.md\n- scripts/record-fixtures.ts\n- src/lib/server/cli/__tests__/contracts.test.ts\n\n## Dependencies\n- Zod contracts (gu-dze) must be complete\n\n## References\n- INTEGRATION_PLAN: Testing Strategy, Contract Tests","status":"open","priority":1,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-13T01:02:00.522471+05:30","created_by":"Avyukth","updated_at":"2026-01-13T01:02:00.522471+05:30","labels":["layer:testing","phase:1","type:contract"]}
{"id":"gu-83zz","title":"Implement Degraded Mode Banner component","description":"# Degraded Mode Banner Component\n\n## Background\nWhen watchers fail, daemon is unreachable, or live updates unavailable,\nusers MUST see a clear banner explaining the degraded state.\n\n## Degraded States\n| Condition | Message | Icon |\n|-----------|---------|------|\n| Daemon unreachable | \"Daemon offline - showing cached data\" | ‚ö†Ô∏è |\n| Watchers failed | \"Live updates unavailable - polling active\" | üì° |\n| Network offline | \"You're offline - showing cached data\" | üì¥ |\n| Events file missing | \"Activity stream unavailable\" | ‚ÑπÔ∏è |\n\n## Implementation\n```svelte\n\u003cscript lang=\"ts\"\u003e\n  import { capabilities } from '$lib/stores/capabilities.svelte';\n  import { connectionStatus } from '$lib/stores/connection.svelte';\n  import { browser } from '$app/environment';\n  \n  let isOnline = $state(browser ? navigator.onLine : true);\n  \n  $effect(() =\u003e {\n    if (!browser) return;\n    const handleOnline = () =\u003e isOnline = true;\n    const handleOffline = () =\u003e isOnline = false;\n    window.addEventListener('online', handleOnline);\n    window.addEventListener('offline', handleOffline);\n    return () =\u003e {\n      window.removeEventListener('online', handleOnline);\n      window.removeEventListener('offline', handleOffline);\n    };\n  });\n  \n  const degradedReason = $derived(() =\u003e {\n    if (!isOnline) return { message: 'You\\'re offline', icon: 'üì¥' };\n    if (!connectionStatus.daemonReachable) return { message: 'Daemon offline', icon: '‚ö†Ô∏è' };\n    if (!capabilities.supportsEventsFile) return { message: 'Live updates unavailable', icon: 'üì°' };\n    return null;\n  });\n\u003c/script\u003e\n\n{#if degradedReason}\n  \u003cdiv class=\"degraded-banner\" role=\"alert\" aria-live=\"polite\"\u003e\n    \u003cspan class=\"icon\"\u003e{degradedReason.icon}\u003c/span\u003e\n    \u003cspan class=\"message\"\u003e{degradedReason.message} - showing cached data\u003c/span\u003e\n    \u003cbutton class=\"retry\" onclick={() =\u003e location.reload()}\u003eRetry\u003c/button\u003e\n  \u003c/div\u003e\n{/if}\n```\n\n## Styling\n- Yellow/amber background (warning color)\n- Sticky at top of viewport\n- Does not push content (overlays)\n- Dismissable (but reappears if still degraded)\n\n## Acceptance Criteria\n- [ ] Shows when daemon unreachable\n- [ ] Shows when offline\n- [ ] Shows when watchers fail\n- [ ] Clear message explaining state\n- [ ] Retry button reloads page\n- [ ] Accessible (role=alert)\n- [ ] Non-intrusive positioning\n- [ ] Auto-hides when condition resolves\n\n## Files\n- src/lib/components/DegradedModeBanner.svelte\n\n## References\n- INTEGRATION_PLAN: Degraded Mode Banner section","status":"open","priority":1,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-13T00:32:57.41195+05:30","created_by":"Avyukth","updated_at":"2026-01-13T00:32:57.41195+05:30","labels":["layer:ui","phase:1"]}
{"id":"gu-8dh","title":"Digest: mol-refinery-patrol","description":"Patrol: queue empty, 0 branches merged","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-12T20:53:45.047406+05:30","updated_at":"2026-01-12T20:53:45.047406+05:30","closed_at":"2026-01-12T20:53:45.047349+05:30","close_reason":"Squashed from 11 wisps"}
{"id":"gu-8kv","title":"Create test ID conventions and selectors","description":"# Test ID Conventions and Selectors\n\n## Background\nConsistent test selectors enable reliable testing and future Playwright integration.\n\n## Test ID Conventions\n```typescript\n// src/lib/test/selectors.ts\n\nexport const SELECTORS = {\n  // Navigation\n  NAV_RIGS: '[data-testid=\"nav-rigs\"]',\n  NAV_WORK: '[data-testid=\"nav-work\"]',\n  NAV_MAIL: '[data-testid=\"nav-mail\"]',\n  NAV_DASHBOARD: '[data-testid=\"nav-dashboard\"]',\n\n  // Rig Management\n  ADD_RIG_BTN: '[data-testid=\"add-rig-btn\"]',\n  RIG_NAME_INPUT: '[data-testid=\"rig-name-input\"]',\n  RIG_URL_INPUT: '[data-testid=\"rig-url-input\"]',\n  RIG_SUBMIT_BTN: '[data-testid=\"rig-submit-btn\"]',\n  RIG_LIST: '[data-testid=\"rig-list\"]',\n  RIG_ITEM: '[data-testid=\"rig-item\"]',\n\n  // Work Items\n  NEW_WORK_BTN: '[data-testid=\"new-work-btn\"]',\n  WORK_TITLE_INPUT: '[data-testid=\"work-title-input\"]',\n  WORK_PRIORITY_SELECT: '[data-testid=\"work-priority-select\"]',\n  WORK_LABELS_INPUT: '[data-testid=\"work-labels-input\"]',\n  WORK_SUBMIT_BTN: '[data-testid=\"work-submit-btn\"]',\n  WORK_LIST: '[data-testid=\"work-list\"]',\n  WORK_ITEM: '[data-testid=\"work-item\"]',\n\n  // Sling\n  SLING_BTN: '[data-testid=\"sling-btn\"]',\n  SLING_TARGET_SELECT: '[data-testid=\"sling-target-select\"]',\n  SLING_CONFIRM_BTN: '[data-testid=\"sling-confirm-btn\"]',\n\n  // Toast\n  TOAST: '[data-testid=\"toast\"]',\n  TOAST_MESSAGE: '[data-testid=\"toast-message\"]',\n  TOAST_ACTION: '[data-testid=\"toast-action\"]',\n\n  // Dynamic selectors\n  BEAD_ID: (id: string) =\u003e \\`[data-bead-id=\"\\${id}\"]\\`,\n  RIG_NAME: (name: string) =\u003e \\`[data-rig-name=\"\\${name}\"]\\`,\n  AGENT_NAME: (name: string) =\u003e \\`[data-agent-name=\"\\${name}\"]\\`,\n} as const;\n```\n\n## Component Updates\nAdd data-testid attributes to all interactive elements.\n\n## Acceptance Criteria\n- [ ] Selectors for all testable elements\n- [ ] Consistent naming convention\n- [ ] Dynamic selector helpers\n- [ ] All components updated with data-testid\n- [ ] Documented usage\n\n## Files\n- src/lib/test/selectors.ts\n- All component files (add data-testid)\n\n## References\n- INTEGRATION_PLAN: Test ID Conventions section\n\n(Moved from hq-nbf.7)","status":"closed","priority":1,"issue_type":"task","estimated_minutes":90,"created_at":"2026-01-12T23:12:55.102287+05:30","created_by":"Avyukth","updated_at":"2026-01-13T01:20:50.391697+05:30","closed_at":"2026-01-13T01:20:50.391697+05:30","close_reason":"Duplicate of gu-z6je (Test ID Selectors)","labels":["layer:testing","phase:1"]}
{"id":"gu-8rcy","title":"Implement Global Search (Cmd+/)","description":"# Global Search Implementation\n\n## Background\nGlobal Search (Cmd+/) searches across all data types: work items, convoys,\nmail, rigs. Different from Command Palette which is for actions.\n\n## UI Behavior\n- Trigger: Cmd+/ (Mac) / Ctrl+/ (Windows/Linux)\n- Search input with type filter dropdown\n- Results grouped by type\n- Click result to navigate\n\n## Search Types\n- Work items: title, description, ID\n- Convoys: title, item titles\n- Mail: subject, body, from/to\n- Rigs: name\n\n## Component Structure\n```svelte\n\u003c!-- src/lib/components/GlobalSearch.svelte --\u003e\n\n\u003cscript lang=\"ts\"\u003e\n  let open = $state(false);\n  let query = $state('');\n  let typeFilter = $state\u003c'all' | 'work' | 'convoy' | 'mail' | 'rig'\u003e('all');\n  \n  const results = $derived.by(async () =\u003e {\n    if (query.length \u003c 2) return [];\n    const response = await fetch(`/api/gastown/search?q=${query}\u0026type=${typeFilter}`);\n    return response.json();\n  });\n\u003c/script\u003e\n```\n\n## Acceptance Criteria\n- [ ] Opens with Cmd+/ / Ctrl+/\n- [ ] Search input with type filter\n- [ ] Results grouped by type\n- [ ] Keyboard navigation works\n- [ ] Debounced search requests\n- [ ] Loading state shown\n\n## Files\n- src/lib/components/GlobalSearch.svelte\n- src/routes/api/gastown/search/+server.ts\n\n## References\n- INTEGRATION_PLAN D0.8: Power-User Ergonomics\n\n(Moved from hq-wbe.3)","status":"closed","priority":2,"issue_type":"task","estimated_minutes":120,"created_at":"2026-01-12T23:13:26.977734+05:30","created_by":"Avyukth","updated_at":"2026-01-13T01:12:39.559495+05:30","closed_at":"2026-01-13T01:12:39.559495+05:30","close_reason":"Duplicate of gu-ayx (Global Search)","labels":["layer:ui","phase:1"]}
{"id":"gu-963","title":"Implement /api/gastown/convoys/[id] detail endpoint","description":"# Convoy Detail Endpoint\n\n## Background\nRetrieve individual convoy details including tracked issues.\n\n## Endpoint\n```\nGET /api/gastown/convoys/{id}\n```\n\n## Implementation\n- Call `gt convoy show {id} --json` via Process Supervisor\n- Return GtConvoySchema response with full tracked_issues\n- Handle not found (404)\n\n## Response includes\n- Convoy metadata (title, status, progress)\n- Full tracked_issues array with status/assignee\n- Dependency information\n\n## Acceptance Criteria\n- [ ] Returns convoy by ID\n- [ ] Includes full tracked_issues list\n- [ ] Returns 404 for unknown ID\n- [ ] Uses Process Supervisor (no exec)\n- [ ] Validates response against GtConvoySchema\n\n## Files\n- src/routes/api/gastown/convoys/[id]/+server.ts\n\n## References\n- INTEGRATION_PLAN ¬ßServer Routes (convoys)","status":"open","priority":1,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-12T23:36:32.976432+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:36:32.976432+05:30","labels":["layer:api","phase:1"]}
{"id":"gu-9mtr","title":"Unit tests: Operations Store","description":"# Unit Tests: Operations Store\n\n## CRITICAL: Detailed Logging Requirements\nAll unit tests MUST provide comprehensive logging:\n\n```typescript\nimport { createTestLogger } from \"../lib/logger\";\nconst logger = createTestLogger(\"Unit: Operations Store\");\n```\n\n## Test Cases\n\n### Operation Lifecycle\n```typescript\ndescribe(\"Operations Store\", () =\u003e {\n  it(\"tracks operation start\", () =\u003e {\n    logger.step(\"Testing operation start tracking\");\n    \n    const opId = operations.start(\"Add Rig\", { name: \"test-rig\" });\n    logger.info(\"Started operation\", { opId });\n    \n    const op = operations.get(opId);\n    logger.info(\"Operation state\", op);\n    \n    expect(op.status).toBe(\"pending\");\n    logger.success(\"Operation start tracked\");\n  });\n\n  it(\"updates operation progress\", () =\u003e {\n    logger.step(\"Testing progress updates\");\n    \n    const opId = operations.start(\"Add Rig\", {});\n    operations.progress(opId, \"Validating...\");\n    \n    const op = operations.get(opId);\n    logger.info(\"Progress state\", { message: op.message });\n    \n    expect(op.message).toBe(\"Validating...\");\n    logger.success(\"Progress updated correctly\");\n  });\n});\n```\n\n### Test Checklist\n- [ ] Tracks operation start\n- [ ] Updates operation progress\n- [ ] Records operation success with result\n- [ ] Records operation failure with error\n- [ ] Prunes old operations (max 50)\n\n## Files\n- src/lib/stores/__tests__/operations.test.ts\n\n## Dependencies\n- gu-335i (shared test logging utilities)","status":"open","priority":1,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-12T23:49:53.588298+05:30","created_by":"Avyukth","updated_at":"2026-01-13T01:36:27.598195+05:30","labels":["layer:testing","phase:1","type:unit"]}
{"id":"gu-9n9","title":"Unit tests: Capabilities Probe","description":"# Unit Tests: Capabilities Probe\n\n## CRITICAL: Detailed Logging Requirements\nAll unit tests MUST provide comprehensive logging:\n\n```typescript\nimport { createTestLogger } from \"../lib/logger\";\nconst logger = createTestLogger(\"Unit: Capabilities Probe\");\n```\n\n## Test Cases\n\n### Version Detection\n```typescript\ndescribe(\"Capabilities Probe\", () =\u003e {\n  it(\"detects gt CLI version\", async () =\u003e {\n    logger.step(\"Testing gt version detection\");\n    logger.info(\"Running: gt --version\");\n    \n    const caps = await probe.detect();\n    \n    logger.info(\"Detected capabilities\", caps);\n    expect(caps.gt.version).toMatch(/\\d+\\.\\d+\\.\\d+/);\n    logger.success(`Detected gt version: ${caps.gt.version}`);\n  });\n\n  it(\"detects bd CLI version\", async () =\u003e {\n    logger.step(\"Testing bd version detection\");\n    const caps = await probe.detect();\n    logger.info(\"bd capabilities\", caps.bd);\n    expect(caps.bd.version).toBeTruthy();\n    logger.success(`Detected bd version: ${caps.bd.version}`);\n  });\n});\n```\n\n### Test Checklist\n- [ ] Detects gt CLI version\n- [ ] Detects bd CLI version\n- [ ] Returns degraded mode if CLI unavailable\n- [ ] Caches detection results\n- [ ] Refreshes cache on demand\n\n## Files\n- src/lib/stores/__tests__/capabilities.test.ts\n\n## Dependencies\n- gu-335i (shared test logging utilities)","status":"open","priority":1,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-12T23:47:10.366388+05:30","created_by":"Avyukth","updated_at":"2026-01-13T01:36:07.414228+05:30","labels":["layer:testing","phase:1","type:unit"]}
{"id":"gu-9t4","title":"Implement Process Supervisor with spawn/execFile","description":"# Process Supervisor Implementation\n\n## Background\nThe Process Supervisor is the core of safe CLI execution. It uses Node's spawn/execFile\ninstead of shell execution, preventing command injection and providing fine-grained\nprocess control.\n\n## Why spawn/execFile instead of exec?\n- exec() uses shell by default ‚Üí command injection risk\n- execFile() passes args as array ‚Üí safe, no injection\n- spawn() provides streaming stdout/stderr ‚Üí real-time logs\n- Both allow process.kill() for cancellation\n\n## Implementation Requirements\n\n### Core API\n```typescript\ninterface ProcessSupervisor {\n  run(command: string, args: string[], options: RunOptions): Promise\u003cRunResult\u003e;\n  cancel(requestId: string): void;\n}\n\ninterface RunOptions {\n  timeout?: number;         // Default 30s\n  cwd?: string;            // Working directory\n  env?: Record\u003cstring,string\u003e;\n  requestId?: string;      // For cancellation\n  onStdout?: (line: string) =\u003e void;\n  onStderr?: (line: string) =\u003e void;\n}\n\ninterface RunResult {\n  stdout: string;\n  stderr: string;\n  exitCode: number;\n  duration: number;\n  requestId: string;\n}\n```\n\n### Error Handling\n- Timeout ‚Üí throw TimeoutError with partial output\n- Non-zero exit ‚Üí throw CliError with stderr\n- Spawn failure ‚Üí throw SpawnError with system details\n\n### Observability\n- Log every command with requestId (redact secrets)\n- Track duration for each execution\n- Emit events for start/complete/fail\n\n## Acceptance Criteria\n- [ ] Uses execFile, not exec\n- [ ] Timeout enforced with process.kill()\n- [ ] Cancellation works via requestId\n- [ ] Errors are typed (TimeoutError, CliError, SpawnError)\n- [ ] All executions logged with correlation ID\n- [ ] Unit tests cover: success, timeout, cancellation, errors\n\n## Files\n- src/lib/server/cli/process-supervisor.ts\n- src/lib/server/cli/errors.ts\n- src/lib/server/cli/__tests__/process-supervisor.test.ts\n\n## References\n- INTEGRATION_PLAN D0.5: Process Supervisor Pattern\n- Node docs: child_process.execFile, child_process.spawn\n\n(Moved from hq-0qb.1)","status":"open","priority":1,"issue_type":"task","estimated_minutes":120,"created_at":"2026-01-12T23:13:25.240756+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:13:25.240756+05:30","labels":["layer:foundation","phase:1","priority:critical"]}
{"id":"gu-9wo","title":"Implement /api/gastown/mail/[id] detail endpoint","description":"# Mail Detail Endpoint\n\n## Background\nRetrieve individual mail message details by ID.\n\n## Endpoint\n```\nGET /api/gastown/mail/{id}\n```\n\n## Implementation\n- Call `bd show {id} --json` via Process Supervisor\n- Validate bead is type=message\n- Return structured GtMailMessageSchema response\n- Handle not found (404)\n\n## Response\nUse GtMailMessageSchema from gastown.schema.ts\n\n## Acceptance Criteria\n- [ ] Returns mail message by ID\n- [ ] Validates message exists\n- [ ] Returns 404 for unknown ID\n- [ ] Uses Process Supervisor (no exec)\n- [ ] Validates response against Zod schema\n\n## Files\n- src/routes/api/gastown/mail/[id]/+server.ts\n\n## References\n- INTEGRATION_PLAN ¬ßServer Routes (mail)","status":"open","priority":1,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-12T23:34:24.305773+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:34:24.305773+05:30","labels":["layer:api","phase:1"]}
{"id":"gu-abz","title":"Implement Copy CLI Feature for all actions","description":"# Copy CLI Feature\n\n## Background (from INTEGRATION_PLAN v4.0 Innovation #7)\nUsers should be able to copy the CLI equivalent of any UI action.\nThis helps users learn the CLI through the UI.\n\n## Implementation\n```svelte\n\u003c!-- src/lib/components/CopyCli.svelte --\u003e\n\u003cscript lang=\"ts\"\u003e\n  import { toast } from '$lib/stores/toast';\n  \n  export let command: string;\n  export let label: string = 'Copy CLI';\n  \n  async function copyToClipboard() {\n    await navigator.clipboard.writeText(command);\n    toast.success('CLI command copied to clipboard');\n  }\n\u003c/script\u003e\n\n\u003cbutton \n  onclick={copyToClipboard}\n  class=\"copy-cli-btn\"\n  title={command}\n  data-testid=\"copy-cli\"\n\u003e\n  \u003cClipboardIcon /\u003e\n  \u003cspan\u003e{label}\u003c/span\u003e\n\u003c/button\u003e\n```\n\n## Usage Examples\n```svelte\n\u003c!-- In WorkItemCard.svelte --\u003e\n\u003cCopyCli command=\"bd show {item.id} --json\" /\u003e\n\n\u003c!-- In SlingDialog.svelte --\u003e\n\u003cCopyCli command=\"gt sling {beadId} {target}\" /\u003e\n\n\u003c!-- In RigCard.svelte --\u003e\n\u003cCopyCli command=\"gt rig show {rig.name}\" /\u003e\n```\n\n## Acceptance Criteria\n- [ ] CopyCli component created\n- [ ] Added to all action cards/dialogs\n- [ ] Shows tooltip with full command\n- [ ] Toast confirmation on copy\n- [ ] Keyboard accessible\n\n## Files\n- src/lib/components/CopyCli.svelte\n- (Integration in various components)\n\n## References\n- INTEGRATION_PLAN: \"Copy CLI equivalent\" requirement\n\n(Moved from hq-wbe.13)","status":"open","priority":2,"issue_type":"task","estimated_minutes":60,"created_at":"2026-01-12T23:13:26.05841+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:13:26.05841+05:30","labels":["layer:ui","phase:1"]}
{"id":"gu-ael","title":"Implement Activity Feed component","description":"# Activity Feed Component\n\n## Background\nReal-time activity timeline showing agent actions, merges, mail, convoy updates.\nConnects to SSE stream endpoint.\n\n## UI Layout\n```\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ  Activity  ‚óè Live                        ‚îÇ\n‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n‚îÇ  ü§ñ 10:45 - nux completed task hq-123   ‚îÇ\n‚îÇ  üîÄ 10:42 - witness merged PR #45       ‚îÇ\n‚îÇ  üìß 10:40 - mail: dag ‚Üí refinery        ‚îÇ\n‚îÇ  üöõ 10:38 - convoy-xyz: issue closed    ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n```\n\n## Event Types \u0026 Icons\n- agent_status: ü§ñ\n- merge: üîÄ  \n- mail: üìß\n- convoy: üöõ\n- error: ‚ùå\n- system: ‚öôÔ∏è\n\n## Implementation\n- Connect to /api/gastown/feed/stream SSE\n- Show last 50 events\n- Auto-scroll on new events (unless user scrolled up)\n- Reconnect with exponential backoff\n- Connection status indicator\n\n## Acceptance Criteria\n- [ ] Connects to SSE stream\n- [ ] Shows live events in real-time\n- [ ] Connection status visible\n- [ ] Auto-reconnects on disconnect\n- [ ] Events formatted with icons and timestamps\n- [ ] No events state handled gracefully\n\n## Files\n- src/lib/components/ActivityFeed.svelte\n\n## References\n- INTEGRATION_PLAN ¬ßReal-Time Activity Stream\n- CUJ-4: System Monitoring","status":"open","priority":1,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-12T23:40:23.304143+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:40:23.304143+05:30","labels":["layer:ui","phase:1"]}
{"id":"gu-ai5","title":"Implement Toast notification system","description":"# Enhance Toast notification system\n\n## EXISTING IMPLEMENTATION\nToast system EXISTS at:\n- `src/lib/components/Toast.svelte` ‚úÖ\n- `src/lib/components/ToastContainer.svelte` ‚úÖ\n- `src/lib/stores/toast.svelte.ts` ‚úÖ\n- `src/lib/components/Toast.test.ts` ‚úÖ\n\n### Current State (PARTIAL)\n- ‚úÖ Toast types: default, info, success, warning, error\n- ‚úÖ Auto-dismiss with configurable duration\n- ‚úÖ Queue management (max 3)\n- ‚úÖ Svelte 5 runes ($state, $derived)\n- ‚úÖ Exit animations\n- ‚úÖ ARIA attributes (role=\"alert\", aria-live)\n- ‚ùå Missing 'progress' type for two-phase feedback\n- ‚ùå Missing data-testid attributes\n- ‚ùå Missing async() convenience method\n- ‚ùå Missing action button support\n- ‚ùå Missing ID extraction helpers\n\n## REQUIRED ENHANCEMENTS\n\n### 1. Add 'progress' type\n```typescript\n// toast.svelte.ts - add type\nexport type ToastType = 'default' | 'info' | 'success' | 'warning' | 'error' | 'progress';\n```\n\n### 2. Add async() convenience method (Two-Phase Pattern)\n```typescript\n/**\n * Execute async operation with two-phase toast feedback\n * Phase 1: \"Adding rig...\" (progress)\n * Phase 2: \"Rig added: my-rig\" (success) or error\n */\nasync\u003cT\u003e(\n  promise: Promise\u003cT\u003e,\n  options: {\n    pending: string;\n    success: (result: T) =\u003e string;\n    error?: (error: Error) =\u003e string;\n  }\n): Promise\u003cT\u003e {\n  const toastId = this.show(options.pending, { type: 'progress', duration: 0 });\n  try {\n    const result = await promise;\n    this.dismiss(toastId);\n    this.success(options.success(result));\n    return result;\n  } catch (error) {\n    this.dismiss(toastId);\n    this.error(options.error?.(error) ?? error.message);\n    throw error;\n  }\n}\n```\n\n### 3. Add data-testid attributes (Toast.svelte)\n```svelte\n\u003cdiv\n  data-testid=\"toast\"\n  data-toast-id={id}\n  data-toast-type={type}\n  ...\n\u003e\n  \u003cspan data-testid=\"toast-message\"\u003e{message}\u003c/span\u003e\n  {#if action}\n    \u003cbutton data-testid=\"toast-action\"\u003e{action.label}\u003c/button\u003e\n  {/if}\n\u003c/div\u003e\n```\n\n### 4. Add action button support\n```typescript\ninterface Toast {\n  // ... existing\n  action?: {\n    label: string;\n    onClick: () =\u003e void;\n  };\n}\n```\n\n### 5. Add ID extraction helpers\n```typescript\n// src/lib/utils/toast-helpers.ts\nexport function extractBeadId(message: string): string | null {\n  const match = message.match(/([a-z]+-[a-z0-9]+)/);\n  return match?.[1] ?? null;\n}\n\nexport function extractRigName(message: string): string | null {\n  const match = message.match(/Rig (?:added|created): ([\\w-]+)/);\n  return match?.[1] ?? null;\n}\n```\n\n## Acceptance Criteria\n- [ ] 'progress' toast type with spinner icon\n- [ ] async() method for two-phase operations\n- [ ] data-testid on all elements\n- [ ] Action button support\n- [ ] ID extraction helpers\n- [ ] Update Toast.test.ts with new features\n\n## Files to Modify\n- src/lib/stores/toast.svelte.ts (add progress type, async method)\n- src/lib/components/Toast.svelte (add data-testid, action button)\n- src/lib/utils/toast-helpers.ts (NEW - ID extraction)\n- src/lib/components/Toast.test.ts (update tests)\n\n## Dependencies\nNone - can be done independently","status":"open","priority":1,"issue_type":"task","estimated_minutes":90,"created_at":"2026-01-12T23:12:56.93756+05:30","created_by":"Avyukth","updated_at":"2026-01-13T01:17:13.848412+05:30","labels":["layer:ui","phase:1"]}
{"id":"gu-amx","title":"Implement Input Validation Schemas with Zod","description":"# Input Validation Schemas\n\n## Background\nValidate inputs strictly with Zod. Do NOT use character-stripping sanitization\nwhich causes \"sanitization deletes characters\" bugs.\n\n## Schemas to Create\n```typescript\n// src/lib/server/cli/validation.ts\n\nimport { z } from 'zod';\n\n// Strict validation for CLI arguments\nexport const BeadIdSchema = z.string()\n  .regex(/^[a-zA-Z0-9_-]{1,64}$/, 'Invalid bead ID');\n\nexport const AgentNameSchema = z.string()\n  .regex(/^[a-zA-Z][a-zA-Z0-9_-]{0,31}$/, 'Invalid agent name');\n\nexport const RigNameSchema = z.string()\n  .regex(/^[a-zA-Z][a-zA-Z0-9_-]{0,63}$/, 'Invalid rig name')\n  .min(1).max(100);\n\nexport const CreateWorkItemSchema = z.object({\n  title: z.string().min(1).max(200),\n  description: z.string().max(5000).optional(),\n  priority: z.number().int().min(0).max(4),\n  labels: z.array(z.string().max(50)).max(10).optional(),\n  type: z.enum(['task', 'bug', 'feature', 'epic', 'chore']).default('task'),\n  assignee: AgentNameSchema.optional(),\n});\n\nexport const AddRigSchema = z.object({\n  name: RigNameSchema,\n  url: z.string()\n    .url()\n    .refine(url =\u003e url.startsWith('https://') || url.startsWith('git@'),\n      'URL must use HTTPS or SSH'),\n});\n\nexport const SlingSchema = z.object({\n  beadId: BeadIdSchema,\n  target: z.string()\n    .regex(/^[a-z0-9-]+\\/[a-z0-9-]+$/, 'Target must be rig/agent format'),\n});\n\nexport const MailFilterSchema = z.object({\n  status: z.enum(['open', 'closed', 'all']).optional(),\n  priority: z.enum(['low', 'normal', 'high', 'urgent']).optional(),\n  type: z.enum(['task', 'scavenge', 'notification', 'reply']).optional(),\n  limit: z.number().int().min(1).max(100).default(50),\n});\n```\n\n## Acceptance Criteria\n- [ ] All schemas strictly validate (no character stripping)\n- [ ] Error messages are user-friendly\n- [ ] All POST endpoints use these schemas\n- [ ] Unit tests with valid and invalid inputs\n- [ ] Schemas exported for client-side use\n\n## Files\n- src/lib/server/cli/validation.ts\n- src/lib/server/cli/__tests__/validation.test.ts\n\n## References\n- INTEGRATION_PLAN: Input Validation section\n\n(Moved from hq-m9x.2)","status":"open","priority":1,"issue_type":"task","estimated_minutes":90,"created_at":"2026-01-12T23:12:55.70869+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:12:55.70869+05:30","labels":["layer:security","phase:1"]}
{"id":"gu-ayx","title":"Implement Global Search component","description":"# Enhance Global Search component\n\n## EXISTING IMPLEMENTATION ‚úÖ\nGlobalSearch EXISTS at `src/lib/components/global-search/` with:\n- GlobalSearch.svelte\n- data.ts\n- types.ts\n- index.ts\n\n### Current State (MOSTLY COMPLETE)\n- ‚úÖ Command palette mode (\u003e prefix)\n- ‚úÖ Filter options (agents, issues, convoys)\n- ‚úÖ Keyboard navigation\n- ‚úÖ Recent searches (localStorage)\n- ‚úÖ Mock data structure ready\n- ‚úÖ OS-aware shortcuts (Cmd/Ctrl+/)\n- ‚ùå Missing real API integration\n- ‚ùå Missing data-testid attributes\n- ‚ùå Missing Vim-style shortcuts (j/k navigation)\n\n## REQUIRED ENHANCEMENTS\n\n### 1. Add data-testid attributes\n```svelte\n\u003cbutton data-testid=\"global-search-trigger\" ...\u003e\n\u003cinput data-testid=\"global-search-input\" ...\u003e\n\u003cul data-testid=\"global-search-results\" ...\u003e\n\u003cli data-testid=\"global-search-result-item\" ...\u003e\n```\n\n### 2. Real API integration\nReplace mock data with real API calls:\n```typescript\nasync function fetchResults(query: string, type: FilterType) {\n  const endpoints = {\n    agents: '/api/gastown/agents',\n    issues: '/api/gastown/work/issues',\n    convoys: '/api/gastown/convoys',\n    all: '/api/gastown/snapshot'\n  };\n  // ... implementation\n}\n```\n\n### 3. Debounced search\n```typescript\nimport { debounce } from '$lib/utils';\nconst debouncedSearch = debounce(fetchResults, 300);\n```\n\n## Acceptance Criteria\n- [ ] Real API integration (when endpoints ready)\n- [ ] data-testid on all interactive elements\n- [ ] Search debounce (300ms)\n- [ ] Loading state during search\n- [ ] Error handling with toast\n\n## Files to Modify\n- src/lib/components/global-search/GlobalSearch.svelte\n\n## Status\n**LOW PRIORITY** - Component is functional, API integration can wait","status":"open","priority":1,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-12T23:40:23.030954+05:30","created_by":"Avyukth","updated_at":"2026-01-13T01:18:18.019518+05:30","labels":["layer:ui","phase:1"]}
{"id":"gu-bgx","title":"Implement /api/gastown/agents/[id] detail endpoint","description":"# Agent Detail Endpoint\n\n## CLI Command\n```bash\ngt peek \u003cagent-id\u003e\n```\n\n## Response Schema\n```typescript\ninterface GtAgentDetail extends GtAgent {\n  currentTask?: string;\n  currentMolecule?: string;\n  recentActivity: GtFeedItem[];\n  metrics: {\n    tasksCompleted: number;\n    avgTaskDuration: number;\n    lastError?: string;\n  };\n}\n```\n\n## Acceptance Criteria\n- [ ] Returns detailed agent info\n- [ ] Includes recent activity\n- [ ] 30s timeout (gt peek can be slow)\n- [ ] 5s cache TTL\n- [ ] Unit test with mocked CLI\n\n## Files\n- src/routes/api/gastown/agents/[id]/+server.ts\n\n(Moved from hq-0er.12)","status":"closed","priority":2,"issue_type":"task","estimated_minutes":45,"created_at":"2026-01-12T23:13:25.95442+05:30","created_by":"Avyukth","updated_at":"2026-01-13T01:12:31.260304+05:30","closed_at":"2026-01-13T01:12:31.260304+05:30","close_reason":"Duplicate of gu-0tj (agents detail endpoint)","labels":["layer:api","phase:1"]}
{"id":"gu-bqu","title":"[P1] UI Layer: Components \u0026 Operation Center","description":"# Phase 1 UI Layer\n\n## Background\nThe UI layer provides the visual interface for monitoring and controlling Gas Town.\nAll components must work across mobile, tablet, and desktop (per AGENTS.md platform taxonomy).\n\n## Key Innovations (from INTEGRATION_PLAN v5.0)\n1. **Operation Center (D0.10)**: Bottom-right FAB showing running operations\n2. **Power-User Ergonomics (D0.8)**: Command Palette, Global Search, Copy CLI\n3. **Accessibility**: WCAG 2.2 AA compliance, keyboard navigation\n\n## Components to Build\n\n### Core Views\n- Dashboard: System overview with agent status\n- Convoys: Convoy list with filtering\n- Work Items: Task/issue browser with search\n- Mail: Message inbox/outbox\n- Rigs: Rig management view\n- Queue: Merge queue visualization\n\n### UI Primitives\n- Operation Center FAB (running operations indicator)\n- Toast notifications (success, error, info)\n- Command Palette (Cmd+K)\n- Global Search (Cmd+/)\n- Error boundaries with recovery\n- Loading skeletons (no spinners!)\n\n## Why This Matters\n- Operation Center provides at-a-glance operation status\n- Command Palette enables power users to navigate faster\n- Skeletons prevent layout shift (better Core Web Vitals)\n- Error boundaries prevent cascading UI failures\n\n## Acceptance Criteria\n- [ ] All views render on mobile, tablet, desktop (AGENTS.md platforms)\n- [ ] Operation Center shows running/completed operations\n- [ ] Command Palette accessible via Cmd+K\n- [ ] Tab navigation works through all interactive elements\n- [ ] Loading states use skeletons, not spinners\n- [ ] Error boundaries catch and display errors gracefully\n- [ ] Reduced motion respected for animations\n\n## Architecture Decision References\n- D0.8: Power-User Ergonomics\n- D0.10: Observable Operations (Operation Center)\n- D3.2: UI Component Strategy\n\n## Dependencies\n- EPIC: Data Layer (hq-bpb)\n- EPIC: API Routes (hq-0er)\n\n## Files to Create/Modify\n- src/lib/components/OperationCenter.svelte\n- src/lib/components/CommandPalette.svelte\n- src/lib/components/GlobalSearch.svelte\n- src/lib/components/Toast.svelte\n- src/lib/components/ErrorBoundary.svelte\n- src/routes/dashboard/+page.svelte\n- src/routes/convoys/+page.svelte\n- src/routes/work/+page.svelte\n- src/routes/mail/+page.svelte\n- src/routes/rigs/+page.svelte\n- src/routes/queue/+page.svelte\n\n(Moved from hq-wbe)","status":"open","priority":1,"issue_type":"epic","created_at":"2026-01-12T23:11:32.263641+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:11:32.263641+05:30","labels":["critical:yes","layer:ui","phase:1"]}
{"id":"gu-bwp","title":"Implement /api/gastown/diagnostics endpoint","description":"# Diagnostics Endpoint Implementation\n\n## Background\nReturns health check results from gt doctor. Includes checks for workspace\nvalidity, git status, daemon connectivity, etc.\n\n## CLI Command\n```bash\ngt doctor --json\n```\n\n## Expected Response\n```json\n{\n  \"checks\": [\n    {\n      \"name\": \"workspace_valid\",\n      \"status\": \"pass\",\n      \"message\": \"Workspace is valid\"\n    },\n    {\n      \"name\": \"git_status\",\n      \"status\": \"warn\",\n      \"message\": \"Uncommitted changes detected\"\n    },\n    {\n      \"name\": \"daemon_connectivity\",\n      \"status\": \"fail\",\n      \"message\": \"Cannot connect to daemon\"\n    }\n  ],\n  \"overall_status\": \"warn\",\n  \"timestamp\": \"2026-01-12T10:00:00Z\"\n}\n```\n\n## Long-Running Note\ngt doctor can take 10-30 seconds depending on checks. Use longer timeout\nand consider running in background with progress updates.\n\n## Acceptance Criteria\n- [ ] Returns health check results JSON\n- [ ] Longer timeout (30s) for slow checks\n- [ ] Overall status derived from individual checks\n- [ ] Uses SWR cache with 60s stale time\n- [ ] Unit test with mocked CLI\n\n## Files\n- src/routes/api/gastown/diagnostics/+server.ts\n- src/routes/api/gastown/diagnostics/__tests__/server.test.ts\n\n## References\n- INTEGRATION_PLAN: Diagnostics Endpoint section\n- CLI: gt doctor --json\n\n(Moved from hq-0er.8)","status":"open","priority":1,"issue_type":"task","estimated_minutes":60,"created_at":"2026-01-12T23:12:57.43927+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:12:57.43927+05:30","labels":["layer:api","phase:1"]}
{"id":"gu-bz5x","title":"Unit tests: Toast system and ID extraction helpers","description":"# Unit Tests: Toast System\n\n## CRITICAL: Detailed Logging Requirements\nAll unit tests MUST provide comprehensive logging for debugging using shared utilities:\n\n```typescript\nimport { createTestLogger } from \"../lib/logger\";\nconst logger = createTestLogger(\"Unit: Toast System\");\n```\n\n## Test Cases\n\n### Toast Store\n```typescript\ndescribe(\"Toast Store\", () =\u003e {\n  beforeEach(() =\u003e {\n    logger.step(\"Setting up toast store test\");\n    toastStore.clear();\n  });\n\n  it(\"creates toast with unique ID\", () =\u003e {\n    logger.info(\"Testing unique ID generation\");\n    const id1 = toast.info(\"First\");\n    const id2 = toast.info(\"Second\");\n    logger.info(\"Generated IDs\", { id1, id2 });\n    expect(id1).not.toBe(id2);\n    logger.success(\"IDs are unique\");\n  });\n\n  it(\"queues toasts (max 3 visible)\", () =\u003e {\n    logger.info(\"Testing toast queue limit\");\n    for (let i = 0; i \u003c 5; i++) {\n      toast.info(`Toast ${i}`);\n    }\n    const visible = toastStore.getVisible();\n    logger.info(\"Visible toasts\", { count: visible.length });\n    expect(visible.length).toBe(3);\n    logger.success(\"Queue limit enforced\");\n  });\n});\n```\n\n### Test Checklist\n- [ ] Creates toast with unique ID\n- [ ] Queues toasts (max 3 visible)\n- [ ] Auto-dismisses after duration\n- [ ] Manual dismiss works\n- [ ] Progress toast persists until dismissed\n\n### Two-Phase Pattern\n- [ ] toast.async() shows progress phase\n- [ ] toast.async() shows success phase\n- [ ] toast.async() shows error on failure\n- [ ] Progress toast dismissed before success\n\n### ID Extraction Helpers\n- [ ] extractBeadId extracts gu-xxx format\n- [ ] extractBeadId extracts hq-xxx format\n- [ ] extractBeadId returns null for no match\n- [ ] extractRigName extracts rig name from message\n- [ ] extractAgentName extracts agent name\n\n## Files\n- src/lib/stores/__tests__/toast.test.ts\n- src/lib/stores/__tests__/toast-helpers.test.ts\n\n## Dependencies\n- gu-335i (shared test logging utilities)","status":"open","priority":1,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-13T00:36:08.183313+05:30","created_by":"Avyukth","updated_at":"2026-01-13T01:35:44.95559+05:30","labels":["layer:testing","phase:1","type:unit"]}
{"id":"gu-cn7","title":"Implement Operations Store for Operation Center","description":"# Operations Store Implementation\n\n## Background\nThe Operations Store tracks all long-running operations (rig add, doctor, etc.)\nand provides data for the Operation Center UI component.\n\n## Why This Matters\n- Users need visibility into running operations\n- Cancel functionality requires tracking\n- Retry functionality needs operation history\n- \"Copy debug bundle\" needs operation details\n\n## Implementation Requirements\n\n### Store Structure\n```typescript\n// src/lib/stores/operations.svelte.ts\n\nexport interface Operation {\n  id: string;\n  type: 'rig_add' | 'formula_run' | 'work_create' | 'sling' | 'doctor';\n  status: 'pending' | 'running' | 'completed' | 'failed' | 'cancelled';\n  startedAt: number;\n  completedAt?: number;\n  progress?: number;         // 0-100 percentage\n  logs: string[];            // Streaming logs\n  result?: unknown;          // Success result\n  error?: string;            // Failure message\n  requestId: string;         // For correlation\n}\n\nclass OperationsStore {\n  operations = $state\u003cOperation[]\u003e([]);\n  \n  // Derived\n  running = $derived(this.operations.filter(o =\u003e o.status === 'running'));\n  hasRunning = $derived(this.running.length \u003e 0);\n  recent = $derived(this.operations.slice(0, 10));\n  \n  add(type: Operation['type']): string {\n    const id = crypto.randomUUID();\n    const operation: Operation = {\n      id,\n      type,\n      status: 'pending',\n      startedAt: Date.now(),\n      logs: [],\n      requestId: crypto.randomUUID()\n    };\n    this.operations = [operation, ...this.operations];\n    return id;\n  }\n  \n  updateStatus(id: string, status: Operation['status'], error?: string) {\n    this.operations = this.operations.map(op =\u003e\n      op.id === id\n        ? { ...op, status, error, completedAt: status !== 'running' ? Date.now() : undefined }\n        : op\n    );\n  }\n  \n  updateProgress(id: string, progress: number) {\n    this.operations = this.operations.map(op =\u003e\n      op.id === id ? { ...op, progress } : op\n    );\n  }\n  \n  appendLog(id: string, message: string) {\n    this.operations = this.operations.map(op =\u003e\n      op.id === id ? { ...op, logs: [...op.logs, message] } : op\n    );\n  }\n  \n  cancel(id: string) {\n    dispatchEvent(new CustomEvent('cancel-operation', { detail: { id } }));\n    this.updateStatus(id, 'cancelled');\n  }\n  \n  retry(id: string) {\n    const original = this.operations.find(op =\u003e op.id === id);\n    if (original) {\n      dispatchEvent(new CustomEvent('retry-operation', { detail: { operation: original } }));\n    }\n  }\n  \n  clearCompleted() {\n    this.operations = this.operations.filter(op =\u003e\n      op.status === 'running' || op.status === 'pending'\n    );\n  }\n}\n\nexport const operationsStore = new OperationsStore();\n```\n\n### Debug Bundle\n```typescript\nfunction getDebugBundle(operation: Operation): string {\n  return JSON.stringify({\n    operation,\n    timestamp: new Date().toISOString(),\n    userAgent: navigator.userAgent,\n    url: window.location.href\n  }, null, 2);\n}\n```\n\n## Acceptance Criteria\n- [ ] Tracks all long-running operations\n- [ ] Progress updates supported\n- [ ] Log streaming supported\n- [ ] Cancel and retry work\n- [ ] Clear completed operations\n- [ ] Debug bundle generation\n- [ ] Svelte 5 runes used\n\n## Files\n- src/lib/stores/operations.svelte.ts\n- src/lib/stores/__tests__/operations.test.ts\n\n## References\n- INTEGRATION_PLAN D0.10: Observable Operations\n- INTEGRATION_PLAN: Operations Store section\n\n(Moved from hq-bpb.4)","status":"open","priority":1,"issue_type":"task","estimated_minutes":90,"created_at":"2026-01-12T23:12:58.25949+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:12:58.25949+05:30","labels":["layer:data","phase:1","priority:critical"]}
{"id":"gu-cnc","title":"Implement Copy CLI Feature","description":"# Copy CLI Feature\n\nAdds ability to copy CLI commands to clipboard for manual execution.\n\n## Implementation\n\n### Component\n\n```svelte\n\u003c!-- src/lib/components/CopyCliButton.svelte --\u003e\n\u003cscript lang=\"ts\"\u003e\n  import { copy } from \"$lib/utils/clipboard\";\n  import { toast } from \"$lib/stores/toast\";\n  \n  export let command: string;\n  export let variant: \"icon\" | \"full\" = \"icon\";\n  \n  let copied = $state(false);\n  \n  async function handleCopy() {\n    await copy(command);\n    copied = true;\n    toast.success(\"Copied to clipboard\");\n    setTimeout(() =\u003e copied = false, 2000);\n  }\n\u003c/script\u003e\n\n{#if variant === \"icon\"}\n  \u003cbutton onclick={handleCopy} class=\"copy-btn\" title=\"Copy command\"\u003e\n    {#if copied}\n      \u003cCheckIcon /\u003e\n    {:else}\n      \u003cCopyIcon /\u003e\n    {/if}\n  \u003c/button\u003e\n{:else}\n  \u003cbutton onclick={handleCopy} class=\"copy-btn-full\"\u003e\n    \u003ccode\u003e{command}\u003c/code\u003e\n    \u003cspan\u003e{copied ? \"Copied!\" : \"Copy\"}\u003c/span\u003e\n  \u003c/button\u003e\n{/if}\n```\n\n### Clipboard Utility\n\n```typescript\n// src/lib/utils/clipboard.ts\nexport async function copy(text: string): Promise\u003cboolean\u003e {\n  try {\n    await navigator.clipboard.writeText(text);\n    return true;\n  } catch {\n    // Fallback for older browsers\n    const textarea = document.createElement(\"textarea\");\n    textarea.value = text;\n    textarea.style.position = \"fixed\";\n    textarea.style.opacity = \"0\";\n    document.body.appendChild(textarea);\n    textarea.select();\n    const success = document.execCommand(\"copy\");\n    document.body.removeChild(textarea);\n    return success;\n  }\n}\n```\n\n## Usage Locations\n\n1. Command Palette - copy suggested commands\n2. Error messages - copy diagnostic commands\n3. Agent detail view - copy agent-specific commands\n4. Work item cards - copy bead IDs\n\n## Accessibility\n\n- Keyboard accessible (Tab + Enter)\n- Screen reader announces \"Copied\" state\n- Visual feedback with checkmark icon\n\n## Tests\n\n- Unit: Clipboard utility with fallback\n- Component: Button states and feedback\n\n\n(Moved from hq-1j2)","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-12T23:12:54.17316+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:12:54.17316+05:30","labels":["layer:ui","phase:1"]}
{"id":"gu-cuy","title":"Digest: mol-refinery-patrol","description":"Patrol: MQ empty, no branches processed, main unchanged","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-12T23:03:36.243328+05:30","updated_at":"2026-01-12T23:03:36.243328+05:30","closed_at":"2026-01-12T23:03:36.243275+05:30","close_reason":"Squashed from 11 wisps","dependencies":[{"issue_id":"gu-cuy","depends_on_id":"gu-wisp-87h","type":"parent-child","created_at":"2026-01-12T23:03:36.24391+05:30","created_by":"gastown_ui/refinery"}]}
{"id":"gu-d2g","title":"Digest: mol-refinery-patrol","description":"Patrol: queue empty, no branches to merge","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-12T22:03:22.95577+05:30","updated_at":"2026-01-12T22:03:22.95577+05:30","closed_at":"2026-01-12T22:03:22.95571+05:30","close_reason":"Squashed from 11 wisps","dependencies":[{"issue_id":"gu-d2g","depends_on_id":"gu-wisp-e0l","type":"parent-child","created_at":"2026-01-12T22:03:22.95639+05:30","created_by":"gastown_ui/refinery"}]}
{"id":"gu-d5z","title":"Create Environment Configuration system","description":"# Environment Configuration System\n\n## Background (from INTEGRATION_PLAN v5.0)\nThe current codebase has hard-coded absolute paths that break portability.\nAll configuration must come from environment variables with sensible defaults.\n\n## Core Principle (v5.0 - #15)\n**Portable**: No hard-coded paths; auto-discovery + env config\n\n## Implementation Requirements\n\n### Config File\n```typescript\n// src/lib/config/environment.ts\n\nexport interface GastownConfig {\n  // Core paths\n  GASTOWN_TOWN_ROOT: string;\n  GASTOWN_HOME: string;\n  GASTOWN_BD_CWD: string;\n  \n  // CLI binaries\n  GASTOWN_GT_BIN: string;\n  GASTOWN_BD_BIN: string;\n  \n  // Timeouts\n  GASTOWN_CLI_TIMEOUT: number;\n  GASTOWN_CLONE_TIMEOUT: number;\n  \n  // Polling intervals\n  GASTOWN_POLL_CRITICAL: number;\n  GASTOWN_POLL_STANDARD: number;\n  GASTOWN_POLL_BACKGROUND: number;\n  \n  // Cache\n  GASTOWN_CACHE_TTL: number;\n  \n  // Feature flags\n  GASTOWN_ENABLE_WRITES: boolean;\n  GASTOWN_DEMO_MODE: boolean;\n}\n```\n\n### .env.example\nDocument all environment variables with descriptions and defaults.\n\n### Startup Validation\n```typescript\n| Requirement | Check Command | Error if Missing |\n|-------------|---------------|------------------|\n| gt binary | which gt | \"gt command not found\" |\n| bd binary | which bd | \"bd command not found\" |\n| .beads/ exists | ls $GASTOWN_BD_CWD/.beads | \"Beads directory not found\" |\n| beads.db accessible | bd list --limit=1 | \"Database not accessible\" |\n| Town initialized | gt status | \"Town not initialized\" |\n```\n\n## Acceptance Criteria\n- [ ] No hard-coded paths in any server code\n- [ ] All paths resolved from environment\n- [ ] .env.example documents all variables\n- [ ] Startup validation fails gracefully with clear messages\n- [ ] Config loaded once and cached\n- [ ] Unit tests verify config loading\n\n## Files\n- src/lib/config/environment.ts\n- src/lib/config/__tests__/environment.test.ts\n- .env.example\n- src/lib/config/validate.ts\n\n## References\n- INTEGRATION_PLAN: Environment Configuration section\n\n(Moved from hq-0qb.7)","status":"closed","priority":1,"issue_type":"task","estimated_minutes":90,"created_at":"2026-01-12T23:12:56.127957+05:30","created_by":"Avyukth","updated_at":"2026-01-13T01:19:54.200272+05:30","closed_at":"2026-01-13T01:19:54.200272+05:30","close_reason":"Duplicate of gu-v8gw (Environment Configuration)","labels":["layer:foundation","phase:1","priority:critical"]}
{"id":"gu-da0","title":"Phase 1 Testing \u0026 Docs Sprint","description":"# Phase 1 Testing \u0026 Documentation Sprint\n\nTesting and documentation work for Phase 1.\n\n## Scope\n- Unit tests for all components\n- Integration tests for API routes\n- CUJ verification checklists\n- LLM-friendly docs\n- API and Architecture docs\n\n## Dependencies\nAll other Phase 1 convoys (implementation must exist to test)\n\n## Exit Criteria\nAll tests passing, documentation complete.\n\n(Moved from hq-fkt)","status":"open","priority":2,"issue_type":"convoy","created_at":"2026-01-12T23:11:40.806829+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:11:40.806829+05:30","labels":["phase:1","sprint:testing"],"dependencies":[{"issue_id":"gu-da0","depends_on_id":"gu-j3j","type":"blocks","created_at":"2026-01-12T23:23:51.841586+05:30","created_by":"Avyukth"},{"issue_id":"gu-da0","depends_on_id":"gu-73p","type":"blocks","created_at":"2026-01-12T23:23:51.949152+05:30","created_by":"Avyukth"},{"issue_id":"gu-da0","depends_on_id":"gu-faa","type":"blocks","created_at":"2026-01-12T23:23:52.060382+05:30","created_by":"Avyukth"},{"issue_id":"gu-da0","depends_on_id":"gu-25m","type":"blocks","created_at":"2026-01-12T23:23:52.161899+05:30","created_by":"Avyukth"},{"issue_id":"gu-da0","depends_on_id":"gu-sp3","type":"blocks","created_at":"2026-01-12T23:23:52.265017+05:30","created_by":"Avyukth"},{"issue_id":"gu-da0","depends_on_id":"gu-8kv","type":"blocks","created_at":"2026-01-12T23:23:52.365075+05:30","created_by":"Avyukth"},{"issue_id":"gu-da0","depends_on_id":"gu-1l7","type":"blocks","created_at":"2026-01-12T23:23:52.465434+05:30","created_by":"Avyukth"},{"issue_id":"gu-da0","depends_on_id":"gu-txm","type":"blocks","created_at":"2026-01-12T23:23:52.56859+05:30","created_by":"Avyukth"},{"issue_id":"gu-da0","depends_on_id":"gu-ow2","type":"blocks","created_at":"2026-01-12T23:23:52.675333+05:30","created_by":"Avyukth"},{"issue_id":"gu-da0","depends_on_id":"gu-20z","type":"blocks","created_at":"2026-01-12T23:23:52.781876+05:30","created_by":"Avyukth"},{"issue_id":"gu-da0","depends_on_id":"gu-pod","type":"blocks","created_at":"2026-01-12T23:25:18.885055+05:30","created_by":"Avyukth"},{"issue_id":"gu-da0","depends_on_id":"gu-4si","type":"blocks","created_at":"2026-01-12T23:25:18.995815+05:30","created_by":"Avyukth"},{"issue_id":"gu-da0","depends_on_id":"gu-yk5","type":"blocks","created_at":"2026-01-12T23:25:19.103752+05:30","created_by":"Avyukth"},{"issue_id":"gu-da0","depends_on_id":"gu-598","type":"blocks","created_at":"2026-01-12T23:25:19.209459+05:30","created_by":"Avyukth"},{"issue_id":"gu-da0","depends_on_id":"gu-p1o","type":"blocks","created_at":"2026-01-13T00:04:00.467208+05:30","created_by":"Avyukth"},{"issue_id":"gu-da0","depends_on_id":"gu-9n9","type":"blocks","created_at":"2026-01-13T00:04:00.573125+05:30","created_by":"Avyukth"},{"issue_id":"gu-da0","depends_on_id":"gu-l0uq","type":"blocks","created_at":"2026-01-13T00:04:00.681947+05:30","created_by":"Avyukth"},{"issue_id":"gu-da0","depends_on_id":"gu-9mtr","type":"blocks","created_at":"2026-01-13T00:04:00.827417+05:30","created_by":"Avyukth"},{"issue_id":"gu-da0","depends_on_id":"gu-qwqq","type":"blocks","created_at":"2026-01-13T00:04:00.932295+05:30","created_by":"Avyukth"},{"issue_id":"gu-da0","depends_on_id":"gu-r2pm","type":"blocks","created_at":"2026-01-13T00:04:01.037447+05:30","created_by":"Avyukth"},{"issue_id":"gu-da0","depends_on_id":"gu-opvu","type":"blocks","created_at":"2026-01-13T00:04:01.137188+05:30","created_by":"Avyukth"},{"issue_id":"gu-da0","depends_on_id":"gu-e8eu","type":"blocks","created_at":"2026-01-13T00:04:01.236933+05:30","created_by":"Avyukth"},{"issue_id":"gu-da0","depends_on_id":"gu-44ug","type":"blocks","created_at":"2026-01-13T00:04:01.341036+05:30","created_by":"Avyukth"},{"issue_id":"gu-da0","depends_on_id":"gu-shp7","type":"blocks","created_at":"2026-01-13T00:04:01.444695+05:30","created_by":"Avyukth"},{"issue_id":"gu-da0","depends_on_id":"gu-0ual","type":"blocks","created_at":"2026-01-13T00:04:01.553563+05:30","created_by":"Avyukth"},{"issue_id":"gu-da0","depends_on_id":"gu-kvvy","type":"blocks","created_at":"2026-01-13T00:04:01.660997+05:30","created_by":"Avyukth"},{"issue_id":"gu-da0","depends_on_id":"gu-h30x","type":"blocks","created_at":"2026-01-13T00:04:01.770376+05:30","created_by":"Avyukth"},{"issue_id":"gu-da0","depends_on_id":"gu-vyg7","type":"blocks","created_at":"2026-01-13T00:04:01.872083+05:30","created_by":"Avyukth"},{"issue_id":"gu-da0","depends_on_id":"gu-s7zr","type":"blocks","created_at":"2026-01-13T00:04:01.973594+05:30","created_by":"Avyukth"},{"issue_id":"gu-da0","depends_on_id":"gu-ve52","type":"blocks","created_at":"2026-01-13T00:37:28.860794+05:30","created_by":"Avyukth"},{"issue_id":"gu-da0","depends_on_id":"gu-bz5x","type":"blocks","created_at":"2026-01-13T00:37:28.975657+05:30","created_by":"Avyukth"},{"issue_id":"gu-da0","depends_on_id":"gu-335i","type":"blocks","created_at":"2026-01-13T00:59:39.011588+05:30","created_by":"Avyukth"},{"issue_id":"gu-da0","depends_on_id":"gu-z6je","type":"blocks","created_at":"2026-01-13T01:02:00.14211+05:30","created_by":"Avyukth"},{"issue_id":"gu-da0","depends_on_id":"gu-wgo2","type":"blocks","created_at":"2026-01-13T01:02:00.240861+05:30","created_by":"Avyukth"},{"issue_id":"gu-da0","depends_on_id":"gu-7isd","type":"blocks","created_at":"2026-01-13T01:02:13.07667+05:30","created_by":"Avyukth"}]}
{"id":"gu-da5","title":"[P1] API Routes: Gas Town Endpoints","description":"# Phase 1 API Routes Layer\n\n## Background\nAll API routes live under /api/gastown/* and serve as the bridge between\nthe SvelteKit frontend and the Gas Town CLI tools (gt, bd).\n\n## Endpoints to Implement (from INTEGRATION_PLAN v5.0)\n\n### Core Endpoints\n- GET /api/gastown/status - System status (gt status --json)\n- GET /api/gastown/agents - Agent list (parsed from gt status)\n- GET /api/gastown/convoys - Convoy list (gt convoy list --json)\n- GET /api/gastown/mail - Mail messages (bd list --type=message, NOT gt mail inbox)\n- GET /api/gastown/queue - Merge queue (gt mq list --json)\n- GET /api/gastown/rigs - Rig list (gt rig list --json)\n- GET /api/gastown/work - Work items (bd list --json)\n\n### System Endpoints\n- GET /api/gastown/capabilities - CLI version and feature flags\n- GET /api/gastown/diagnostics - Health checks (gt doctor --json)\n- GET /api/gastown/feed/stream - SSE activity stream\n\n## Why This Matters\n- Routes are the contract between frontend and backend\n- Each route wraps CLI execution with proper error handling\n- All routes must handle: timeouts, JSON parse failures, CLI errors\n- SSE stream enables real-time updates without polling\n\n## Acceptance Criteria\n- [ ] All core endpoints return valid JSON\n- [ ] Error responses follow consistent schema with requestId\n- [ ] Timeouts configured per endpoint\n- [ ] Known bugs have workarounds (gt mail inbox ‚Üí bd list)\n- [ ] SSE stream broadcasts events from .events.jsonl\n- [ ] All routes use Process Supervisor (no direct spawn)\n\n## Architecture Decision References\n- D1.1: Endpoint Structure\n- D1.4: Feed Endpoint Structure\n- D2.3: SSE vs WebSocket for Updates\n\n## Dependencies\n- EPIC: Foundation Layer (hq-0qb)\n- EPIC: Data Layer (hq-bpb)\n\n## Files to Create/Modify\n- src/routes/api/gastown/status/+server.ts\n- src/routes/api/gastown/agents/+server.ts\n- src/routes/api/gastown/convoys/+server.ts\n- src/routes/api/gastown/mail/+server.ts\n- src/routes/api/gastown/queue/+server.ts\n- src/routes/api/gastown/rigs/+server.ts\n- src/routes/api/gastown/work/+server.ts\n- src/routes/api/gastown/capabilities/+server.ts\n- src/routes/api/gastown/diagnostics/+server.ts\n- src/routes/api/gastown/feed/stream/+server.ts\n\n(Moved from hq-0er)","status":"open","priority":1,"issue_type":"epic","created_at":"2026-01-12T23:11:32.104771+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:11:32.104771+05:30","labels":["critical:yes","layer:api","phase:1"]}
{"id":"gu-ded","title":"Implement Known Bug Detection system","description":"# Known Bug Detection System\n\n## Background\nSome CLI commands have known bugs (e.g., gt mail inbox hangs in Node.js).\nThe system must detect these and provide workarounds/guidance.\n\n## Known Bugs to Track\n\n| Bug ID | Command | Symptom | Workaround |\n|--------|---------|---------|------------|\n| GT_MAIL_HANG | gt mail inbox | Hangs in Node.js | Use bd list --type=message |\n| BD_EMPTY_JSON | bd list | Returns empty when daemon not running | Check daemon first |\n\n## Implementation\n```typescript\n// src/lib/errors/known-bugs.ts\n\nexport interface KnownBugInfo {\n  bugId: string;\n  userMessage: string;\n  workaround?: string;\n  severity: 'warning' | 'error';\n  recoverable: boolean;\n}\n\nconst KNOWN_BUGS: Array\u003c{\n  pattern: RegExp;\n  info: KnownBugInfo;\n}\u003e = [\n  {\n    pattern: /mail.*hang|timeout.*mail/i,\n    info: {\n      bugId: 'GT_MAIL_HANG',\n      userMessage: 'gt mail inbox hangs in Node.js environment',\n      workaround: 'Using bd list --type=message as fallback',\n      severity: 'warning',\n      recoverable: true\n    }\n  }\n];\n\nexport function identifyKnownBug(stderr: string): KnownBugInfo | null {\n  for (const bug of KNOWN_BUGS) {\n    if (bug.pattern.test(stderr)) {\n      return bug.info;\n    }\n  }\n  return null;\n}\n```\n\n## Acceptance Criteria\n- [ ] Known bugs catalog with patterns\n- [ ] identifyKnownBug function\n- [ ] Workarounds documented in code\n- [ ] UI shows known bug messages gracefully\n- [ ] Unit tests for pattern matching\n\n## Files\n- src/lib/errors/known-bugs.ts\n- src/lib/errors/__tests__/known-bugs.test.ts\n\n## References\n- INTEGRATION_PLAN: Known Bug - gt mail inbox hangs\n\n(Moved from hq-0qb.9)","status":"closed","priority":1,"issue_type":"task","estimated_minutes":60,"created_at":"2026-01-12T23:12:55.922261+05:30","created_by":"Avyukth","updated_at":"2026-01-13T01:19:53.79698+05:30","closed_at":"2026-01-13T01:19:53.79698+05:30","close_reason":"Duplicate of gu-034d (Known Bug Detection)","labels":["layer:foundation","phase:1"]}
{"id":"gu-drm","title":"Digest: mol-refinery-patrol","description":"Patrol: queue empty, no branches to merge","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-12T21:58:23.481776+05:30","updated_at":"2026-01-12T21:58:23.481776+05:30","closed_at":"2026-01-12T21:58:23.481719+05:30","close_reason":"Squashed from 11 wisps","dependencies":[{"issue_id":"gu-drm","depends_on_id":"gu-wisp-rkn","type":"parent-child","created_at":"2026-01-12T21:58:23.482399+05:30","created_by":"gastown_ui/refinery"}]}
{"id":"gu-dze","title":"Define Zod CLI Contracts for output validation","description":"# Zod CLI Contracts Implementation\n\n## Background\nCLI output formats can change between versions. Zod contracts validate that CLI\nJSON output matches expected schemas, enabling graceful handling of schema drift.\n\n## Why This Matters\n- CLI output is a contract between CLI and UI\n- Without validation, parsing errors cause crashes\n- Schema drift causes silent data corruption\n- Contracts enable \"schema mismatch\" errors vs crashes\n\n## Implementation Requirements\n\n### Contract Definitions\n```typescript\n// src/lib/server/cli/contracts.ts\n\nimport { z } from 'zod';\n\nexport const StatusContract = z.object({\n  workspace: z.string(),\n  agents: z.array(z.object({\n    name: z.string(),\n    type: z.string(),\n    status: z.enum(['running', 'idle', 'stopped'])\n  })),\n  rigs: z.array(z.object({\n    name: z.string(),\n    path: z.string()\n  }))\n});\n\nexport const WorkItemContract = z.object({\n  id: z.string(),\n  title: z.string(),\n  status: z.string(),\n  priority: z.number(),\n  issue_type: z.string(),\n  // ... more fields\n}).passthrough(); // Allow extra fields for forward compat\n\nexport const ConvoyContract = z.object({\n  id: z.string(),\n  title: z.string(),\n  items: z.array(z.string()),\n  status: z.string()\n});\n\n// Export contract types\nexport type Status = z.infer\u003ctypeof StatusContract\u003e;\nexport type WorkItem = z.infer\u003ctypeof WorkItemContract\u003e;\nexport type Convoy = z.infer\u003ctypeof ConvoyContract\u003e;\n```\n\n### Validation Helper\n```typescript\nexport function validateContract\u003cT\u003e(\n  schema: z.ZodType\u003cT\u003e,\n  data: unknown,\n  context: string\n): T {\n  const result = schema.safeParse(data);\n  if (!result.success) {\n    throw new ContractMismatchError(\n      `Contract mismatch for ${context}`,\n      result.error.issues\n    );\n  }\n  return result.data;\n}\n```\n\n### Graceful Degradation\n- passthrough() allows unknown fields (forward compat)\n- Optional fields with defaults for missing data\n- Log mismatches but continue where possible\n\n## Acceptance Criteria\n- [ ] Contracts defined for all CLI JSON outputs\n- [ ] Validation helper with typed errors\n- [ ] passthrough() for forward compatibility\n- [ ] ContractMismatchError with detailed issues\n- [ ] Logging of schema mismatches\n- [ ] Unit tests with valid and invalid inputs\n\n## Files\n- src/lib/server/cli/contracts.ts\n- src/lib/server/cli/errors.ts (ContractMismatchError)\n- src/lib/server/cli/__tests__/contracts.test.ts\n\n## References\n- INTEGRATION_PLAN D0.6: Capabilities Probe + CLI Contracts\n- INTEGRATION_PLAN: Contract Testing section\n\n(Moved from hq-0qb.5)","status":"open","priority":1,"issue_type":"task","estimated_minutes":60,"created_at":"2026-01-12T23:12:58.669427+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:12:58.669427+05:30","labels":["layer:foundation","phase:1"]}
{"id":"gu-e8eu","title":"Smoke tests: CUJ-2 Work Item Lifecycle","description":"# Smoke Tests: CUJ-2 Work Item Lifecycle\n\n## Background\nAutomated smoke test script that validates the Work Item creation and management journey.\n\n## CRITICAL: Detailed Logging Requirements\nAll smoke tests MUST provide comprehensive logging for debugging:\n\n```typescript\nimport { createTestLogger } from './lib/logger';\nconst logger = createTestLogger('CUJ-2: Work Item Lifecycle');\n```\n\n## Test Script\n```typescript\n// scripts/smoke/cuj-2-work-lifecycle.ts\n\nimport { expect, test } from 'bun:test';\nimport { createTestLogger } from './lib/logger';\n\nconst BASE_URL = process.env.BASE_URL || 'http://localhost:3000';\nconst logger = createTestLogger('CUJ-2: Work Item Lifecycle');\n\ntest('CUJ-2: Create Work Item Flow', async () =\u003e {\n  const startTime = Date.now();\n  \n  // 1. Create work item\n  logger.step('1. Create work item via POST');\n  const payload = {\n    title: 'Smoke test work item',\n    priority: 1,\n    labels: ['smoke-test', 'automated']\n  };\n  logger.request('POST', `${BASE_URL}/api/gastown/work/issues`, payload);\n  \n  const createRes = await fetch(`${BASE_URL}/api/gastown/work/issues`, {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify(payload)\n  });\n  const createBody = await createRes.json();\n  \n  logger.response(createRes.status, createBody);\n  expect(createRes.ok).toBe(true);\n  const { id } = createBody;\n  logger.success(`Created work item: ${id}`);\n  logger.timing('Step 1', Date.now() - startTime);\n  \n  // 2. Verify ID format\n  logger.step('2. Verify ID format');\n  logger.info(`ID: ${id}`);\n  expect(id).toMatch(/^[a-z]+-[a-z0-9]+$/);\n  logger.success('ID format valid');\n  \n  // 3. Fetch work item\n  logger.step('3. Fetch work item by ID');\n  logger.request('GET', `${BASE_URL}/api/gastown/work/issues/${id}`);\n  \n  const getRes = await fetch(`${BASE_URL}/api/gastown/work/issues/${id}`);\n  const item = await getRes.json();\n  \n  logger.response(getRes.status, item);\n  expect(getRes.ok).toBe(true);\n  expect(item.title).toBe('Smoke test work item');\n  expect(item.priority).toBe(1);\n  logger.success('Work item fetched successfully');\n  logger.info('Item details:', item);\n  \n  // 4. Verify in list\n  logger.step('4. Verify item appears in list');\n  logger.request('GET', `${BASE_URL}/api/gastown/work/issues`);\n  \n  const listRes = await fetch(`${BASE_URL}/api/gastown/work/issues`);\n  const items = await listRes.json();\n  \n  logger.response(listRes.status, { count: items.length, sample: items.slice(0, 3) });\n  const found = items.some((i: any) =\u003e i.id === id);\n  expect(found).toBe(true);\n  logger.success(`Found item ${id} in list of ${items.length} items`);\n  \n  // Summary\n  logger.summary('CUJ-2', true, Date.now() - startTime, 4);\n});\n\ntest('CUJ-2: Update Work Item Priority', async () =\u003e {\n  const startTime = Date.now();\n  \n  logger.step('1. Create work item for update test');\n  // ... create item ...\n  \n  logger.step('2. Update priority');\n  // ... update ...\n  \n  logger.step('3. Verify update persisted');\n  // ... verify ...\n  \n  logger.summary('CUJ-2 Update', true, Date.now() - startTime, 3);\n});\n```\n\n## Manual Verification Checklist\n- [ ] Navigate to /work\n- [ ] Click \"New Work Item\"\n- [ ] Fill title, priority, labels\n- [ ] Click \"Create\"\n- [ ] Verify toast shows \"Creating work item...\"\n- [ ] Verify toast shows \"Created: \u003cid\u003e\"\n- [ ] Verify item appears at TOP of list\n\n## Run Command\n```bash\nbun run scripts/smoke/cuj-2-work-lifecycle.ts\n```\n\n## Acceptance Criteria\n- [ ] Script runs without errors\n- [ ] Creates work item via API\n- [ ] Validates ID format\n- [ ] Verifies item in list\n- [ ] **DETAILED LOGGING**: Every step logs request/response\n- [ ] **TIMING**: Each step logs duration\n- [ ] **VISUAL OUTPUT**: Clear step banners\n- [ ] **SUMMARY**: Final pass/fail with total duration\n\n## Files\n- scripts/smoke/cuj-2-work-lifecycle.ts\n- scripts/smoke/lib/logger.ts (shared)\n\n## Dependencies\n- gu-335i: Shared test logging utilities\n\n## References\n- INTEGRATION_PLAN CUJ-2: Work Item Lifecycle","status":"open","priority":1,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-12T23:56:23.254632+05:30","created_by":"Avyukth","updated_at":"2026-01-13T01:30:25.904796+05:30","labels":["layer:testing","phase:1","type:smoke"]}
{"id":"gu-eb9","title":"Generate LLM-Friendly Documentation (llms.txt)","description":"# LLM-Friendly Documentation Generation\n\n## Background\nGenerate `/llms.txt` (concise ~500 lines) and `/llms-full.txt` (comprehensive ~3000 lines) for AI assistants and contributor onboarding.\n\n## Files to Create\n- `static/llms.txt` - Concise index with project overview, endpoint index, known bugs\n- `static/llms-full.txt` - Full concatenation of all docs\n- `scripts/generate-llms-txt.ts` - Generation script\n- `.github/workflows/docs-update.yml` - CI workflow to regenerate on doc changes\n\n## Content Requirements for llms.txt\n1. Project overview (Gas Town UI purpose)\n2. Phase 1 architecture summary\n3. Endpoint index with descriptions\n4. Known bugs table\n5. Error codes reference\n6. Quick start for contributors\n\n## Acceptance Criteria\n- [ ] static/llms.txt exists and is \u003c 50KB\n- [ ] static/llms-full.txt exists with all docs\n- [ ] scripts/generate-llms-txt.ts works with bun\n- [ ] CI regenerates on docs/ changes\n- [ ] README links to llms.txt\n- [ ] Content validates with curl localhost:3000/llms.txt\n\n## References\n- INTEGRATION_PLAN D0.9: LLM-Friendly Docs Surface\n- Key Innovation #10","status":"open","priority":1,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-12T23:34:23.791729+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:34:23.791729+05:30","labels":["layer:docs","phase:1"]}
{"id":"gu-ehz","title":"Digest: mol-refinery-patrol","description":"Patrol: MQ empty, 0 branches merged, no issues","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-12T22:07:04.29083+05:30","updated_at":"2026-01-12T22:07:04.29083+05:30","closed_at":"2026-01-12T22:07:04.290772+05:30","close_reason":"Squashed from 11 wisps","dependencies":[{"issue_id":"gu-ehz","depends_on_id":"gu-wisp-u94","type":"parent-child","created_at":"2026-01-12T22:07:04.291506+05:30","created_by":"gastown_ui/refinery"}]}
{"id":"gu-elh","title":"Digest: mol-refinery-patrol","description":"Patrol: MQ empty, 0 branches merged, no issues","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-12T23:20:44.656582+05:30","updated_at":"2026-01-12T23:20:44.656582+05:30","closed_at":"2026-01-12T23:20:44.656523+05:30","close_reason":"Squashed from 11 wisps","dependencies":[{"issue_id":"gu-elh","depends_on_id":"gu-wisp-qwv","type":"parent-child","created_at":"2026-01-12T23:20:44.657233+05:30","created_by":"gastown_ui/refinery"}]}
{"id":"gu-enx","title":"Implement /api/gastown/rigs endpoint","description":"# Rigs Endpoint Implementation\n\n## Background\nReturns list of registered rigs (project containers). Each rig has polecats,\ncrew members, and agents.\n\n## CLI Command\n```bash\ngt rig list --json\n```\n\n## Expected Response\n```json\n{\n  \"rigs\": [\n    {\n      \"name\": \"gastown_ui\",\n      \"path\": \"/path/to/gastown_ui\",\n      \"polecats\": 0,\n      \"crew\": 2,\n      \"agents\": [\"refinery\", \"witness\", \"mayor\"]\n    }\n  ],\n  \"timestamp\": \"2026-01-12T10:00:00Z\"\n}\n```\n\n## Acceptance Criteria\n- [ ] Returns rig list JSON\n- [ ] Includes polecat/crew counts\n- [ ] Uses SWR cache with 30s stale time\n- [ ] Validates response with Zod contract\n- [ ] Unit test with mocked CLI\n\n## Files\n- src/routes/api/gastown/rigs/+server.ts\n- src/routes/api/gastown/rigs/__tests__/server.test.ts\n\n## References\n- INTEGRATION_PLAN: Rigs Endpoint section\n- CLI: gt rig list --json\n\n(Moved from hq-0er.5)","status":"open","priority":1,"issue_type":"task","estimated_minutes":45,"created_at":"2026-01-12T23:12:57.7368+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:12:57.7368+05:30","labels":["layer:api","phase:1"]}
{"id":"gu-eqv","title":"Implement ARIA patterns for screen reader support","description":"# ARIA Patterns Implementation\n\nEnsures all interactive components have proper ARIA attributes for screen reader users.\n\n## Patterns to Implement\n\n### Live Regions\n\n```svelte\n\u003c!-- Toast notifications --\u003e\n\u003cdiv role=\"status\" aria-live=\"polite\" aria-atomic=\"true\"\u003e\n  {#each toasts as toast}\n    \u003cdiv class=\"toast\"\u003e{toast.message}\u003c/div\u003e\n  {/each}\n\u003c/div\u003e\n\n\u003c!-- Error messages --\u003e\n\u003cdiv role=\"alert\" aria-live=\"assertive\"\u003e\n  {#if error}\n    \u003cp\u003e{error.message}\u003c/p\u003e\n  {/if}\n\u003c/div\u003e\n```\n\n### Landmarks\n\n```svelte\n\u003cheader role=\"banner\"\u003e\n  \u003cnav role=\"navigation\" aria-label=\"Main\"\u003e...\u003c/nav\u003e\n\u003c/header\u003e\n\n\u003cmain role=\"main\" aria-labelledby=\"page-title\"\u003e\n  \u003ch1 id=\"page-title\"\u003e{pageTitle}\u003c/h1\u003e\n  ...\n\u003c/main\u003e\n\n\u003caside role=\"complementary\" aria-label=\"Operation Center\"\u003e\n  ...\n\u003c/aside\u003e\n```\n\n### Interactive Components\n\n```svelte\n\u003c!-- Command Palette --\u003e\n\u003cdiv\n  role=\"combobox\"\n  aria-expanded={open}\n  aria-haspopup=\"listbox\"\n  aria-owns=\"command-listbox\"\n  aria-activedescendant={activeId}\n\u003e\n  \u003cinput\n    role=\"searchbox\"\n    aria-autocomplete=\"list\"\n    aria-controls=\"command-listbox\"\n  /\u003e\n\u003c/div\u003e\n\n\u003cul id=\"command-listbox\" role=\"listbox\"\u003e\n  {#each commands as cmd, i}\n    \u003cli\n      id=\"cmd-{i}\"\n      role=\"option\"\n      aria-selected={i === activeIndex}\n    \u003e\n      {cmd.label}\n    \u003c/li\u003e\n  {/each}\n\u003c/ul\u003e\n```\n\n### Status Indicators\n\n```svelte\n\u003cspan\n  role=\"status\"\n  aria-label=\"Agent status: {status}\"\n  class=\"status-indicator status-{status}\"\n\u003e\n  \u003cspan class=\"visually-hidden\"\u003e{status}\u003c/span\u003e\n\u003c/span\u003e\n```\n\n## Validation\n\n- axe-core automated checks\n- Manual NVDA/VoiceOver testing\n- Keyboard-only navigation audit\n\n## Tests\n\n- Unit: ARIA attribute presence\n- Integration: axe-core violations = 0\n- Manual: Screen reader flow walkthrough\n\n\n(Moved from hq-op8)","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-12T23:12:53.963349+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:12:53.963349+05:30","labels":["layer:a11y","phase:1"]}
{"id":"gu-faa","title":"Unit tests: Zod CLI Contracts","description":"# Unit Tests: Zod CLI Contracts\n\n## Test Cases\n\n### Valid Inputs\n- [x] Valid status JSON parses\n- [x] Valid work item JSON parses\n- [x] Valid convoy JSON parses\n- [x] Extra fields allowed (passthrough)\n\n### Invalid Inputs\n- [x] Missing required fields rejected\n- [x] Wrong types rejected\n- [x] Detailed error messages returned\n\n### Edge Cases\n- [x] Empty arrays allowed\n- [x] Null values handled\n- [x] Unicode strings work\n\n## Test Fixtures\nInclude real CLI output samples for regression testing.\n\n## Acceptance Criteria\n- [ ] All contracts have tests\n- [ ] Real CLI output fixtures used\n- [ ] Error messages are helpful\n\n## Files\n- src/lib/server/cli/__tests__/contracts.test.ts\n- src/lib/server/cli/__tests__/fixtures/*.json\n\n## References\n- Task: hq-0qb.5 (Zod Contracts implementation)\n\n(Moved from hq-nbf.3)","status":"open","priority":1,"issue_type":"task","estimated_minutes":60,"created_at":"2026-01-12T23:12:56.331565+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:12:56.331565+05:30","labels":["layer:testing","phase:1","type:unit"]}
{"id":"gu-fmr","title":"Digest: mol-refinery-patrol","description":"Patrol: MQ empty, no branches processed","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-12T21:10:57.593794+05:30","updated_at":"2026-01-12T21:10:57.593794+05:30","closed_at":"2026-01-12T21:10:57.593745+05:30","close_reason":"Squashed from 11 wisps"}
{"id":"gu-fu7a","title":"Implement Rigs page","description":"# Rigs Page Implementation\n\n## Background\nThe Rigs page shows registered project containers with their agents,\npolecats, and crew members.\n\n## Features\n- Rig list with agent counts\n- Expand to see agents/crew\n- Rig health indicators\n- Add rig (Phase 2)\n\n## Acceptance Criteria\n- [ ] Lists rigs with counts\n- [ ] Expandable to show details\n- [ ] Agent status indicators\n- [ ] Loading skeletons\n- [ ] Empty state\n\n## Files\n- src/routes/rigs/+page.svelte\n- src/lib/components/RigCard.svelte\n\n## References\n- INTEGRATION_PLAN: CUJ-1 Rig Management\n\n(Moved from hq-wbe.10)","status":"open","priority":2,"issue_type":"task","estimated_minutes":90,"created_at":"2026-01-12T23:13:26.673116+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:13:26.673116+05:30","labels":["layer:ui","phase:1"]}
{"id":"gu-gastown_ui-crew-avyukth","title":"Crew worker avyukth in gastown_ui - human-managed persistent workspace.","description":"Crew worker avyukth in gastown_ui - human-managed persistent workspace.\n\nrole_type: crew\nrig: gastown_ui\nagent_state: idle\nhook_bead: null\nrole_bead: hq-crew-role\ncleanup_status: null\nactive_mr: null\nnotification_level: null","status":"open","priority":2,"issue_type":"agent","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-12T19:42:54.338289+05:30","created_by":"Avyukth","updated_at":"2026-01-12T19:42:54.443205+05:30","labels":["gt:agent"]}
{"id":"gu-gastown_ui-refinery","title":"Refinery for gastown_ui - processes merge queue.","description":"Refinery for gastown_ui - processes merge queue.\n\nrole_type: refinery\nrig: gastown_ui\nagent_state: idle\nhook_bead: null\nrole_bead: hq-refinery-role\ncleanup_status: null\nactive_mr: null\nnotification_level: null","status":"open","priority":2,"issue_type":"agent","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-12T19:41:19.73756+05:30","created_by":"Avyukth","updated_at":"2026-01-12T19:41:19.845725+05:30","labels":["gt:agent"]}
{"id":"gu-gastown_ui-witness","title":"Witness for gastown_ui - monitors polecat health and progress.","description":"Witness for gastown_ui - monitors polecat health and progress.\n\nrole_type: witness\nrig: gastown_ui\nagent_state: idle\nhook_bead: null\nrole_bead: hq-witness-role\ncleanup_status: null\nactive_mr: null\nnotification_level: null","status":"open","priority":2,"issue_type":"agent","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-12T19:41:19.348148+05:30","created_by":"Avyukth","updated_at":"2026-01-12T19:41:19.465166+05:30","labels":["gt:agent"]}
{"id":"gu-gil","title":"Digest: mol-refinery-patrol","description":"Patrol: queue empty, 0 branches merged","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-12T23:15:43.419075+05:30","updated_at":"2026-01-12T23:15:43.419075+05:30","closed_at":"2026-01-12T23:15:43.419006+05:30","close_reason":"Squashed from 11 wisps","dependencies":[{"issue_id":"gu-gil","depends_on_id":"gu-wisp-fog","type":"parent-child","created_at":"2026-01-12T23:15:43.419728+05:30","created_by":"gastown_ui/refinery"}]}
{"id":"gu-gj4","title":"Implement Error Boundary component","description":"# Enhance Error Boundary component\n\n## EXISTING IMPLEMENTATION ‚úÖ\nErrorBoundary EXISTS at `src/lib/components/ErrorBoundary.svelte`\n\n### Current State (PARTIAL)\n- ‚úÖ Catches rendering errors\n- ‚úÖ Reset/retry functionality\n- ‚úÖ Custom fallback snippet support\n- ‚úÖ Stack trace in dev mode\n- ‚úÖ role=\"alert\"\n- ‚ùå Missing Known Bug Detection integration\n- ‚ùå Missing category-based error display\n- ‚ùå Missing \"Copy debug info\" button\n- ‚ùå Missing data-testid attributes\n- ‚ùå Missing suggested action display\n\n## REQUIRED ENHANCEMENTS\n\n### 1. Known Bug Detection integration\n```typescript\nimport { identifyKnownBug, getErrorCategory } from '$lib/errors/known-bugs';\n\nconst knownBug = $derived(error ? identifyKnownBug(error.message) : null);\nconst category = $derived(error ? getErrorCategory(error) : null);\n\nconst userMessage = $derived(\n  knownBug?.userMessage ?? category?.defaultMessage ?? fallbackMessage\n);\nconst suggestedAction = $derived(\n  knownBug?.workaround ?? category?.suggestedAction ?? 'Please try again'\n);\n```\n\n### 2. Category-based display\n```svelte\n{#if category}\n  \u003cspan class=\"category-icon\"\u003e{category.icon}\u003c/span\u003e\n  \u003ch3\u003e{userMessage}\u003c/h3\u003e\n  \u003cp class=\"suggested-action\"\u003e{suggestedAction}\u003c/p\u003e\n{/if}\n```\n\n### 3. Copy debug info button\n```svelte\n\u003cbutton\n  data-testid=\"error-copy-debug\"\n  onclick={copyDebugInfo}\n\u003e\n  Copy debug info\n\u003c/button\u003e\n\nfunction copyDebugInfo() {\n  const debug = JSON.stringify({\n    error: error?.message,\n    stack: error?.stack,\n    url: window.location.href,\n    timestamp: new Date().toISOString(),\n    knownBug: knownBug?.id\n  }, null, 2);\n  navigator.clipboard.writeText(debug);\n  toastStore.success('Debug info copied');\n}\n```\n\n### 4. data-testid attributes\n```svelte\n\u003cdiv data-testid=\"error-boundary\" role=\"alert\"\u003e\n  \u003cbutton data-testid=\"error-retry\"\u003eTry Again\u003c/button\u003e\n  \u003cbutton data-testid=\"error-copy-debug\"\u003eCopy debug info\u003c/button\u003e\n\u003c/div\u003e\n```\n\n## Acceptance Criteria\n- [ ] Known Bug Detection integration\n- [ ] Category-based user messages\n- [ ] Suggested action display\n- [ ] Copy debug info button\n- [ ] data-testid attributes\n- [ ] Category icons\n\n## Files to Modify\n- src/lib/components/ErrorBoundary.svelte\n\n## Dependencies\n- gu-034d: Known Bug Detection system (MUST be implemented first)","status":"open","priority":1,"issue_type":"task","estimated_minutes":60,"created_at":"2026-01-12T23:12:56.833779+05:30","created_by":"Avyukth","updated_at":"2026-01-13T01:18:18.440279+05:30","labels":["layer:ui","phase:1"]}
{"id":"gu-gwqi","title":"Implement Multi-Tier Polling System with SWR","description":"# Multi-Tier Polling System\n\n## Background\nDifferent data has different freshness requirements. Use tiered polling\nwith jitter to prevent thundering herd.\n\n## Polling Tiers\n| Tier | Interval | Endpoints | Rationale |\n|------|----------|-----------|-----------|\n| Critical | 5s | status, queue | Needs real-time |\n| Standard | 15s | agents, work, convoys | Moderate freshness |\n| Background | 60s | rigs, health | Rarely changes |\n\n## Implementation\n```typescript\n// src/lib/stores/polling.svelte.ts\n\ninterface PollingConfig {\n  interval: number;\n  jitter: number;  // ¬± ms to prevent thundering herd\n  pauseWhenHidden: boolean;\n  pauseWhenOffline: boolean;\n}\n\nconst TIERS: Record\u003cstring, PollingConfig\u003e = {\n  critical: { interval: 5000, jitter: 500, pauseWhenHidden: true, pauseWhenOffline: true },\n  standard: { interval: 15000, jitter: 1000, pauseWhenHidden: true, pauseWhenOffline: true },\n  background: { interval: 60000, jitter: 5000, pauseWhenHidden: true, pauseWhenOffline: true },\n};\n\nfunction addJitter(interval: number, jitter: number): number {\n  return interval + Math.floor(Math.random() * jitter * 2) - jitter;\n}\n\nclass PollingManager {\n  #timers = new Map\u003cstring, NodeJS.Timeout\u003e();\n  #paused = false;\n  \n  register(key: string, fetcher: () =\u003e Promise\u003cvoid\u003e, tier: keyof typeof TIERS) {\n    const config = TIERS[tier];\n    \n    const tick = async () =\u003e {\n      if (this.#paused) return;\n      await fetcher();\n      this.#timers.set(key, setTimeout(tick, addJitter(config.interval, config.jitter)));\n    };\n    \n    tick();\n  }\n  \n  pause() { this.#paused = true; }\n  resume() { this.#paused = false; }\n  unregister(key: string) { \n    const timer = this.#timers.get(key);\n    if (timer) clearTimeout(timer);\n    this.#timers.delete(key);\n  }\n}\n```\n\n## Visibility \u0026 Network Handling\n```typescript\n// Pause when tab hidden\ndocument.addEventListener('visibilitychange', () =\u003e {\n  if (document.hidden) polling.pause();\n  else polling.resume();\n});\n\n// Pause when offline, immediate refresh when online\nwindow.addEventListener('offline', () =\u003e polling.pause());\nwindow.addEventListener('online', () =\u003e {\n  polling.resume();\n  // Immediate refresh on reconnect\n  invalidateAll();\n});\n```\n\n## Integration with SWR\n- Polling triggers SWR revalidation\n- SWR dedupes concurrent requests\n- Cache serves stale data while revalidating\n\n## Acceptance Criteria\n- [ ] Three polling tiers implemented\n- [ ] Jitter prevents thundering herd\n- [ ] Pauses when tab hidden\n- [ ] Pauses when offline\n- [ ] Immediate refresh on reconnect\n- [ ] Integrates with SWR cache\n- [ ] Unit tests for jitter calculation\n- [ ] No memory leaks (cleanup on unmount)\n\n## Files\n- src/lib/stores/polling.svelte.ts\n- src/lib/stores/polling.test.ts\n\n## References\n- INTEGRATION_PLAN: Multi-tier Polling section","status":"open","priority":1,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-13T00:32:13.684368+05:30","created_by":"Avyukth","updated_at":"2026-01-13T00:32:13.684368+05:30","labels":["layer:data","phase:1"]}
{"id":"gu-h30x","title":"CI Workflow: Contract Tests","description":"# CI Workflow: Contract Tests\n\n## Background\nGitHub Actions workflow to run contract tests against real CLI in CI.\n\n## Workflow File\n```yaml\n# .github/workflows/contract-tests.yml\nname: Contract Tests\n\non:\n  push:\n    branches: [main]\n  pull_request:\n    branches: [main]\n\njobs:\n  contract-test:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n      \n      - name: Setup Bun\n        uses: oven-sh/setup-bun@v1\n        \n      - name: Install dependencies\n        run: bun install\n        \n      - name: Install gastown CLI\n        run: |\n          # Install gt and bd from releases\n          curl -sSL https://gastown.io/install.sh | sh\n          \n      - name: Setup test town\n        run: |\n          mkdir -p test-town/.beads\n          echo '{}' \u003e test-town/.beads/config.yaml\n          \n      - name: Run contract tests\n        run: TEST_CLI=true bun test src/lib/types/*.contract.test.ts\n        env:\n          GASTOWN_TOWN_ROOT: ./test-town\n          \n      - name: Upload test results\n        uses: actions/upload-artifact@v3\n        if: failure()\n        with:\n          name: contract-test-results\n          path: test-results/\n```\n\n## What It Tests\n- Zod schemas match actual CLI JSON output\n- Schema shape stability (snapshots)\n- CLI command availability\n\n## Acceptance Criteria\n- [ ] Workflow file exists and is valid\n- [ ] Tests run on push and PR\n- [ ] CLI installed from releases\n- [ ] Test results uploaded on failure\n- [ ] Passing status badge added to README\n\n## Files\n- .github/workflows/contract-tests.yml\n\n## References\n- INTEGRATION_PLAN ¬ßContract Testing with Zod\n- Task: gu-ow2 (Contract tests implementation)","status":"open","priority":1,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-13T00:02:54.572787+05:30","created_by":"Avyukth","updated_at":"2026-01-13T00:02:54.572787+05:30","labels":["layer:testing","phase:1","type:ci"]}
{"id":"gu-hnm","title":"Implement CSP Headers and Security Middleware","description":"# CSP Headers and Security Middleware\n\n## Implementation\n```typescript\n// src/hooks.server.ts\n\nconst CSP_DIRECTIVES = {\n  'default-src': [\"'self'\"],\n  'script-src': [\"'self'\", \"'unsafe-inline'\"],\n  'style-src': [\"'self'\", \"'unsafe-inline'\", 'https://fonts.googleapis.com'],\n  'font-src': [\"'self'\", 'https://fonts.gstatic.com'],\n  'img-src': [\"'self'\", 'data:', 'blob:'],\n  'connect-src': [\"'self'\", 'wss:', 'https:'],\n  'frame-ancestors': [\"'none'\"],\n  'form-action': [\"'self'\"],\n  'base-uri': [\"'self'\"],\n  'object-src': [\"'none'\"],\n};\n\nexport const handle: Handle = async ({ event, resolve }) =\u003e {\n  const response = await resolve(event);\n  \n  const csp = Object.entries(CSP_DIRECTIVES)\n    .map(([key, values]) =\u003e `${key} ${values.join(' ')}`)\n    .join('; ');\n  \n  response.headers.set('Content-Security-Policy', csp);\n  response.headers.set('X-Content-Type-Options', 'nosniff');\n  response.headers.set('X-Frame-Options', 'DENY');\n  response.headers.set('Referrer-Policy', 'strict-origin-when-cross-origin');\n  \n  return response;\n};\n```\n\n## Acceptance Criteria\n- [ ] CSP headers set on all responses\n- [ ] X-Content-Type-Options: nosniff\n- [ ] X-Frame-Options: DENY\n- [ ] Referrer-Policy configured\n- [ ] Unit tests verify headers\n\n## Files\n- src/hooks.server.ts\n\n## References\n- INTEGRATION_PLAN: Content Security Policy section\n\n(Moved from hq-m9x.1)","status":"open","priority":1,"issue_type":"task","estimated_minutes":60,"created_at":"2026-01-12T23:12:55.815353+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:12:55.815353+05:30","labels":["layer:security","phase:1"]}
{"id":"gu-i5j","title":"Implement /api/gastown/health endpoint","description":"# Health Endpoint Implementation\n\n## Background\nExpose `gt doctor --json` results via REST API for system health monitoring.\n\n## Endpoint\n```\nGET /api/gastown/health\n```\n\n## Response Schema\n```typescript\ninterface HealthResponse {\n  status: 'healthy' | 'degraded' | 'unhealthy';\n  checks: HealthCheck[];\n  timestamp: string;\n}\n\ninterface HealthCheck {\n  name: string;\n  status: 'pass' | 'warn' | 'fail';\n  message: string;\n  duration_ms: number;\n}\n```\n\n## Implementation\n- Call `gt doctor --json` via Process Supervisor\n- Transform output to structured response\n- Cache for 30 seconds\n- Handle partial failures gracefully\n\n## Files\n- src/routes/api/gastown/health/+server.ts\n\n## Acceptance Criteria\n- [ ] Returns structured health checks\n- [ ] Includes all gt doctor checks\n- [ ] Caches results for 30s\n- [ ] Handles gt doctor failures gracefully\n- [ ] Returns appropriate HTTP status (200/503)\n\n## References\n- INTEGRATION_PLAN ¬ßPhase 1 Server Routes","status":"open","priority":1,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-12T23:34:24.049406+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:34:24.049406+05:30","labels":["layer:api","phase:1"]}
{"id":"gu-id8","title":"Digest: mol-refinery-patrol","description":"Patrol: MQ empty, no branches to merge","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-12T23:07:38.096333+05:30","updated_at":"2026-01-12T23:07:38.096333+05:30","closed_at":"2026-01-12T23:07:38.096214+05:30","close_reason":"Squashed from 11 wisps","dependencies":[{"issue_id":"gu-id8","depends_on_id":"gu-wisp-ave","type":"parent-child","created_at":"2026-01-12T23:07:38.097016+05:30","created_by":"gastown_ui/refinery"}]}
{"id":"gu-j3j","title":"Unit tests: Process Supervisor","description":"# Unit Tests: Process Supervisor\n\n## Test Cases\n\n### Success Cases\n- [x] Executes command and returns stdout\n- [x] Captures stderr separately\n- [x] Returns exit code\n- [x] Measures execution duration\n- [x] Generates unique requestId\n\n### Timeout Cases\n- [x] Throws TimeoutError after timeout\n- [x] Kills process on timeout\n- [x] Returns partial output on timeout\n- [x] Custom timeout respected\n\n### Cancellation Cases\n- [x] Cancel by requestId works\n- [x] Cancelled process killed\n- [x] Throws CancellationError\n\n### Error Cases\n- [x] Non-zero exit throws ExitError\n- [x] Spawn failure throws SpawnError\n- [x] Invalid command throws appropriate error\n\n### Concurrency Cases\n- [x] Multiple processes run concurrently\n- [x] Each has unique requestId\n\n## Test Setup\n```typescript\nimport { describe, it, expect, vi } from 'vitest';\nimport { ProcessSupervisor } from '../process-supervisor';\n\ndescribe('ProcessSupervisor', () =\u003e {\n  const supervisor = new ProcessSupervisor();\n\n  it('executes command and returns stdout', async () =\u003e {\n    const result = await supervisor.run('echo', ['hello']);\n    expect(result.stdout.trim()).toBe('hello');\n    expect(result.exitCode).toBe(0);\n  });\n\n  it('throws TimeoutError after timeout', async () =\u003e {\n    await expect(\n      supervisor.run('sleep', ['10'], { timeout: 100 })\n    ).rejects.toThrow('timed out');\n  });\n});\n```\n\n## Acceptance Criteria\n- [ ] All test cases pass\n- [ ] Coverage \u003e 90%\n- [ ] Tests run fast (mocked where needed)\n\n## Files\n- src/lib/server/cli/__tests__/process-supervisor.test.ts\n\n## References\n- Task: hq-0qb.1 (Process Supervisor implementation)\n\n(Moved from hq-nbf.1)","status":"open","priority":1,"issue_type":"task","estimated_minutes":90,"created_at":"2026-01-12T23:12:56.533356+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:12:56.533356+05:30","labels":["layer:testing","phase:1","type:unit"]}
{"id":"gu-j7v","title":"Implement Work Items page with filtering","description":"# Work Items Page Implementation\n\n## Background\nThe Work Items page shows all beads (tasks, bugs, epics, etc.) with filtering,\nsorting, and search capabilities.\n\n## Layout\n```\n+--------------------------------------------------+\n| Header: Work Items                    [+ New]     |\n+--------------------------------------------------+\n| Filters: [Type ‚ñº] [Status ‚ñº] [Priority ‚ñº] [Search]|\n+--------------------------------------------------+\n| Work Item List                                    |\n| ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  |\n| ‚îÇ ‚óè BD-123 Implement feature X         P1     ‚îÇ  |\n| ‚îÇ   task ‚Ä¢ open ‚Ä¢ @avyukth                    ‚îÇ  |\n| ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  |\n| ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  |\n| ‚îÇ ‚óè BD-124 Fix login bug               P0     ‚îÇ  |\n| ‚îÇ   bug ‚Ä¢ in_progress ‚Ä¢ @crew                 ‚îÇ  |\n| ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  |\n+--------------------------------------------------+\n```\n\n## Features\n- Filter by type, status, priority, assignee\n- Sort by created, updated, priority\n- Search by title, description\n- Click to expand details\n- Bulk actions (select multiple)\n\n## Platform Variants (AGENTS.md)\n- **Mobile**: Card list, slide-out detail panel\n- **Tablet**: List with inline expansion\n- **Desktop**: Table view option, side panel for details\n\n## Acceptance Criteria\n- [ ] Filters work and persist in URL\n- [ ] Sorting works\n- [ ] Search debounced and responsive\n- [ ] Click expands work item details\n- [ ] Loading skeletons for list\n- [ ] Empty state when no results\n- [ ] Works on all platforms\n\n## Files\n- src/routes/work/+page.svelte\n- src/routes/work/+page.server.ts\n- src/lib/components/WorkItemCard.svelte\n- src/lib/components/WorkItemDetail.svelte\n\n## References\n- INTEGRATION_PLAN: CUJ-2 Work Item Lifecycle\n\n(Moved from hq-wbe.7)","status":"open","priority":1,"issue_type":"task","estimated_minutes":240,"created_at":"2026-01-12T23:12:56.631616+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:12:56.631616+05:30","labels":["layer:ui","phase:1"]}
{"id":"gu-jip","title":"Implement list virtualization for long data sets","description":"# List Virtualization\n\n## Background\nLong lists cause rendering performance issues. Virtualize lists that\nexceed threshold counts.\n\n## Thresholds\n```typescript\nexport const VIRTUALIZATION_THRESHOLDS = {\n  agentList: 50,\n  mailInbox: 100,\n  workItems: 200,\n  activityFeed: 500,\n};\n```\n\n## Implementation\nUse svelte-virtual-list or similar:\n```svelte\n\u003cscript\u003e\n  import VirtualList from 'svelte-virtual-list';\n\u003c/script\u003e\n\n\u003cVirtualList items={data} let:item\u003e\n  \u003cItemComponent {item} /\u003e\n\u003c/VirtualList\u003e\n```\n\n## Acceptance Criteria\n- [ ] Lists virtualized above thresholds\n- [ ] Smooth scrolling maintained\n- [ ] Keyboard navigation works with virtual list\n- [ ] Memory usage stays bounded\n\n## Files\n- src/lib/components/VirtualList.svelte (wrapper)\n- Integration in list components\n\n## References\n- INTEGRATION_PLAN: Rendering Performance section\n\n(Moved from hq-iri.1)","status":"open","priority":2,"issue_type":"task","estimated_minutes":90,"created_at":"2026-01-12T23:13:25.546101+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:13:25.546101+05:30","labels":["layer:perf-a11y","phase:1"]}
{"id":"gu-jybe","title":"Create API documentation","description":"# API Documentation\n\n## Background\nDocument all /api/gastown/* endpoints with request/response examples.\n\n## Content\nFor each endpoint:\n- Method and path\n- Query parameters\n- Request body (if applicable)\n- Response schema\n- Error responses\n- Example request/response\n\n## Acceptance Criteria\n- [ ] All endpoints documented\n- [ ] Examples are accurate\n- [ ] Error codes explained\n\n## Files\n- docs/API.md\n\n## References\n- Epic: hq-0er (API Routes)\n\n(Moved from hq-1cj.2)","status":"open","priority":2,"issue_type":"task","estimated_minutes":120,"created_at":"2026-01-12T23:13:26.263599+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:13:26.263599+05:30","labels":["layer:docs","phase:1"]}
{"id":"gu-jyg","title":"Refinery Patrol","description":"Merge queue processor patrol loop with verification gates.","status":"open","priority":2,"issue_type":"molecule","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-12T19:41:20.390885+05:30","created_by":"Avyukth","updated_at":"2026-01-12T19:41:20.390885+05:30"}
{"id":"gu-kvvy","title":"Smoke tests: CUJ-6 Keyboard Navigation","description":"# Smoke Tests: CUJ-6 Keyboard Navigation\n\n## Background\nManual verification checklist for keyboard navigation with automated helper script for logging test results.\n\n## Test Helper Script\n```typescript\n// scripts/smoke/cuj-6-keyboard.ts\n\nimport { createTestLogger, type TestLogger } from \"../lib/logger\";\n\n/**\n * CUJ-6 Keyboard Navigation Test Runner\n * \n * This script provides a structured way to log manual keyboard test results.\n * Run in browser console or via Playwright for automated keyboard simulation.\n */\n\nconst logger = createTestLogger(\"CUJ-6: Keyboard Navigation\");\n\ninterface KeyboardTestResult {\n  test: string;\n  passed: boolean;\n  notes?: string;\n}\n\nconst tests: KeyboardTestResult[] = [];\n\nexport function logTest(name: string, passed: boolean, notes?: string) {\n  logger.step(`Testing: ${name}`);\n  if (passed) {\n    logger.success(`‚úì ${name}`);\n  } else {\n    logger.error(`‚úó ${name}${notes ? `: ${notes}` : \"\"}`);\n  }\n  tests.push({ test: name, passed, notes });\n}\n\nexport function runKeyboardTests() {\n  logger.banner(\"CUJ-6: KEYBOARD NAVIGATION TESTS\");\n  \n  // Help Overlay Tests\n  logger.step(\"Section 1: Help Overlay\");\n  logTest(\"Press ? opens help overlay\", true);\n  logTest(\"Press Escape closes help overlay\", true);\n  \n  // Navigation Tests\n  logger.step(\"Section 2: Navigation (g+key)\");\n  logTest(\"g+d navigates to dashboard\", true);\n  logTest(\"g+r navigates to rigs\", true);\n  logTest(\"g+w navigates to work\", true);\n  logTest(\"g+m navigates to mail\", true);\n  \n  // List Navigation Tests\n  logger.step(\"Section 3: List Navigation\");\n  logTest(\"j selects next item\", true);\n  logTest(\"k selects previous item\", true);\n  logTest(\"Enter opens selected item\", true);\n  \n  // Search Tests\n  logger.step(\"Section 4: Search\");\n  logTest(\"/ focuses search input\", true);\n  logTest(\"Escape closes search\", true);\n  \n  // Command Palette Tests\n  logger.step(\"Section 5: Command Palette\");\n  logTest(\"Cmd+K opens command palette\", true);\n  logTest(\"Typing filters results\", true);\n  logTest(\"Escape closes palette\", true);\n  \n  // Print summary\n  const passed = tests.filter(t =\u003e t.passed).length;\n  const total = tests.length;\n  logger.summary(\"CUJ-6\", passed === total, 0, total);\n  \n  return tests;\n}\n\n// For Playwright automation\nexport async function automatedKeyboardTests(page: any) {\n  logger.banner(\"CUJ-6: AUTOMATED KEYBOARD TESTS (Playwright)\");\n  \n  // Test help overlay\n  logger.step(\"1. Testing help overlay (? key)\");\n  await page.keyboard.press(\"?\");\n  const helpVisible = await page.locator(\"[data-testid=keyboard-help]\").isVisible();\n  logTest(\"? opens help overlay\", helpVisible);\n  \n  if (helpVisible) {\n    await page.keyboard.press(\"Escape\");\n    const helpClosed = \\!(await page.locator(\"[data-testid=keyboard-help]\").isVisible());\n    logTest(\"Escape closes help overlay\", helpClosed);\n  }\n  \n  // Test command palette\n  logger.step(\"2. Testing command palette (Cmd+K)\");\n  await page.keyboard.press(\"Meta+k\");\n  const paletteVisible = await page.locator(\"[data-testid=command-palette]\").isVisible();\n  logTest(\"Cmd+K opens command palette\", paletteVisible);\n  \n  if (paletteVisible) {\n    await page.keyboard.type(\"dashboard\");\n    await page.keyboard.press(\"Escape\");\n    const paletteClosed = \\!(await page.locator(\"[data-testid=command-palette]\").isVisible());\n    logTest(\"Escape closes command palette\", paletteClosed);\n  }\n  \n  // Test navigation shortcuts\n  logger.step(\"3. Testing navigation (g+key)\");\n  await page.keyboard.press(\"g\");\n  await page.keyboard.press(\"d\");\n  const onDashboard = page.url().includes(\"/dashboard\");\n  logTest(\"g+d navigates to dashboard\", onDashboard);\n  \n  // Test search focus\n  logger.step(\"4. Testing search focus (/)\");\n  await page.keyboard.press(\"/\");\n  const searchFocused = await page.locator(\"[data-testid=global-search]\").isFocused();\n  logTest(\"/ focuses search input\", searchFocused);\n  \n  return tests;\n}\n```\n\n## Manual Verification Checklist\n\n### Section 1: Help Overlay\n- [ ] Press `?` anywhere ‚Üí Help overlay appears\n- [ ] Press `Escape` ‚Üí Overlay closes\n- [ ] Verify all shortcuts documented match actual behavior\n\n### Section 2: Navigation (g+key)\n| Shortcut | Expected | Verified |\n|----------|----------|----------|\n| `g` then `d` | Navigate to dashboard | [ ] |\n| `g` then `r` | Navigate to rigs | [ ] |\n| `g` then `w` | Navigate to work | [ ] |\n| `g` then `m` | Navigate to mail | [ ] |\n| `g` then `a` | Navigate to agents | [ ] |\n\n### Section 3: List Navigation\n| Shortcut | Expected | Verified |\n|----------|----------|----------|\n| `j` | Select next item | [ ] |\n| `k` | Select previous item | [ ] |\n| `Enter` | Open selected item | [ ] |\n| `Escape` | Deselect/close | [ ] |\n\n### Section 4: Search\n| Shortcut | Expected | Verified |\n|----------|----------|----------|\n| `/` | Focus search input | [ ] |\n| Type query | Results filter live | [ ] |\n| `Enter` | Navigate to result | [ ] |\n| `Escape` | Close search | [ ] |\n\n### Section 5: Command Palette\n| Shortcut | Expected | Verified |\n|----------|----------|----------|\n| `Cmd+K` / `Ctrl+K` | Open command palette | [ ] |\n| Type | Filter commands | [ ] |\n| Arrow keys | Navigate results | [ ] |\n| `Enter` | Execute command | [ ] |\n| `Escape` | Close palette | [ ] |\n\n### Section 6: Accessibility\n- [ ] All shortcuts have visual focus indicators\n- [ ] Tab order is logical\n- [ ] Screen reader announces shortcuts\n- [ ] No keyboard traps\n\n## Test Logging Utilities\nUses shared logger from `scripts/lib/logger.ts` (see gu-335i)","status":"open","priority":1,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-12T23:59:24.356766+05:30","created_by":"Avyukth","updated_at":"2026-01-13T01:34:08.185265+05:30","labels":["layer:testing","phase:1","type:smoke"]}
{"id":"gu-l0uq","title":"Unit tests: Circuit Breaker","description":"# Unit Tests: Circuit Breaker\n\n## CRITICAL: Detailed Logging Requirements\nAll unit tests MUST provide comprehensive logging:\n\n```typescript\nimport { createTestLogger } from \"../lib/logger\";\nconst logger = createTestLogger(\"Unit: Circuit Breaker\");\n```\n\n## Test Cases\n\n### State Transitions\n```typescript\ndescribe(\"CircuitBreaker State Transitions\", () =\u003e {\n  it(\"starts in CLOSED state\", () =\u003e {\n    logger.info(\"Creating new circuit breaker\");\n    const cb = new CircuitBreaker({ threshold: 3, timeout: 1000 });\n    logger.info(\"Initial state\", { state: cb.state });\n    expect(cb.state).toBe(\"CLOSED\");\n    logger.success(\"Starts in CLOSED state\");\n  });\n\n  it(\"opens after threshold failures\", async () =\u003e {\n    logger.info(\"Testing failure threshold\");\n    const cb = new CircuitBreaker({ threshold: 3, timeout: 1000 });\n    \n    for (let i = 0; i \u003c 3; i++) {\n      logger.info(`Recording failure ${i + 1}/3`);\n      await cb.execute(() =\u003e Promise.reject(new Error(\"fail\")));\n    }\n    \n    logger.info(\"State after 3 failures\", { state: cb.state });\n    expect(cb.state).toBe(\"OPEN\");\n    logger.success(\"Circuit opened after threshold failures\");\n  });\n});\n```\n\n### Test Checklist\n\n#### State Transitions\n- [ ] Starts in CLOSED state\n- [ ] Opens after threshold failures\n- [ ] Half-opens after timeout\n- [ ] Closes on successful probe\n\n#### Failure Tracking\n- [ ] Counts consecutive failures\n- [ ] Resets count on success\n- [ ] Threshold is configurable\n\n#### Open State Behavior\n- [ ] Rejects requests immediately when open\n- [ ] Returns CircuitOpenError with retry info\n- [ ] Allows probe request after timeout\n\n## State Machine\n```\nCLOSED ‚Üí (failure threshold) ‚Üí OPEN\nOPEN ‚Üí (timeout) ‚Üí HALF_OPEN\nHALF_OPEN ‚Üí (success) ‚Üí CLOSED\nHALF_OPEN ‚Üí (failure) ‚Üí OPEN\n```\n\n## Files\n- src/lib/stores/__tests__/circuit-breaker.test.ts\n\n## Dependencies\n- gu-335i (shared test logging utilities)","status":"open","priority":1,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-12T23:47:11.628717+05:30","created_by":"Avyukth","updated_at":"2026-01-13T01:35:53.734339+05:30","labels":["layer:testing","phase:1","type:unit"]}
{"id":"gu-l2t","title":"Implement /api/gastown/feed/stream SSE endpoint","description":"# SSE Activity Stream Implementation\n\n## Background\nServer-Sent Events (SSE) endpoint for real-time activity updates. The frontend\nsubscribes to this stream to receive push notifications for changes.\n\n## Why SSE over WebSocket?\n- SSE is simpler (one-way communication)\n- Native browser support (EventSource)\n- Automatic reconnection\n- Works through proxies\n- Sufficient for our use case (server ‚Üí client only)\n\n## Event Types\n```typescript\ntype EventType =\n  | 'work_changed'      // Work item created/updated/deleted\n  | 'convoy_changed'    // Convoy created/updated\n  | 'agent_status'      // Agent started/stopped/idle\n  | 'mail_received'     // New mail message\n  | 'queue_changed'     // Merge queue updated\n  | 'operation_update'  // Long-running operation progress\n  | 'heartbeat';        // Keep-alive (every 30s)\n```\n\n## Implementation\n```typescript\n// src/routes/api/gastown/feed/stream/+server.ts\n\nimport { produce } from 'sveltekit-sse';\n\nexport function GET() {\n  return produce(async function start({ emit }) {\n    // Subscribe to beads watcher events\n    const unsubscribe = beadsWatcher.subscribe((event) =\u003e {\n      emit('message', JSON.stringify({\n        type: event.type,\n        data: event.data,\n        timestamp: Date.now()\n      }));\n    });\n    \n    // Send heartbeat every 30s\n    const heartbeatInterval = setInterval(() =\u003e {\n      emit('message', JSON.stringify({ type: 'heartbeat' }));\n    }, 30000);\n    \n    // Cleanup on disconnect\n    return () =\u003e {\n      unsubscribe();\n      clearInterval(heartbeatInterval);\n    };\n  });\n}\n```\n\n## Client Usage\n```typescript\nconst eventSource = new EventSource('/api/gastown/feed/stream');\n\neventSource.onmessage = (event) =\u003e {\n  const data = JSON.parse(event.data);\n  switch (data.type) {\n    case 'work_changed':\n      workStore.invalidate();\n      break;\n    // ...\n  }\n};\n\neventSource.onerror = () =\u003e {\n  // EventSource auto-reconnects\n  showDegradedBanner();\n};\n```\n\n## Acceptance Criteria\n- [ ] SSE endpoint streams events\n- [ ] Heartbeat every 30s\n- [ ] Auto-reconnection works\n- [ ] Cleanup on disconnect\n- [ ] All event types documented\n- [ ] Integration test verifies stream\n\n## Files\n- src/routes/api/gastown/feed/stream/+server.ts\n- src/lib/stores/sse.ts (client subscription)\n- src/routes/api/gastown/feed/stream/__tests__/server.test.ts\n\n## References\n- INTEGRATION_PLAN D2.3: SSE vs WebSocket for Updates\n- npm: sveltekit-sse\n\n(Moved from hq-0er.9)","status":"open","priority":1,"issue_type":"task","estimated_minutes":120,"created_at":"2026-01-12T23:12:57.340215+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:12:57.340215+05:30","labels":["layer:api","phase:1","priority:critical"]}
{"id":"gu-m4z","title":"Implement Effect.ts CLI Execution Layer with typed errors","description":"# Effect.ts CLI Execution Layer\n\n## Background (from INTEGRATION_PLAN v4.0 Innovation #6)\nReplace Promise-based CLI execution with Effect.ts for typed errors,\nbuilt-in retry, circuit breaker, and streaming.\n\n## Why Effect.ts?\n- Compile-time error tracking (know what can fail)\n- Built-in retry with exponential backoff\n- Circuit breaker per command family prevents hammering\n- Dependency injection for testability\n- Composable operations\n\n## Implementation Requirements\n\n### Installation\n```bash\nbun add effect @effect/schema\n```\n\n### Typed Error Hierarchy\n```typescript\n// src/lib/server/cli/effect-errors.ts\n\nimport { Data } from 'effect';\n\nexport class CLIError extends Data.TaggedError('CLIError')\u003c{\n  command: string;\n  exitCode: number;\n  stderr: string;\n  requestId: string;\n}\u003e {}\n\nexport class ParseError extends Data.TaggedError('ParseError')\u003c{\n  message: string;\n  raw: string;\n  requestId: string;\n}\u003e {}\n\nexport class TimeoutError extends Data.TaggedError('TimeoutError')\u003c{\n  command: string;\n  timeout: number;\n  requestId: string;\n}\u003e {}\n\nexport class CircuitOpenError extends Data.TaggedError('CircuitOpenError')\u003c{\n  command: string;\n  openSince: Date;\n  requestId: string;\n}\u003e {}\n\nexport class SchemaError extends Data.TaggedError('SchemaError')\u003c{\n  command: string;\n  issues: z.ZodIssue[];\n  requestId: string;\n}\u003e {}\n```\n\n### Effect Wrappers\n```typescript\n// src/lib/server/cli/effect-cli.ts\n\nimport { Effect, Schedule, pipe } from 'effect';\n\nexport const execGt = (args: string[]) =\u003e\n  pipe(\n    runProcessEffect('gt', args),\n    Effect.retry(\n      Schedule.exponential('100 millis').pipe(\n        Schedule.jittered,\n        Schedule.compose(Schedule.recurs(3))\n      )\n    ),\n    Effect.withCircuitBreaker(gtCircuitBreaker),\n    Effect.timeout('30 seconds'),\n    Effect.tapError(logCliError)\n  );\n```\n\n### Circuit Breaker\n```typescript\nconst circuitBreakerConfig = {\n  failureThreshold: 5,    // Open after 5 failures\n  successThreshold: 2,    // Close after 2 successes in half-open\n  halfOpenTimeout: 30000  // Try again after 30s\n};\n```\n\n## Acceptance Criteria\n- [ ] Effect.ts installed and configured\n- [ ] All CLI errors have typed representations\n- [ ] Circuit breaker opens after 5 failures\n- [ ] Circuit breaker closes after 30s timeout\n- [ ] Retry policy with exponential backoff\n- [ ] All CLI calls go through Effect layer\n- [ ] Comprehensive unit tests for all error types\n\n## Files\n- src/lib/server/cli/effect-errors.ts\n- src/lib/server/cli/effect-cli.ts\n- src/lib/server/cli/effect-circuit-breaker.ts\n- src/lib/server/cli/__tests__/effect-cli.test.ts\n\n## References\n- INTEGRATION_PLAN: Effect.ts CLI Execution Layer section\n- Effect.ts docs: https://effect.website\n\n(Moved from hq-0qb.8)","status":"open","priority":1,"issue_type":"task","estimated_minutes":180,"created_at":"2026-01-12T23:12:56.023739+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:12:56.023739+05:30","labels":["layer:foundation","phase:1","priority:critical"]}
{"id":"gu-m5o","title":"Implement Circuit Breaker for CLI failures","description":"# Circuit Breaker Implementation\n\n## Background\nWhen CLI commands fail repeatedly, continuing to call them wastes resources and\ndelays error responses. A circuit breaker \"trips\" after N failures, failing fast\nuntil the circuit resets.\n\n## Why This Matters\n- Prevents cascading failures\n- Fast fails when CLI is down\n- Auto-recovery when CLI comes back\n- Better UX (fast error vs hanging)\n\n## Implementation Requirements\n\n### States\n```\nCLOSED ‚Üí (N failures) ‚Üí OPEN ‚Üí (timeout) ‚Üí HALF_OPEN ‚Üí (success) ‚Üí CLOSED\n                                         ‚Üí (failure) ‚Üí OPEN\n```\n\n### Core API\n```typescript\ninterface CircuitBreaker\u003cT\u003e {\n  call(fn: () =\u003e Promise\u003cT\u003e): Promise\u003cT\u003e;\n  getState(): 'closed' | 'open' | 'half_open';\n  getStats(): CircuitStats;\n  reset(): void;\n}\n\ninterface CircuitStats {\n  state: 'closed' | 'open' | 'half_open';\n  failures: number;\n  successes: number;\n  lastFailure?: Date;\n  lastSuccess?: Date;\n}\n```\n\n### Configuration\n```typescript\ninterface CircuitConfig {\n  failureThreshold: number;   // Failures before open (default 5)\n  successThreshold: number;   // Successes to close (default 2)\n  timeout: number;            // Time before half-open (default 30s)\n}\n```\n\n### Per-Command Breakers\n- Each CLI command has its own circuit breaker\n- gt mail inbox might be open (known bug)\n- gt status might be closed (working fine)\n\n## Acceptance Criteria\n- [ ] Three states: closed, open, half_open\n- [ ] Opens after N consecutive failures\n- [ ] Auto-transitions to half_open after timeout\n- [ ] Closes after N successes in half_open\n- [ ] Per-command breakers supported\n- [ ] Stats exposed for monitoring\n- [ ] Unit tests cover all state transitions\n\n## Files\n- src/lib/server/cli/circuit-breaker.ts\n- src/lib/server/cli/__tests__/circuit-breaker.test.ts\n\n## References\n- INTEGRATION_PLAN D2.4: Effect.ts Error Handling\n- Pattern: Martin Fowler's Circuit Breaker\n\n(Moved from hq-0qb.4)","status":"open","priority":1,"issue_type":"task","estimated_minutes":90,"created_at":"2026-01-12T23:12:58.772468+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:12:58.772468+05:30","labels":["layer:foundation","phase:1"]}
{"id":"gu-mao","title":"Implement /api/gastown/operations endpoints","description":"# Operations Endpoints\n\nImplements the `/api/gastown/operations` routes for the Operation Center.\n\n## Routes\n\n### GET /api/gastown/operations\nList all operations with filtering.\n\n### GET /api/gastown/operations/[id]\nGet single operation details.\n\n### POST /api/gastown/operations/[id]/cancel\nCancel an in-progress operation.\n\n## Implementation\n\n```typescript\n// src/routes/api/gastown/operations/+server.ts\nexport const GET: RequestHandler = async ({ url }) =\u003e {\n  const status = url.searchParams.get(\"status\");\n  const type = url.searchParams.get(\"type\");\n  \n  // Filter from operations store\n  const operations = await operationsStore.list({ status, type });\n  \n  return json({\n    data: operations,\n    meta: { count: operations.length }\n  });\n};\n\n// src/routes/api/gastown/operations/[id]/+server.ts\nexport const GET: RequestHandler = async ({ params }) =\u003e {\n  const op = await operationsStore.get(params.id);\n  if (!op) throw error(404, \"Operation not found\");\n  return json({ data: op });\n};\n\n// src/routes/api/gastown/operations/[id]/cancel/+server.ts\nexport const POST: RequestHandler = async ({ params }) =\u003e {\n  const result = await operationsStore.cancel(params.id);\n  if (!result.success) {\n    throw error(400, result.error);\n  }\n  return json({ data: { cancelled: true, id: params.id } });\n};\n```\n\n## Schema\n\n```typescript\nexport const OperationSchema = z.object({\n  id: z.string().uuid(),\n  type: z.enum([\"fetch\", \"rebase\", \"merge\", \"test\", \"deploy\"]),\n  status: z.enum([\"pending\", \"running\", \"completed\", \"failed\", \"cancelled\"]),\n  startedAt: z.string().datetime(),\n  completedAt: z.string().datetime().nullable(),\n  progress: z.number().min(0).max(100),\n  error: z.string().nullable(),\n  metadata: z.record(z.unknown()).optional()\n});\n```\n\n## Tests\n\n- Unit: CRUD operations, status transitions\n- Integration: Cancel flow, concurrent operations\n\n\n(Moved from hq-0nu)","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-12T23:12:54.377536+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:12:54.377536+05:30","labels":["layer:api","phase:1"]}
{"id":"gu-mri","title":"Implement POST /api/gastown/rigs for rig add","description":"# Rig Add Endpoint (Long-Running Operation)\n\n## Background\nAdd a new rig via `gt rig add`. This is a LONG-RUNNING operation (30-150 seconds for git clone).\n\n## Endpoint\n```\nPOST /api/gastown/rigs\nContent-Type: application/json\n\n{\n  \"name\": \"my-rig\",\n  \"url\": \"https://github.com/org/repo\"\n}\n```\n\n## Critical: Non-Blocking Pattern\n1. Validate input (Zod schema)\n2. Start operation via Operations Store\n3. Return 202 Accepted with operation ID\n4. Background: Execute `gt rig add {name} {url}`\n5. Stream logs to Operation Center\n6. On complete: Invalidate rigs SWR cache\n\n## Response (Immediate)\n```json\n{\n  \"status\": \"accepted\",\n  \"operationId\": \"op-abc123\",\n  \"message\": \"Adding rig...\"\n}\n```\n\n## Implementation\n- Use Operations Store for tracking\n- Stream stdout/stderr to Operation Center\n- Timeout: 5 minutes\n- Cancellable via operationId\n\n## Acceptance Criteria\n- [ ] Returns 202 Accepted immediately\n- [ ] Operation tracked in Operations Store\n- [ ] Logs stream to Operation Center\n- [ ] Timeout after 5 minutes\n- [ ] Invalidates rigs cache on success\n- [ ] Handles clone failures gracefully\n\n## Files\n- src/routes/api/gastown/rigs/+server.ts (POST handler)\n\n## References\n- INTEGRATION_PLAN CUJ-1: Rig Management\n- INTEGRATION_PLAN ¬ßLong-Running Operations","status":"open","priority":1,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-12T23:36:33.518566+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:36:33.518566+05:30","labels":["layer:api","phase:1","priority:critical"]}
{"id":"gu-nba","title":"Implement /api/gastown/rigs/[name] detail endpoint","description":"# Rig Detail Endpoint\n\n## Background\nRetrieve individual rig details by name.\n\n## Endpoint\n```\nGET /api/gastown/rigs/{name}\n```\n\n## Implementation\n- Call `gt rig show {name} --json` via Process Supervisor\n- Return detailed rig info including agents, branches, status\n- Handle not found (404)\n\n## Response Schema\n```typescript\ninterface RigDetail {\n  name: string;\n  path: string;\n  status: 'active' | 'parked' | 'error';\n  agents: Array\u003c{ name: string; status: string }\u003e;\n  branches: string[];\n  lastActivity: string;\n}\n```\n\n## Acceptance Criteria\n- [ ] Returns rig details by name\n- [ ] Includes agent list for rig\n- [ ] Returns 404 for unknown rig\n- [ ] Uses Process Supervisor (no exec)\n\n## Files\n- src/routes/api/gastown/rigs/[name]/+server.ts\n\n## References\n- INTEGRATION_PLAN ¬ßServer Routes (rigs)","status":"open","priority":1,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-12T23:36:33.241716+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:36:33.241716+05:30","labels":["layer:api","phase:1"]}
{"id":"gu-njo4","title":"Implement Convoys page","description":"# Convoys Page Implementation\n\n## Background\nThe Convoys page shows batched work groups with progress visualization\nand the ability to drill down into contained items.\n\n## Features\n- Convoy list with progress bars\n- Expand to see contained items\n- Progress calculated from item statuses\n- Create new convoy (Phase 2)\n\n## Acceptance Criteria\n- [ ] Lists convoys with progress\n- [ ] Expandable to show items\n- [ ] Links to individual work items\n- [ ] Loading skeletons\n- [ ] Empty state\n\n## Files\n- src/routes/convoys/+page.svelte\n- src/lib/components/ConvoyCard.svelte\n\n## References\n- INTEGRATION_PLAN: Convoy views\n\n(Moved from hq-wbe.8)","status":"open","priority":2,"issue_type":"task","estimated_minutes":120,"created_at":"2026-01-12T23:13:26.877968+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:13:26.877968+05:30","labels":["layer:ui","phase:1"]}
{"id":"gu-opvu","title":"Smoke tests: CUJ-1 Rig Management","description":"# Smoke Tests: CUJ-1 Rig Management\n\n## Background\nAutomated smoke test script that validates the Rig Management user journey via API calls.\n\n## CRITICAL: Detailed Logging Requirements\nAll smoke tests MUST provide comprehensive logging for debugging:\n\n```typescript\nconst logger = {\n  step: (name: string) =\u003e console.log(`\\n${'='.repeat(60)}\\n[STEP] ${name}\\n${'='.repeat(60)}`),\n  info: (msg: string, data?: unknown) =\u003e console.log(`[INFO] ${msg}`, data ? JSON.stringify(data, null, 2) : ''),\n  success: (msg: string) =\u003e console.log(`[SUCCESS] ‚úì ${msg}`),\n  fail: (msg: string, error?: unknown) =\u003e console.error(`[FAIL] ‚úó ${msg}`, error),\n  timing: (name: string, ms: number) =\u003e console.log(`[TIMING] ${name}: ${ms}ms`),\n  request: (method: string, url: string, body?: unknown) =\u003e {\n    console.log(`[REQUEST] ${method} ${url}`);\n    if (body) console.log(`[REQUEST BODY]`, JSON.stringify(body, null, 2));\n  },\n  response: (status: number, body: unknown) =\u003e {\n    console.log(`[RESPONSE] Status: ${status}`);\n    console.log(`[RESPONSE BODY]`, JSON.stringify(body, null, 2));\n  }\n};\n```\n\n## Test Script\n```typescript\n// scripts/smoke/cuj-1-rig-management.ts\n\nimport { expect, test } from 'bun:test';\n\nconst BASE_URL = process.env.BASE_URL || 'http://localhost:3000';\n\ntest('CUJ-1: Add Rig Flow', async () =\u003e {\n  const startTime = Date.now();\n  \n  // 1. Get current rigs list\n  logger.step('1. Get current rigs list');\n  logger.request('GET', `${BASE_URL}/api/gastown/rigs`);\n  \n  const before = await fetch(`${BASE_URL}/api/gastown/rigs`);\n  const rigsBefore = await before.json();\n  \n  logger.response(before.status, rigsBefore);\n  expect(before.ok).toBe(true);\n  logger.success(`Found ${rigsBefore.length} existing rigs`);\n  logger.timing('Step 1', Date.now() - startTime);\n  \n  // 2. Add new rig\n  logger.step('2. Add new rig via POST');\n  const payload = {\n    name: 'smoke-test-rig',\n    url: 'https://github.com/example/smoke-test'\n  };\n  logger.request('POST', `${BASE_URL}/api/gastown/rigs`, payload);\n  \n  const addStart = Date.now();\n  const addRes = await fetch(`${BASE_URL}/api/gastown/rigs`, {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify(payload)\n  });\n  const addBody = await addRes.json();\n  \n  logger.response(addRes.status, addBody);\n  expect(addRes.status).toBe(202);\n  logger.success(`Received operation ID: ${addBody.operationId}`);\n  logger.timing('Step 2', Date.now() - addStart);\n  \n  // 3. Poll operation status\n  logger.step('3. Poll operation status');\n  let status = 'running';\n  let pollCount = 0;\n  const maxPolls = 36; // 3 minutes max\n  \n  while (status === 'running' \u0026\u0026 pollCount \u003c maxPolls) {\n    pollCount++;\n    logger.info(`Poll attempt ${pollCount}/${maxPolls}`);\n    await Bun.sleep(5000);\n    \n    const opRes = await fetch(`${BASE_URL}/api/gastown/operations/${addBody.operationId}`);\n    const op = await opRes.json();\n    logger.response(opRes.status, op);\n    status = op.status;\n    \n    if (status === 'running') {\n      logger.info(`Still running... (${op.progress || 'unknown'}% complete)`);\n    }\n  }\n  \n  expect(status).toBe('completed');\n  logger.success(`Operation completed after ${pollCount} polls`);\n  \n  // 4. Verify rig appears\n  logger.step('4. Verify rig appears in list');\n  const after = await fetch(`${BASE_URL}/api/gastown/rigs`);\n  const rigsAfter = await after.json();\n  \n  logger.response(after.status, rigsAfter);\n  expect(rigsAfter.length).toBeGreaterThan(rigsBefore.length);\n  \n  const newRig = rigsAfter.find((r: any) =\u003e r.name === 'smoke-test-rig');\n  expect(newRig).toBeDefined();\n  logger.success(`Found new rig: ${newRig.name}`);\n  logger.info('New rig details:', newRig);\n  \n  // Summary\n  logger.step('TEST SUMMARY');\n  logger.success(`CUJ-1 passed in ${Date.now() - startTime}ms`);\n  logger.info('Steps completed: 4/4');\n});\n```\n\n## Manual Verification Checklist\n- [ ] Navigate to /rigs\n- [ ] Click \"Add Rig\" button\n- [ ] Enter rig name and URL\n- [ ] Verify modal closes immediately\n- [ ] Verify toast \"Adding rig...\" appears\n- [ ] Verify rig status changes to active\n\n## Run Command\n```bash\nbun run scripts/smoke/cuj-1-rig-management.ts\n```\n\n## Acceptance Criteria\n- [ ] Script runs without errors\n- [ ] Validates add rig flow\n- [ ] Handles operation polling\n- [ ] **DETAILED LOGGING**: Every step logs request/response\n- [ ] **TIMING**: Each step logs duration\n- [ ] **VISUAL OUTPUT**: Clear step banners and success markers\n- [ ] **ERROR CONTEXT**: Failures include full response body\n\n## Files\n- scripts/smoke/cuj-1-rig-management.ts\n- scripts/smoke/lib/logger.ts (shared logging utilities)\n\n## References\n- INTEGRATION_PLAN CUJ-1: Rig Management\n- Manual Verification Checklist CUJ-1","status":"open","priority":1,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-12T23:56:22.018649+05:30","created_by":"Avyukth","updated_at":"2026-01-13T00:59:11.661198+05:30","labels":["layer:testing","phase:1","type:smoke"]}
{"id":"gu-ow2","title":"Create contract tests with golden fixtures","description":"# Contract Tests with Golden Fixtures\n\n## Background\nStore real CLI output as golden fixtures. Contract tests verify\nZod schemas match actual CLI output.\n\n## Golden Fixtures\n```\nsrc/lib/test/fixtures/\n‚îú‚îÄ‚îÄ gt-status.json\n‚îú‚îÄ‚îÄ gt-status-fast.json\n‚îú‚îÄ‚îÄ bd-list.json\n‚îú‚îÄ‚îÄ bd-list-message.json\n‚îú‚îÄ‚îÄ gt-convoy-list.json\n‚îú‚îÄ‚îÄ gt-mq-list.json\n‚îú‚îÄ‚îÄ gt-rig-list.json\n‚îú‚îÄ‚îÄ gt-doctor.json\n‚îî‚îÄ‚îÄ events.jsonl\n```\n\n## Contract Test Helper\n```typescript\n// src/lib/test/contract-helper.ts\n\nimport { describe, it, expect } from 'vitest';\nimport { z } from 'zod';\nimport { readFileSync } from 'fs';\n\nexport function testCLIContract\u003cT\u003e(\n  name: string,\n  fixturePath: string,\n  schema: z.ZodType\u003cT\u003e\n) {\n  describe(\\`Contract: \\${name}\\`, () =\u003e {\n    it('validates fixture against schema', () =\u003e {\n      const fixture = JSON.parse(\n        readFileSync(fixturePath, 'utf-8')\n      );\n      const result = schema.safeParse(fixture);\n      \n      if (!result.success) {\n        console.error('Schema validation errors:', result.error.issues);\n      }\n      \n      expect(result.success).toBe(true);\n    });\n    \n    it('fixture matches current CLI output', async () =\u003e {\n      // Optional: run CLI and compare\n      // This validates fixtures stay up-to-date\n    });\n  });\n}\n```\n\n## Usage\n```typescript\n// src/lib/types/__tests__/contracts.test.ts\n\nimport { testCLIContract } from '$lib/test/contract-helper';\nimport { GtStatusSchema, BdBeadSchema } from '$lib/types/gastown.schema';\n\ntestCLIContract(\n  'gt status --json',\n  'src/lib/test/fixtures/gt-status.json',\n  GtStatusSchema\n);\n\ntestCLIContract(\n  'bd list --json',\n  'src/lib/test/fixtures/bd-list.json',\n  z.array(BdBeadSchema)\n);\n```\n\n## Fixture Generation Script\n```bash\n# scripts/generate-fixtures.sh\ngt status --json \u003e src/lib/test/fixtures/gt-status.json\nbd list --json \u003e src/lib/test/fixtures/bd-list.json\n# etc.\n```\n\n## Acceptance Criteria\n- [ ] Golden fixtures for all CLI outputs\n- [ ] Contract test helper function\n- [ ] Tests for all Zod schemas\n- [ ] Fixture generation script\n- [ ] CI fails on schema drift\n- [ ] Clear error messages on mismatch\n\n## Files\n- src/lib/test/fixtures/*.json\n- src/lib/test/contract-helper.ts\n- src/lib/types/__tests__/contracts.test.ts\n- scripts/generate-fixtures.sh\n\n## References\n- INTEGRATION_PLAN: Contract Testing with Zod section\n\n(Moved from hq-nbf.10)","status":"open","priority":1,"issue_type":"task","estimated_minutes":120,"created_at":"2026-01-12T23:12:54.789095+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:12:54.789095+05:30","labels":["layer:testing","phase:1","priority:critical"]}
{"id":"gu-p1o","title":"Unit tests: Concurrency Limiter","description":"# Unit Tests: Concurrency Limiter\n\n## CRITICAL: Detailed Logging Requirements\nAll unit tests MUST provide comprehensive logging:\n\n```typescript\nimport { createTestLogger } from \"../lib/logger\";\nconst logger = createTestLogger(\"Unit: Concurrency Limiter\");\n```\n\n## Test Cases\n\n### Queue Behavior\n```typescript\ndescribe(\"ConcurrencyLimiter\", () =\u003e {\n  it(\"limits concurrent executions\", async () =\u003e {\n    logger.step(\"Testing concurrency limit\");\n    const limiter = new ConcurrencyLimiter(2);\n    let running = 0;\n    let maxRunning = 0;\n    \n    const tasks = Array(5).fill(null).map(async (_, i) =\u003e {\n      logger.info(`Task ${i} starting`);\n      running++;\n      maxRunning = Math.max(maxRunning, running);\n      await delay(100);\n      running--;\n      logger.info(`Task ${i} completed`);\n    });\n    \n    await Promise.all(tasks.map(t =\u003e limiter.run(t)));\n    \n    logger.info(\"Max concurrent executions\", { maxRunning });\n    expect(maxRunning).toBe(2);\n    logger.success(\"Concurrency limit enforced\");\n  });\n});\n```\n\n### Test Checklist\n- [ ] Limits concurrent executions\n- [ ] Queues excess tasks\n- [ ] Executes queued tasks when slot opens\n- [ ] Handles task failures gracefully\n- [ ] Priority queue ordering (if supported)\n\n## Files\n- src/lib/stores/__tests__/concurrency-limiter.test.ts\n\n## Dependencies\n- gu-335i (shared test logging utilities)","status":"open","priority":1,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-12T23:47:08.847283+05:30","created_by":"Avyukth","updated_at":"2026-01-13T01:36:07.679665+05:30","labels":["layer:testing","phase:1","type:unit"]}
{"id":"gu-ph3","title":"[P1] Data Layer: SWR Caching \u0026 Reactive Stores","description":"# Phase 1 Data Layer\n\n## Background\nThe data layer provides instant perceived performance through SWR (Stale-While-Revalidate)\ncaching and reactive Svelte 5 stores. This is critical for UX - users expect sub-100ms\nresponses even when CLI commands take 500ms+.\n\n## Key Innovations (from INTEGRATION_PLAN v5.0)\n1. **SWR Pattern (D0.4)**: Serve stale data instantly, revalidate in background\n2. **Watch-First Updates (D0.7)**: File watchers for .beads/ directory\n3. **Reactive Stores**: Svelte 5 runes ($state, $derived) for reactivity\n\n## Why This Matters\n- CLI commands are slow (500ms-2s typical)\n- Users expect instant feedback\n- SWR gives perceived instant response while keeping data fresh\n- File watchers enable near-real-time updates without polling\n\n## Acceptance Criteria\n- [ ] SWR cache implemented with configurable TTLs\n- [ ] All stores use Svelte 5 runes ($state, $derived)\n- [ ] File watcher monitors .beads/ directory\n- [ ] Invalidation cascades correctly (work change ‚Üí convoy refresh)\n- [ ] Cache hit rate \u003e 80% in steady state\n- [ ] Background revalidation doesn't block UI\n\n## Architecture Decision References\n- D0.4: SWR Stale-While-Revalidate Caching\n- D0.7: Watch-First Updates\n- D2.2: Cache Invalidation Strategy\n\n## Dependencies\n- EPIC: Foundation Layer (hq-0qb)\n\n## Files to Create/Modify\n- src/lib/stores/swr.ts\n- src/lib/stores/work.svelte.ts\n- src/lib/stores/convoys.svelte.ts\n- src/lib/stores/agents.svelte.ts\n- src/lib/stores/mail.svelte.ts\n- src/lib/stores/operations.svelte.ts\n- src/lib/server/watch/beads-watcher.ts\n\n(Moved from hq-bpb)","status":"open","priority":1,"issue_type":"epic","created_at":"2026-01-12T23:11:31.977266+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:11:31.977266+05:30","labels":["critical:yes","layer:data","phase:1"]}
{"id":"gu-pod","title":"Phase 1 Foundation Sprint","description":"# Phase 1 Foundation Sprint\n\nCritical path work for the foundation layer. Must complete before data/API layers.\n\n## Scope\n- Process Supervisor\n- Concurrency Limiter\n- Capabilities Probe\n- Circuit Breaker\n- Zod Contracts\n- Error Hierarchy\n\n## Dependencies\nNone - this is the first convoy.\n\n## Exit Criteria\nAll foundation components implemented and unit tested.\n\n(Moved from hq-ve0)","status":"open","priority":1,"issue_type":"convoy","created_at":"2026-01-12T23:11:40.337099+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:11:40.337099+05:30","labels":["phase:1","sprint:foundation"],"dependencies":[{"issue_id":"gu-pod","depends_on_id":"gu-9t4","type":"blocks","created_at":"2026-01-12T23:22:53.268286+05:30","created_by":"Avyukth"},{"issue_id":"gu-pod","depends_on_id":"gu-2en","type":"blocks","created_at":"2026-01-12T23:22:53.344268+05:30","created_by":"Avyukth"},{"issue_id":"gu-pod","depends_on_id":"gu-731","type":"blocks","created_at":"2026-01-12T23:22:53.414177+05:30","created_by":"Avyukth"},{"issue_id":"gu-pod","depends_on_id":"gu-m5o","type":"blocks","created_at":"2026-01-12T23:22:53.484216+05:30","created_by":"Avyukth"},{"issue_id":"gu-pod","depends_on_id":"gu-dze","type":"blocks","created_at":"2026-01-12T23:22:53.555404+05:30","created_by":"Avyukth"},{"issue_id":"gu-pod","depends_on_id":"gu-d5z","type":"blocks","created_at":"2026-01-12T23:22:53.625101+05:30","created_by":"Avyukth"},{"issue_id":"gu-pod","depends_on_id":"gu-m4z","type":"blocks","created_at":"2026-01-12T23:22:53.694928+05:30","created_by":"Avyukth"},{"issue_id":"gu-pod","depends_on_id":"gu-ded","type":"blocks","created_at":"2026-01-12T23:22:53.764466+05:30","created_by":"Avyukth"},{"issue_id":"gu-pod","depends_on_id":"gu-36k","type":"blocks","created_at":"2026-01-13T00:03:45.239836+05:30","created_by":"Avyukth"},{"issue_id":"gu-pod","depends_on_id":"gu-tb9","type":"blocks","created_at":"2026-01-13T00:03:45.350568+05:30","created_by":"Avyukth"},{"issue_id":"gu-pod","depends_on_id":"gu-18h","type":"blocks","created_at":"2026-01-13T00:03:45.460848+05:30","created_by":"Avyukth"},{"issue_id":"gu-pod","depends_on_id":"gu-eb9","type":"blocks","created_at":"2026-01-13T00:03:45.573583+05:30","created_by":"Avyukth"},{"issue_id":"gu-pod","depends_on_id":"gu-v8gw","type":"blocks","created_at":"2026-01-13T00:37:28.3196+05:30","created_by":"Avyukth"},{"issue_id":"gu-pod","depends_on_id":"gu-034d","type":"blocks","created_at":"2026-01-13T01:05:01.211599+05:30","created_by":"Avyukth"}]}
{"id":"gu-qaoj","title":"Create CUJ verification checklists","description":"# CUJ Verification Checklists\n\n## Background\nManual verification checklists for Critical User Journeys. Since we don't use\nPlaywright (repo posture), these are manual QA guides.\n\n## CUJ-1: Rig Management\n- [ ] Open Rigs page\n- [ ] See list of rigs with agent counts\n- [ ] Expand rig to see details\n- [ ] Agent status indicators correct\n\n## CUJ-2: Work Item Lifecycle\n- [ ] Open Work Items page\n- [ ] Filter by type, status, priority\n- [ ] Search by title\n- [ ] Click item to see details\n- [ ] Details panel shows all fields\n\n## CUJ-3: Sling (Orchestration)\n- [ ] View pending work items\n- [ ] See available agents\n- [ ] (Phase 2: Sling work to agent)\n\n## CUJ-4: System Monitoring\n- [ ] Dashboard shows agent status\n- [ ] Recent activity feed updates\n- [ ] Health indicators accurate\n- [ ] Degraded mode banner on disconnect\n\n## CUJ-5: Mail View\n- [ ] Open Mail page\n- [ ] See inbox with unread indicators\n- [ ] Click message to view\n- [ ] Message content renders\n\n## Platform Matrix\nRun each CUJ on:\n- [ ] Mobile (360√ó800)\n- [ ] Tablet (768√ó1024)\n- [ ] Desktop (1440√ó900)\n\n## Acceptance Criteria\n- [ ] All CUJs documented\n- [ ] Platform matrix defined\n- [ ] Checklist usable for QA\n\n## Files\n- docs/CUJ_VERIFICATION.md\n\n## References\n- INTEGRATION_PLAN: Manual Verification Checklists\n\n(Moved from hq-nbf.5)","status":"open","priority":2,"issue_type":"task","estimated_minutes":120,"created_at":"2026-01-12T23:13:26.469112+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:13:26.469112+05:30","labels":["layer:testing","phase:1","type:manual"]}
{"id":"gu-qwqq","title":"Unit tests: Known Bug Detection","description":"# Unit Tests: Known Bug Detection\n\n## CRITICAL: Detailed Logging Requirements\nAll unit tests MUST provide comprehensive logging:\n\n```typescript\nimport { createTestLogger } from \"../lib/logger\";\nconst logger = createTestLogger(\"Unit: Known Bug Detection\");\n```\n\n## Test Cases\n\n### Error Matching\n```typescript\ndescribe(\"Known Bug Detection\", () =\u003e {\n  it(\"identifies known error patterns\", () =\u003e {\n    logger.step(\"Testing known error pattern matching\");\n    \n    const error = new Error(\"gt mail inbox: command not found\");\n    logger.info(\"Testing error\", { message: error.message });\n    \n    const result = knownBugs.match(error);\n    logger.info(\"Match result\", result);\n    \n    expect(result.isKnown).toBe(true);\n    expect(result.bug.id).toBe(\"mail-inbox-command\");\n    logger.success(\"Known bug detected correctly\");\n  });\n\n  it(\"returns null for unknown errors\", () =\u003e {\n    logger.step(\"Testing unknown error handling\");\n    \n    const error = new Error(\"some random error\");\n    const result = knownBugs.match(error);\n    logger.info(\"Match result\", result);\n    \n    expect(result.isKnown).toBe(false);\n    logger.success(\"Unknown error correctly identified\");\n  });\n});\n```\n\n### Test Checklist\n- [ ] Identifies known error patterns\n- [ ] Returns null for unknown errors\n- [ ] Provides workaround suggestions\n- [ ] Tracks bug registry version\n- [ ] Supports regex patterns\n\n## Files\n- src/lib/stores/__tests__/known-bugs.test.ts\n\n## Dependencies\n- gu-335i (shared test logging utilities)","status":"open","priority":1,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-12T23:49:54.812285+05:30","created_by":"Avyukth","updated_at":"2026-01-13T01:36:27.344749+05:30","labels":["layer:testing","phase:1","type:unit"]}
{"id":"gu-r2pm","title":"Unit tests: Activity Stream (SSE Client)","description":"# Unit Tests: Activity Stream (SSE Client)\n\n## CRITICAL: Detailed Logging Requirements\nAll unit tests MUST provide comprehensive logging:\n\n```typescript\nimport { createTestLogger } from \"../lib/logger\";\nconst logger = createTestLogger(\"Unit: Activity Stream SSE\");\n```\n\n## Test Cases\n\n### SSE Connection\n```typescript\ndescribe(\"Activity Stream SSE Client\", () =\u003e {\n  it(\"connects to SSE endpoint\", async () =\u003e {\n    logger.step(\"Testing SSE connection\");\n    \n    const client = new ActivityStream(\"/api/gastown/feed/stream\");\n    logger.info(\"Connecting to SSE endpoint\");\n    \n    await client.connect();\n    logger.info(\"Connection state\", { connected: client.isConnected });\n    \n    expect(client.isConnected).toBe(true);\n    logger.success(\"SSE connection established\");\n  });\n\n  it(\"parses incoming events\", async () =\u003e {\n    logger.step(\"Testing event parsing\");\n    \n    const events: StreamEvent[] = [];\n    client.on(\"event\", (e) =\u003e {\n      logger.info(\"Received event\", e);\n      events.push(e);\n    });\n    \n    // Simulate event\n    mockServer.emit(\"data: {\\\"type\\\":\\\"rig_added\\\",\\\"data\\\":{}}\");\n    \n    expect(events[0].type).toBe(\"rig_added\");\n    logger.success(\"Event parsed correctly\");\n  });\n});\n```\n\n### Test Checklist\n- [ ] Connects to SSE endpoint\n- [ ] Parses incoming events\n- [ ] Handles reconnection on disconnect\n- [ ] Exponential backoff on failures\n- [ ] Dispatches events to listeners\n\n## Files\n- src/lib/stores/__tests__/activity-stream.test.ts\n\n## Dependencies\n- gu-335i (shared test logging utilities)","status":"open","priority":1,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-12T23:49:55.142311+05:30","created_by":"Avyukth","updated_at":"2026-01-13T01:36:27.842427+05:30","labels":["layer:testing","phase:1","type:unit"]}
{"id":"gu-r30","title":"Implement /api/gastown/agents endpoint","description":"# Agents Endpoint Implementation\n\n## Background\nReturns agent list with their current status. Agents include Mayor, Witnesses,\nRefineries, and Polecats.\n\n## CLI Command\nParsed from gt status --agents output.\n\n## Expected Response\n```json\n{\n  \"agents\": [\n    {\n      \"name\": \"mayor\",\n      \"type\": \"mayor\",\n      \"status\": \"running\",\n      \"rig\": null,\n      \"last_heartbeat\": \"2026-01-12T10:00:00Z\"\n    },\n    {\n      \"name\": \"gastown_ui/witness\",\n      \"type\": \"witness\",\n      \"status\": \"idle\",\n      \"rig\": \"gastown_ui\",\n      \"last_heartbeat\": \"2026-01-12T09:59:00Z\"\n    }\n  ],\n  \"timestamp\": \"2026-01-12T10:00:00Z\"\n}\n```\n\n## Acceptance Criteria\n- [ ] Returns agent list JSON\n- [ ] Includes status and last heartbeat\n- [ ] Uses SWR cache with 10s stale time\n- [ ] Validates response with Zod contract\n- [ ] Unit test with mocked CLI\n\n## Files\n- src/routes/api/gastown/agents/+server.ts\n- src/routes/api/gastown/agents/__tests__/server.test.ts\n\n## References\n- INTEGRATION_PLAN: Agents Endpoint section\n- CLI: gt status --agents\n\n(Moved from hq-0er.7)","status":"open","priority":1,"issue_type":"task","estimated_minutes":45,"created_at":"2026-01-12T23:12:57.538075+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:12:57.538075+05:30","labels":["layer:api","phase:1"]}
{"id":"gu-rig-gastown_ui","title":"gastown_ui","description":"Rig identity bead for gastown_ui.\n\nrepo: https://github.com/Avyukth/gastown_ui\nprefix: gu\nstate: active","status":"open","priority":2,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-12T19:41:20.525017+05:30","created_by":"Avyukth","updated_at":"2026-01-12T19:41:20.525017+05:30","labels":["gt:rig"]}
{"id":"gu-ru7","title":"Implement /api/gastown/mail endpoint (with gt mail inbox workaround)","description":"# Mail Endpoint Implementation\n\n## Background\nReturns mail messages. IMPORTANT: gt mail inbox hangs in Node.js due to a known\nbug. Use bd list --type=message as workaround.\n\n## Known Bug (Critical)\n```\ngt mail inbox --json  ‚Üê HANGS in Node.js environment\nbd list --type=message --json  ‚Üê WORKAROUND (use this)\n```\n\nThe gt mail inbox command hangs when run from Node.js child_process. This is a\nknown issue documented in INTEGRATION_PLAN. Always use bd list as the primary\ndata source for mail.\n\n## CLI Command (Workaround)\n```bash\nbd list --type=message --json\n```\n\n## Expected Response\n```json\n{\n  \"messages\": [\n    {\n      \"id\": \"msg-123\",\n      \"from\": \"mayor\",\n      \"to\": \"gastown_ui/witness\",\n      \"subject\": \"Work assigned\",\n      \"body\": \"Please review PR #42\",\n      \"read\": false,\n      \"created_at\": \"2026-01-12T10:00:00Z\"\n    }\n  ],\n  \"unread_count\": 5,\n  \"timestamp\": \"2026-01-12T10:00:00Z\"\n}\n```\n\n## Implementation\n```typescript\n// src/routes/api/gastown/mail/+server.ts\n\nexport async function GET({ request }) {\n  const requestId = request.headers.get('x-request-id') || crypto.randomUUID();\n  \n  // WORKAROUND: Use bd list instead of gt mail inbox\n  // gt mail inbox hangs in Node.js\n  const result = await processSupervisor.run(\n    'bd',\n    ['list', '--type=message', '--json'],\n    { timeout: 10000, requestId }\n  );\n  \n  // ... parse and return\n}\n```\n\n## Acceptance Criteria\n- [ ] Uses bd list workaround, NOT gt mail inbox\n- [ ] Returns messages JSON\n- [ ] Includes unread count\n- [ ] Uses SWR cache with 5s stale time\n- [ ] Documents the workaround in code comments\n- [ ] Unit test with mocked CLI\n\n## Files\n- src/routes/api/gastown/mail/+server.ts\n- src/routes/api/gastown/mail/__tests__/server.test.ts\n\n## References\n- INTEGRATION_PLAN: Known Bug - gt mail inbox hangs\n- CLI: bd list --type=message --json\n\n(Moved from hq-0er.4)","status":"open","priority":1,"issue_type":"task","estimated_minutes":60,"created_at":"2026-01-12T23:12:57.841437+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:12:57.841437+05:30","labels":["known-bug","layer:api","phase:1"]}
{"id":"gu-s1u","title":"Phase 1 Security Hardening Sprint","description":"# Phase 1 Security Hardening Sprint\n\nSecurity-focused work including CSP headers, input validation, and rate limiting.\n\n## Scope\n- CSP Headers and Security Middleware\n- Input Validation with Zod schemas\n- Rate Limiting for write operations\n\n## Dependencies\nDepends on Foundation layer (Process Supervisor, Zod Contracts).\n\n## Exit Criteria\n- All security middleware in place\n- Input validation on all API routes\n- Rate limiting active on write endpoints\n- Security audit passes\n\n\n(Moved from hq-4om)","status":"open","priority":1,"issue_type":"convoy","created_at":"2026-01-12T23:11:40.919606+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:11:40.919606+05:30","labels":["phase:1","sprint:security"],"dependencies":[{"issue_id":"gu-s1u","depends_on_id":"gu-hnm","type":"blocks","created_at":"2026-01-12T23:23:35.782431+05:30","created_by":"Avyukth"},{"issue_id":"gu-s1u","depends_on_id":"gu-amx","type":"blocks","created_at":"2026-01-12T23:23:35.900783+05:30","created_by":"Avyukth"},{"issue_id":"gu-s1u","depends_on_id":"gu-5ze","type":"blocks","created_at":"2026-01-12T23:23:36.005792+05:30","created_by":"Avyukth"},{"issue_id":"gu-s1u","depends_on_id":"gu-pod","type":"blocks","created_at":"2026-01-12T23:25:18.419713+05:30","created_by":"Avyukth"}]}
{"id":"gu-s7zr","title":"Performance tests: Bundle size budget","description":"# Performance Tests: Bundle Size Budget\n\n## Background\nPrevent bundle size regression by enforcing size budgets in CI.\n\n## Bundle Size Budgets\n| Bundle | Max Size | Current |\n|--------|----------|---------|\n| JS (initial) | 150KB | TBD |\n| CSS | 30KB | TBD |\n| Total | 200KB | TBD |\n\n## Test Script\n```typescript\n// scripts/check-bundle-size.ts\nimport { readdir, stat } from 'fs/promises';\nimport { join } from 'path';\n\nconst BUDGET = {\n  js: 150 * 1024,   // 150KB\n  css: 30 * 1024,   // 30KB\n  total: 200 * 1024 // 200KB\n};\n\nasync function checkBundleSize() {\n  const buildDir = '.svelte-kit/output/client/_app/immutable';\n  \n  let jsSize = 0;\n  let cssSize = 0;\n  \n  const files = await readdir(join(buildDir, 'chunks'));\n  for (const file of files) {\n    const stats = await stat(join(buildDir, 'chunks', file));\n    if (file.endsWith('.js')) jsSize += stats.size;\n    if (file.endsWith('.css')) cssSize += stats.size;\n  }\n  \n  console.log(`JS: ${(jsSize/1024).toFixed(1)}KB / ${BUDGET.js/1024}KB`);\n  console.log(`CSS: ${(cssSize/1024).toFixed(1)}KB / ${BUDGET.css/1024}KB`);\n  \n  if (jsSize \u003e BUDGET.js) {\n    console.error('JS bundle exceeds budget\\!');\n    process.exit(1);\n  }\n  if (cssSize \u003e BUDGET.css) {\n    console.error('CSS bundle exceeds budget\\!');\n    process.exit(1);\n  }\n}\n\ncheckBundleSize();\n```\n\n## CI Integration\n```yaml\n- name: Build\n  run: bun run build\n  \n- name: Check bundle size\n  run: bun run scripts/check-bundle-size.ts\n```\n\n## Acceptance Criteria\n- [ ] Bundle size script works\n- [ ] Budgets defined and realistic\n- [ ] CI fails on budget exceeded\n- [ ] Bundle analysis in PR comments\n\n## Files\n- scripts/check-bundle-size.ts\n\n## References\n- INTEGRATION_PLAN ¬ßPerformance Targets","status":"open","priority":2,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-13T00:03:02.987349+05:30","created_by":"Avyukth","updated_at":"2026-01-13T00:03:02.987349+05:30","labels":["layer:testing","phase:1","type:perf"]}
{"id":"gu-se7","title":"Deacon Patrol","description":"Mayor's daemon patrol loop for handling callbacks, health checks, and cleanup.","status":"open","priority":2,"issue_type":"molecule","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-12T19:41:20.038003+05:30","created_by":"Avyukth","updated_at":"2026-01-12T19:41:20.038003+05:30"}
{"id":"gu-shp7","title":"Smoke tests: CUJ-4 System Monitoring (Dashboard)","description":"# Smoke Tests: CUJ-4 System Monitoring\n\n## Background\nAutomated smoke test script that validates the Dashboard monitoring journey with comprehensive logging for debugging.\n\n## Test Script\n```typescript\n// scripts/smoke/cuj-4-monitoring.ts\n\nimport { expect, test, describe, beforeAll, afterAll } from \"bun:test\";\nimport { createTestLogger, type TestLogger } from \"../lib/logger\";\n\nconst BASE_URL = process.env.BASE_URL || \"http://localhost:3000\";\nlet logger: TestLogger;\nlet testStartTime: number;\n\nbeforeAll(() =\u003e {\n  logger = createTestLogger(\"CUJ-4: System Monitoring\");\n  testStartTime = Date.now();\n  logger.banner(\"CUJ-4: SYSTEM MONITORING SMOKE TESTS\");\n});\n\nafterAll(() =\u003e {\n  const duration = Date.now() - testStartTime;\n  logger.summary(\"CUJ-4\", true, duration, 5);\n});\n\ndescribe(\"CUJ-4: Dashboard Data Flow\", () =\u003e {\n  test(\"Step 1: Fetch system status\", async () =\u003e {\n    const stepStart = Date.now();\n    logger.step(\"1. Fetching system status from /api/gastown/status\");\n    \n    const url = `${BASE_URL}/api/gastown/status`;\n    logger.request(\"GET\", url);\n    \n    const res = await fetch(url);\n    const body = await res.json();\n    \n    logger.response(res.status, body);\n    expect(res.ok).toBe(true);\n    \n    // Validate structure with logging\n    logger.info(\"Validating status response structure...\");\n    expect(body.town).toBeTruthy();\n    logger.info(`  ‚úì town: ${body.town}`);\n    expect(body.daemon).toBeDefined();\n    logger.info(`  ‚úì daemon: ${JSON.stringify(body.daemon)}`);\n    expect(Array.isArray(body.agents)).toBe(true);\n    logger.info(`  ‚úì agents: ${body.agents.length} agents found`);\n    expect(Array.isArray(body.rigs)).toBe(true);\n    logger.info(`  ‚úì rigs: ${body.rigs.length} rigs found`);\n    expect(body.queue).toBeDefined();\n    logger.info(`  ‚úì queue: ${JSON.stringify(body.queue)}`);\n    \n    logger.success(\"Status endpoint validated\");\n    logger.timing(\"Step 1\", Date.now() - stepStart);\n  });\n\n  test(\"Step 2: Fetch convoys list\", async () =\u003e {\n    const stepStart = Date.now();\n    logger.step(\"2. Fetching convoys from /api/gastown/convoys\");\n    \n    const url = `${BASE_URL}/api/gastown/convoys`;\n    logger.request(\"GET\", url);\n    \n    const res = await fetch(url);\n    const convoys = await res.json();\n    \n    logger.response(res.status, convoys);\n    expect(res.ok).toBe(true);\n    expect(Array.isArray(convoys)).toBe(true);\n    \n    logger.info(`Found ${convoys.length} convoys`);\n    for (const convoy of convoys.slice(0, 3)) {\n      logger.info(`  - ${convoy.id}: ${convoy.title || convoy.name}`);\n    }\n    \n    logger.success(\"Convoys endpoint validated\");\n    logger.timing(\"Step 2\", Date.now() - stepStart);\n  });\n\n  test(\"Step 3: Fetch queue status\", async () =\u003e {\n    const stepStart = Date.now();\n    logger.step(\"3. Fetching queue from /api/gastown/queue\");\n    \n    const url = `${BASE_URL}/api/gastown/queue`;\n    logger.request(\"GET\", url);\n    \n    const res = await fetch(url);\n    const queue = await res.json();\n    \n    logger.response(res.status, queue);\n    expect(res.ok).toBe(true);\n    \n    logger.success(\"Queue endpoint validated\");\n    logger.timing(\"Step 3\", Date.now() - stepStart);\n  });\n\n  test(\"Step 4: Test snapshot endpoint (coherent data)\", async () =\u003e {\n    const stepStart = Date.now();\n    logger.step(\"4. Fetching snapshot from /api/gastown/snapshot\");\n    \n    const url = `${BASE_URL}/api/gastown/snapshot`;\n    logger.request(\"GET\", url);\n    \n    const res = await fetch(url);\n    const snapshot = await res.json();\n    \n    logger.response(res.status, snapshot);\n    expect(res.ok).toBe(true);\n    \n    // Validate snapshot contains all required data\n    logger.info(\"Validating snapshot contains coherent data...\");\n    expect(snapshot.status).toBeDefined();\n    logger.info(\"  ‚úì status present\");\n    expect(snapshot.convoys).toBeDefined();\n    logger.info(\"  ‚úì convoys present\");\n    expect(snapshot.queue).toBeDefined();\n    logger.info(\"  ‚úì queue present\");\n    \n    logger.success(\"Snapshot endpoint validated - data is coherent\");\n    logger.timing(\"Step 4\", Date.now() - stepStart);\n  });\n\n  test(\"Step 5: Validate data consistency\", async () =\u003e {\n    const stepStart = Date.now();\n    logger.step(\"5. Validating data consistency across endpoints\");\n    \n    // Fetch both status and snapshot\n    const statusRes = await fetch(`${BASE_URL}/api/gastown/status`);\n    const status = await statusRes.json();\n    \n    const snapshotRes = await fetch(`${BASE_URL}/api/gastown/snapshot`);\n    const snapshot = await snapshotRes.json();\n    \n    // Compare agent counts\n    logger.info(\"Comparing status.agents vs snapshot.status.agents...\");\n    const statusAgentCount = status.agents?.length || 0;\n    const snapshotAgentCount = snapshot.status?.agents?.length || 0;\n    logger.info(`  Status agents: ${statusAgentCount}`);\n    logger.info(`  Snapshot agents: ${snapshotAgentCount}`);\n    \n    logger.success(\"Data consistency validated\");\n    logger.timing(\"Step 5\", Date.now() - stepStart);\n  });\n});\n```\n\n## Manual Verification Checklist\n- [ ] Navigate to /dashboard\n- [ ] Verify status card shows daemon status\n- [ ] Verify agents list populates\n- [ ] Verify rigs list populates\n- [ ] Verify queue section shows pending items\n- [ ] Verify data refreshes on interval\n\n## Test Logging Utilities\nUses shared logger from `scripts/lib/logger.ts` (see gu-335i)","status":"open","priority":1,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-12T23:59:22.856655+05:30","created_by":"Avyukth","updated_at":"2026-01-13T01:33:24.911762+05:30","labels":["layer:testing","phase:1","type:smoke"]}
{"id":"gu-si0h","title":"Implement Queue page (merge queue)","description":"# Queue Page Implementation\n\n## Background\nThe Queue page shows the merge queue - branches waiting to be processed\nby the Refinery agent.\n\n## Features\n- Queue list with positions\n- Branch details\n- Queue processing status\n- Manual queue manipulation (Phase 2)\n\n## Acceptance Criteria\n- [ ] Lists queue items with position\n- [ ] Shows branch and rig info\n- [ ] Status indicators\n- [ ] Loading skeletons\n- [ ] Empty queue state\n\n## Files\n- src/routes/queue/+page.svelte\n- src/lib/components/QueueItem.svelte\n\n## References\n- INTEGRATION_PLAN: Queue Endpoint\n\n(Moved from hq-wbe.11)","status":"open","priority":2,"issue_type":"task","estimated_minutes":90,"created_at":"2026-01-12T23:13:26.569594+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:13:26.569594+05:30","labels":["layer:ui","phase:1"]}
{"id":"gu-sp3","title":"Create MSW handlers for API mocking","description":"# MSW Handlers for API Mocking\n\n## Background\nMock Service Worker (MSW) provides API mocking for component and integration tests.\n\n## Implementation\n```typescript\n// src/lib/test/msw-handlers.ts\n\nimport { http, HttpResponse, delay } from 'msw';\n\nexport const handlers = [\n  // Status endpoint\n  http.get('/api/gastown/status', async () =\u003e {\n    await delay(100);\n    return HttpResponse.json(mockStatus);\n  }),\n\n  // Add rig (long-running)\n  http.post('/api/gastown/rigs', async ({ request }) =\u003e {\n    const body = await request.json();\n    await delay(2000); // Simulate long operation\n    return HttpResponse.json({\n      id: \\`rig-\\${Date.now()}\\`,\n      name: body.name,\n      status: 'active',\n    });\n  }),\n\n  // Create work item\n  http.post('/api/gastown/work/issues', async ({ request }) =\u003e {\n    const body = await request.json();\n    const id = \\`hq-\\${Math.random().toString(36).slice(2, 8)}\\`;\n    return HttpResponse.json({\n      id,\n      title: body.title,\n      status: 'open',\n      priority: body.priority,\n      created_at: new Date().toISOString(),\n    });\n  }),\n\n  // Sling (with random failure)\n  http.post('/api/gastown/work/sling', async ({ request }) =\u003e {\n    const body = await request.json();\n    if (Math.random() \u003c 0.2) {\n      return HttpResponse.json({\n        error: {\n          code: 'KNOWN_BUG',\n          message: 'Sling queued (daemon not running)',\n          recoverable: true,\n        },\n      }, { status: 202 });\n    }\n    return HttpResponse.json({ status: 'slung', target: body.target });\n  }),\n];\n\n// Error scenarios\nexport const errorHandlers = [\n  http.get('/api/gastown/status', () =\u003e {\n    return HttpResponse.json({\n      error: { code: 'CLI_ERROR', message: 'Daemon not running' }\n    }, { status: 500 });\n  }),\n];\n```\n\n## Acceptance Criteria\n- [ ] Handlers for all API endpoints\n- [ ] Error scenario handlers\n- [ ] Realistic delays\n- [ ] Type-safe request/response\n- [ ] Documented usage in tests\n\n## Files\n- src/lib/test/msw-handlers.ts\n- src/lib/test/msw-setup.ts\n- src/lib/test/__tests__/msw.test.ts\n\n## References\n- INTEGRATION_PLAN: MSW Handlers section\n\n(Moved from hq-nbf.6)","status":"closed","priority":1,"issue_type":"task","estimated_minutes":120,"created_at":"2026-01-12T23:12:55.204403+05:30","created_by":"Avyukth","updated_at":"2026-01-13T01:12:30.849251+05:30","closed_at":"2026-01-13T01:12:30.849251+05:30","close_reason":"Duplicate of gu-wgo2 (MSW Handlers)","labels":["layer:testing","phase:1"]}
{"id":"gu-tb9","title":"Remove all execSync from request paths","description":"# Remove execSync from Request Paths\n\n## Background\nexecSync blocks the Node.js event loop, causing all requests to hang during CLI execution. This must be eliminated from all request handlers.\n\n## Why execSync is Bad\n- Blocks entire Node.js process\n- Other requests queue up\n- Can cause timeout cascades\n- Makes server unresponsive\n\n## Where to Check\n1. Server routes: `src/routes/api/`\n2. Server hooks: `src/hooks.server.ts`\n3. Server-side load functions: `+page.server.ts`, `+layout.server.ts`\n\n## Acceptable Uses\n- Build scripts (runs at build time)\n- CLI tools (not part of server)\n- Tests (controlled environment)\n\n## Unacceptable Uses\n- Any code path reachable from HTTP request\n- Server load functions\n- API route handlers\n\n## Verification\n```bash\n# Should return 0 matches in these paths\ngrep -r 'execSync' src/routes/\ngrep -r 'execSync' src/hooks.server.ts\ngrep -r 'execSync' src/lib/server/\n```\n\n## Acceptance Criteria\n- [ ] Zero execSync in routes\n- [ ] Zero execSync in hooks.server.ts\n- [ ] Zero execSync in src/lib/server/\n- [ ] All blocking calls replaced with async Process Supervisor\n\n## References\n- INTEGRATION_PLAN ¬ßImplementation Checklist: Remove all execSync","status":"open","priority":1,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-12T23:44:06.00039+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:44:06.00039+05:30","labels":["layer:foundation","phase:1","priority:critical"]}
{"id":"gu-tlt","title":"Implement Degraded Mode Banner","description":"# Degraded Mode Banner\n\n## Background\nWhen the daemon is unreachable or SSE disconnects, the UI should show\na clear banner indicating degraded mode with stale data.\n\n## Implementation\n```svelte\n\u003c!-- src/lib/components/DegradedModeBanner.svelte --\u003e\n\u003cscript lang=\"ts\"\u003e\n  import { connectionStore } from '$lib/stores/connection';\n  \n  const { isConnected, lastConnected, isReconnecting } = connectionStore;\n\u003c/script\u003e\n\n{#if !$isConnected}\n  \u003cdiv class=\"degraded-banner\" role=\"alert\" aria-live=\"polite\"\u003e\n    \u003cWarningIcon /\u003e\n    \u003cspan\u003e\n      {#if $isReconnecting}\n        Reconnecting to server...\n      {:else}\n        Showing cached data from {formatTimeAgo($lastConnected)}\n      {/if}\n    \u003c/span\u003e\n    \u003cbutton onclick={() =\u003e connectionStore.retry()}\u003e\n      Retry\n    \u003c/button\u003e\n  \u003c/div\u003e\n{/if}\n\n\u003cstyle\u003e\n  .degraded-banner {\n    background: var(--warning-bg);\n    color: var(--warning-text);\n    padding: var(--spacing-2) var(--spacing-4);\n    display: flex;\n    align-items: center;\n    gap: var(--spacing-2);\n    position: sticky;\n    top: 0;\n    z-index: 100;\n  }\n\u003c/style\u003e\n```\n\n## Acceptance Criteria\n- [ ] Banner shows when daemon unreachable\n- [ ] Shows time since last successful connection\n- [ ] Retry button attempts reconnection\n- [ ] Banner dismisses when connection restored\n- [ ] Accessible with aria-live\n\n## Files\n- src/lib/components/DegradedModeBanner.svelte\n- src/lib/stores/connection.svelte.ts\n- src/routes/+layout.svelte (integration)\n\n## References\n- INTEGRATION_PLAN: SWR Pattern - degraded mode\n\n(Moved from hq-wbe.14)","status":"closed","priority":1,"issue_type":"task","estimated_minutes":60,"created_at":"2026-01-12T23:12:55.405987+05:30","created_by":"Avyukth","updated_at":"2026-01-13T01:20:13.782152+05:30","closed_at":"2026-01-13T01:20:13.782152+05:30","close_reason":"Duplicate of gu-83zz (Degraded Mode Banner)","labels":["layer:ui","phase:1"]}
{"id":"gu-txm","title":"Create smoke test scripts for CUJ happy paths","description":"# Smoke Test Scripts\n\n## Background\nSmoke tests exercise CUJ happy paths via API calls without browser automation.\nRun as shell scripts for quick validation.\n\n## Test Scripts\n\n### scripts/smoke-test.ts\n```typescript\n#!/usr/bin/env bun\n\nimport { describe, it, expect } from 'bun:test';\n\nconst BASE_URL = process.env.BASE_URL || 'http://localhost:3000';\n\ndescribe('CUJ-1: Rig Management', async () =\u003e {\n  it('lists rigs', async () =\u003e {\n    const res = await fetch(\\`\\${BASE_URL}/api/gastown/rigs\\`);\n    expect(res.ok).toBe(true);\n    const data = await res.json();\n    expect(Array.isArray(data.rigs || data)).toBe(true);\n  });\n});\n\ndescribe('CUJ-2: Work Item Lifecycle', async () =\u003e {\n  it('lists work items', async () =\u003e {\n    const res = await fetch(\\`\\${BASE_URL}/api/gastown/work\\`);\n    expect(res.ok).toBe(true);\n    const data = await res.json();\n    expect(Array.isArray(data.items || data)).toBe(true);\n  });\n});\n\ndescribe('CUJ-4: System Monitoring', async () =\u003e {\n  it('gets system status', async () =\u003e {\n    const res = await fetch(\\`\\${BASE_URL}/api/gastown/status\\`);\n    expect(res.ok).toBe(true);\n    const data = await res.json();\n    expect(data).toHaveProperty('town');\n  });\n  \n  it('gets snapshot', async () =\u003e {\n    const res = await fetch(\\`\\${BASE_URL}/api/gastown/snapshot\\`);\n    expect(res.ok).toBe(true);\n    const data = await res.json();\n    expect(data).toHaveProperty('status');\n    expect(data).toHaveProperty('freshness');\n  });\n});\n\ndescribe('CUJ-5: Mail View', async () =\u003e {\n  it('lists mail messages', async () =\u003e {\n    const res = await fetch(\\`\\${BASE_URL}/api/gastown/mail\\`);\n    expect(res.ok).toBe(true);\n    const data = await res.json();\n    expect(Array.isArray(data.messages || data)).toBe(true);\n  });\n});\n```\n\n### package.json script\n```json\n{\n  \"scripts\": {\n    \"test:smoke\": \"bun scripts/smoke-test.ts\"\n  }\n}\n```\n\n## Logging Requirements\n- Log each test start/end with timing\n- Log request/response details on failure\n- Generate summary report\n\n## Acceptance Criteria\n- [ ] Scripts for all 5 CUJs\n- [ ] Detailed logging on failures\n- [ ] Summary report generated\n- [ ] Exit code reflects pass/fail\n- [ ] Can run against any environment\n\n## Files\n- scripts/smoke-test.ts\n- scripts/smoke-test-report.ts\n\n## References\n- INTEGRATION_PLAN: Testing Strategy - Smoke tests\n\n(Moved from hq-nbf.9)","status":"open","priority":1,"issue_type":"task","estimated_minutes":120,"created_at":"2026-01-12T23:12:54.896092+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:12:54.896092+05:30","labels":["layer:testing","phase:1"]}
{"id":"gu-u4e","title":"Implement /api/gastown/work/sling POST endpoint","description":"# Sling Work Endpoint\n\nImplements the `/api/gastown/work/sling` POST route for assigning work to agents.\n\n## Implementation\n\n```typescript\n// src/routes/api/gastown/work/sling/+server.ts\nimport { json, error } from \"@sveltejs/kit\";\nimport type { RequestHandler } from \"./$types\";\nimport { executeGT } from \"$lib/server/cli/gt-wrapper\";\nimport { SlingRequestSchema, SlingResponseSchema } from \"$lib/server/cli/schemas\";\n\nexport const POST: RequestHandler = async ({ request, locals }) =\u003e {\n  const body = await request.json();\n  \n  // Validate input\n  const parsed = SlingRequestSchema.safeParse(body);\n  if (!parsed.success) {\n    throw error(400, { message: \"Invalid request\", errors: parsed.error.issues });\n  }\n  \n  const { beadId, agentId, priority } = parsed.data;\n  \n  // Execute sling command\n  const args = [\"sling\", beadId, \"--to\", agentId];\n  if (priority) args.push(\"--priority\", String(priority));\n  \n  const result = await executeGT(args);\n  const validated = SlingResponseSchema.parse(result);\n  \n  return json({\n    data: validated,\n    meta: { timestamp: new Date().toISOString() }\n  }, { status: 201 });\n};\n```\n\n## Schemas\n\n```typescript\nexport const SlingRequestSchema = z.object({\n  beadId: z.string().regex(/^[a-zA-Z0-9_-]{1,64}$/),\n  agentId: z.string().regex(/^[a-zA-Z][a-zA-Z0-9_-]{0,31}$/),\n  priority: z.number().int().min(1).max(4).optional()\n});\n\nexport const SlingResponseSchema = z.object({\n  success: z.boolean(),\n  assignedTo: z.string(),\n  beadId: z.string(),\n  queuePosition: z.number().optional()\n});\n```\n\n## Security\n\n- Requires GASTOWN_ENABLE_WRITES=true\n- Rate limited: 10 req/min per user\n- Input sanitization via Zod schemas\n\n## Tests\n\n- Unit: Schema validation, error handling\n- Integration: E2E sling flow with rollback\n\n\n(Moved from hq-cdu)","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-12T23:12:54.479505+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:12:54.479505+05:30","labels":["layer:api","phase:1"]}
{"id":"gu-u4g1","title":"Implement Mail page","description":"# Mail Page Implementation\n\n## Background\nThe Mail page shows inbox/outbox for Gas Town mail system, enabling\ncommunication between agents and humans.\n\n## Features\n- Inbox view with unread indicators\n- Read/unread toggle\n- Message detail view\n- Compose new message (Phase 2)\n\n## Acceptance Criteria\n- [ ] Lists messages with unread badges\n- [ ] Click to view message\n- [ ] Mark as read works\n- [ ] Loading skeletons\n- [ ] Empty inbox state\n\n## Files\n- src/routes/mail/+page.svelte\n- src/lib/components/MailItem.svelte\n- src/lib/components/MailDetail.svelte\n\n## References\n- INTEGRATION_PLAN: CUJ-5 Mail View\n\n(Moved from hq-wbe.9)","status":"open","priority":2,"issue_type":"task","estimated_minutes":120,"created_at":"2026-01-12T23:13:26.774473+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:13:26.774473+05:30","labels":["layer:ui","phase:1"]}
{"id":"gu-v8gw","title":"Implement Environment Configuration module","description":"# Environment Configuration Module\n\n## Background\nCentralize all environment configuration with validation on startup.\nCritical for deployability and debugging.\n\n## Configuration Interface\n```typescript\ninterface GastownConfig {\n  // Core paths\n  townRoot: string;      // GASTOWN_TOWN_ROOT\n  gastownHome: string;   // GASTOWN_HOME (~/.gastown)\n  bdCwd: string;         // GASTOWN_BD_CWD\n  \n  // CLI binaries\n  gtBin: string;         // GASTOWN_GT_BIN (default: 'gt')\n  bdBin: string;         // GASTOWN_BD_BIN (default: 'bd')\n  \n  // Timeouts (ms)\n  cliTimeout: number;    // Default 30000\n  cloneTimeout: number;  // Default 180000\n  \n  // Polling intervals (ms)\n  pollCritical: number;  // Default 5000 (status, queue)\n  pollStandard: number;  // Default 15000 (convoys, work)\n  pollBackground: number;// Default 60000 (rigs, health)\n  \n  // Cache\n  cacheTTL: number;      // Default 2000\n  \n  // Feature flags\n  enableWrites: boolean; // Default false\n  demoMode: boolean;     // Default true\n  \n  // Computed\n  cliEnv: Record\u003cstring, string\u003e; // Env vars to pass to CLI\n}\n```\n\n## Startup Validation\n```typescript\nfunction validateConfig(config: GastownConfig): ValidationResult {\n  const errors: string[] = [];\n  \n  // Check required binaries\n  if (!which(config.gtBin)) {\n    errors.push(`gt binary not found: ${config.gtBin}`);\n  }\n  if (!which(config.bdBin)) {\n    errors.push(`bd binary not found: ${config.bdBin}`);\n  }\n  \n  // Check paths\n  if (!existsSync(config.townRoot)) {\n    errors.push(`Town root not found: ${config.townRoot}`);\n  }\n  if (!existsSync(join(config.bdCwd, '.beads'))) {\n    errors.push(`Beads directory not found: ${config.bdCwd}/.beads`);\n  }\n  \n  return { valid: errors.length === 0, errors };\n}\n```\n\n## Files\n- src/lib/config/environment.ts\n- src/lib/config/environment.test.ts\n- .env.example\n\n## Acceptance Criteria\n- [ ] All env vars documented\n- [ ] Default values for optional vars\n- [ ] Validation on startup\n- [ ] Clear error messages for missing config\n- [ ] .env.example with all variables\n- [ ] Unit tests for validation logic\n- [ ] Type-safe config access\n\n## References\n- INTEGRATION_PLAN: Environment Configuration section","status":"open","priority":1,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-13T00:32:11.175317+05:30","created_by":"Avyukth","updated_at":"2026-01-13T00:32:11.175317+05:30","labels":["layer:foundation","phase:1","priority:critical"]}
{"id":"gu-ve52","title":"Integration tests: API endpoints with real CLI","description":"# Integration Tests: API Endpoints\n\n## Background\nIntegration tests validate that API endpoints work correctly with the actual\nCLI (not mocked). Run in CI with a test town.\n\n## Test Coverage\n| Endpoint | Test Scenarios |\n|----------|---------------|\n| /status | Returns valid schema, daemon states |\n| /agents | Returns agents from status |\n| /convoys | List and detail views |\n| /work | CRUD operations |\n| /mail | List and detail |\n| /rigs | List, add (with timeout) |\n| /queue | Merge queue state |\n| /health | Doctor integration |\n| /snapshot | Atomic data fetch |\n\n## Test Setup\n```typescript\n// tests/integration/setup.ts\nimport { beforeAll, afterAll } from 'vitest';\nimport { exec } from 'child_process';\nimport { promisify } from 'util';\n\nconst execAsync = promisify(exec);\n\nbeforeAll(async () =\u003e {\n  // Setup test town\n  await execAsync('gt init test-town', { cwd: TEST_DIR });\n  await execAsync('bd init', { cwd: TEST_DIR });\n});\n\nafterAll(async () =\u003e {\n  // Cleanup\n  await execAsync('rm -rf test-town', { cwd: TEST_DIR });\n});\n```\n\n## Test Examples\n```typescript\n// tests/integration/api/status.test.ts\nimport { describe, it, expect } from 'vitest';\nimport { GtStatusSchema } from '$lib/types/gastown.schema';\n\ndescribe('GET /api/gastown/status', () =\u003e {\n  it('returns valid status schema', async () =\u003e {\n    const res = await fetch('http://localhost:3000/api/gastown/status');\n    expect(res.ok).toBe(true);\n    \n    const data = await res.json();\n    const parsed = GtStatusSchema.safeParse(data);\n    expect(parsed.success).toBe(true);\n  });\n  \n  it('includes request ID in response', async () =\u003e {\n    const res = await fetch('http://localhost:3000/api/gastown/status', {\n      headers: { 'X-Request-Id': 'test-123' }\n    });\n    const data = await res.json();\n    expect(data.requestId).toBe('test-123');\n  });\n  \n  it('handles daemon not running', async () =\u003e {\n    // Stop daemon first\n    await execAsync('gt down');\n    \n    const res = await fetch('http://localhost:3000/api/gastown/status');\n    const data = await res.json();\n    \n    expect(data.daemon.running).toBe(false);\n    \n    // Restart daemon\n    await execAsync('gt up');\n  });\n});\n```\n\n## Detailed Logging\nAll integration tests MUST log:\n- Request URL and method\n- Request headers\n- Response status\n- Response body (truncated)\n- Duration\n\n```typescript\nasync function fetchWithLogging(url: string, options = {}) {\n  const start = Date.now();\n  console.log(`[TEST] ${options.method ?? 'GET'} ${url}`);\n  \n  const res = await fetch(url, options);\n  const body = await res.text();\n  const duration = Date.now() - start;\n  \n  console.log(`[TEST] ${res.status} ${res.statusText} (${duration}ms)`);\n  console.log(`[TEST] Body: ${body.slice(0, 500)}`);\n  \n  return { res, body: JSON.parse(body) };\n}\n```\n\n## Acceptance Criteria\n- [ ] Tests run against real CLI\n- [ ] Test town setup/teardown\n- [ ] Schema validation for all responses\n- [ ] Error cases tested\n- [ ] Detailed logging for debugging\n- [ ] Can run in CI\n- [ ] Tests complete in \u003c 60s\n\n## Files\n- tests/integration/setup.ts\n- tests/integration/api/*.test.ts\n- vitest.config.integration.ts\n\n## References\n- INTEGRATION_PLAN: Testing Strategy section","status":"open","priority":1,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-13T00:33:19.975702+05:30","created_by":"Avyukth","updated_at":"2026-01-13T00:33:19.975702+05:30","labels":["layer:testing","phase:1","type:integration"]}
{"id":"gu-vlu","title":"[P1] Performance \u0026 Accessibility: Core Web Vitals, WCAG 2.2 AA","description":"# Performance \u0026 Accessibility\n\n## Performance Targets (from INTEGRATION_PLAN)\n\n### Core Web Vitals\n| Metric | Target | Measurement |\n|--------|--------|-------------|\n| LCP | \u003c 2.5s | Dashboard first meaningful paint |\n| FID | \u003c 100ms | Button click responsiveness |\n| CLS | \u003c 0.1 | No layout jumps on data load |\n| TTFB | \u003c 200ms | Server response time |\n| TTI | \u003c 3.5s | Full interactivity |\n\n### Bundle Size Budgets\n| Chunk | Budget |\n|-------|--------|\n| Initial JS | \u003c 100KB gzipped |\n| Initial CSS | \u003c 30KB gzipped |\n| Vendor chunk | \u003c 80KB gzipped |\n| Total initial | \u003c 200KB gzipped |\n\n### API Response Times\n| Endpoint | Target (P95) |\n|----------|--------------|\n| /api/gastown/status | \u003c 500ms |\n| All cached endpoints | \u003c 50ms |\n\n## Accessibility Requirements (WCAG 2.2 AA)\n\n### Keyboard Navigation\n- All interactive elements focusable\n- Visible focus indicators\n- Tab order logical\n\n### ARIA Patterns\n- Agent Card: role=\"article\"\n- Agent List: role=\"feed\"\n- Modal: role=\"dialog\"\n- Toast: role=\"alert\"\n\n### Color Contrast\n- All text meets 4.5:1 contrast ratio\n- Focus indicators visible\n\n### Motion\n- Respect prefers-reduced-motion\n- No auto-playing animations\n\n## Acceptance Criteria\n- [ ] Core Web Vitals targets met\n- [ ] Bundle size within budgets\n- [ ] WCAG 2.2 AA compliant\n- [ ] Keyboard navigation complete\n- [ ] Screen reader tested\n\n## References\n- INTEGRATION_PLAN: Performance Targets section\n- INTEGRATION_PLAN: Accessibility (WCAG 2.2) section\n\n(Moved from hq-iri)","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-12T23:11:32.863217+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:11:32.863217+05:30","labels":["layer:perf-a11y","phase:1"]}
{"id":"gu-vvad","title":"Create /llms.txt and generator script","description":"# LLM-Friendly Documentation\n\n## Background\nServe /llms.txt and /llms-full.txt for machine-readable context. This helps\nClaude Code and other LLMs work effectively on the codebase.\n\n## Files to Create\n\n### static/llms.txt (Concise Index)\n- Project overview\n- Architecture summary\n- Key files list\n- CLI command reference\n- Known issues\n- Endpoint list\n\n### scripts/generate-llms-txt.ts\n- Collect all markdown docs\n- Generate llms-full.txt with all content\n- Update on docs changes\n\n## CI Integration\nRegenerate on docs/ changes and auto-commit.\n\n## Acceptance Criteria\n- [ ] /llms.txt accessible\n- [ ] /llms-full.txt includes all docs\n- [ ] Generator runs in CI\n- [ ] Updated on docs changes\n\n## Files\n- static/llms.txt\n- static/llms-full.txt\n- scripts/generate-llms-txt.ts\n- .github/workflows/docs.yml\n\n## References\n- INTEGRATION_PLAN D0.9: LLM-Friendly Docs\n\n(Moved from hq-1cj.1)","status":"open","priority":2,"issue_type":"task","estimated_minutes":90,"created_at":"2026-01-12T23:13:26.36692+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:13:26.36692+05:30","labels":["layer:docs","phase:1"]}
{"id":"gu-vyg7","title":"Accessibility tests with axe-core","description":"# Accessibility Tests with axe-core\n\n## Background\nAutomated accessibility testing using axe-core to ensure WCAG 2.2 AA compliance.\n\n## Setup\n```bash\nbun add -D @axe-core/playwright axe-playwright\n```\n\n## Test Approach\nUse Playwright + axe-core for page-level a11y testing.\n\n## Test File\n```typescript\n// tests/a11y/pages.test.ts\nimport { test, expect } from '@playwright/test';\nimport AxeBuilder from '@axe-core/playwright';\n\nconst pages = [\n  { name: 'Dashboard', path: '/' },\n  { name: 'Work Items', path: '/work' },\n  { name: 'Convoys', path: '/convoys' },\n  { name: 'Mail', path: '/mail' },\n  { name: 'Rigs', path: '/rigs' },\n];\n\nfor (const { name, path } of pages) {\n  test.describe(`${name} Page A11y`, () =\u003e {\n    test('should not have detectable a11y violations', async ({ page }) =\u003e {\n      await page.goto(path);\n      \n      const results = await new AxeBuilder({ page })\n        .withTags(['wcag2a', 'wcag2aa', 'wcag21a', 'wcag21aa'])\n        .analyze();\n        \n      expect(results.violations).toEqual([]);\n    });\n  });\n}\n```\n\n## Components to Test\n- All form inputs have labels\n- Color contrast meets AA (4.5:1 for text)\n- Focus indicators visible\n- Keyboard navigation works\n- ARIA attributes correct\n- Headings in logical order\n\n## CI Integration\nAdd to existing Playwright workflow or create dedicated a11y workflow.\n\n## Acceptance Criteria\n- [ ] axe-core installed and configured\n- [ ] All main pages tested\n- [ ] WCAG 2.2 AA violations reported\n- [ ] Tests run in CI on PR\n- [ ] Zero violations before merge\n\n## Files\n- tests/a11y/pages.test.ts\n- playwright.config.ts (add a11y project)\n\n## References\n- INTEGRATION_PLAN ¬ßAccessibility (WCAG 2.2)\n- axe-core docs: https://github.com/dequelabs/axe-core","status":"open","priority":1,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-13T00:02:57.073688+05:30","created_by":"Avyukth","updated_at":"2026-01-13T00:02:57.073688+05:30","labels":["layer:testing","phase:1","type:a11y"]}
{"id":"gu-wfn0","title":"Create Architecture documentation","description":"# Architecture Documentation\n\n## Background\nHigh-level architecture documentation explaining the system design.\n\n## Content\n- System overview diagram\n- Phase 1 CLI Bridge architecture\n- Data flow (SWR, SSE, stores)\n- Key decisions and rationale\n- Component structure\n- File organization\n\n## Acceptance Criteria\n- [ ] Architecture clearly explained\n- [ ] Diagrams included\n- [ ] Rationale documented\n\n## Files\n- docs/ARCHITECTURE.md\n\n## References\n- INTEGRATION_PLAN: Architecture Overview\n\n(Moved from hq-1cj.3)","status":"open","priority":2,"issue_type":"task","estimated_minutes":90,"created_at":"2026-01-12T23:13:26.161528+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:13:26.161528+05:30","labels":["layer:docs","phase:1"]}
{"id":"gu-wgo2","title":"Implement MSW Handlers for API mocking","description":"# MSW Handlers for API Mocking\n\n## Background\nMSW (Mock Service Worker) handlers provide realistic API mocking for component tests without hitting real endpoints.\n\n## Implementation\n```typescript\n// src/lib/test/msw-handlers.ts\n\nimport { http, HttpResponse, delay } from 'msw';\nimport type { GtStatus, GtRig, BdBead } from '$lib/contracts';\n\n// Mock data\nconst mockStatus: GtStatus = {\n  town: 'gastown_exp',\n  rigs: ['gastown_ui'],\n  agents: [],\n  mergeQueue: 0,\n  mailUnread: 2\n};\n\nexport const handlers = [\n  // Status endpoint\n  http.get('/api/gastown/status', async () =\u003e {\n    await delay(100);\n    return HttpResponse.json(mockStatus);\n  }),\n\n  // Snapshot endpoint\n  http.get('/api/gastown/snapshot', async () =\u003e {\n    await delay(150);\n    return HttpResponse.json({\n      status: mockStatus,\n      mailCount: 2,\n      queueCount: 0,\n      recentActivity: [],\n      freshness: {\n        fetchedAt: new Date().toISOString(),\n        ttlMs: 10000\n      }\n    });\n  }),\n\n  // Add rig (async operation)\n  http.post('/api/gastown/rigs', async ({ request }) =\u003e {\n    const body = await request.json() as { name: string; url: string };\n    await delay(2000); // Simulate long operation\n    return HttpResponse.json({\n      operationId: \\`op-\\${Date.now()}\\`,\n      status: 'running'\n    }, { status: 202 });\n  }),\n\n  // Create work item\n  http.post('/api/gastown/work/issues', async ({ request }) =\u003e {\n    const body = await request.json() as { title: string; priority?: number };\n    const id = \\`hq-\\${Math.random().toString(36).slice(2, 8)}\\`;\n    await delay(300);\n    return HttpResponse.json({\n      id,\n      title: body.title,\n      status: 'open',\n      priority: body.priority ?? 2,\n      created_at: new Date().toISOString(),\n    });\n  }),\n\n  // Sling work (with known bug simulation)\n  http.post('/api/gastown/work/sling', async ({ request }) =\u003e {\n    const body = await request.json() as { beadId: string; target: string };\n    await delay(500);\n    \n    // 20% chance of known bug\n    if (Math.random() \u003c 0.2) {\n      return HttpResponse.json({\n        error: {\n          code: 'KNOWN_BUG',\n          message: 'Sling queued (daemon not running)',\n          category: 'KNOWN_BUG',\n          recoverable: true,\n          suggestedAction: 'Run gt start to start the daemon'\n        },\n      }, { status: 202 });\n    }\n    return HttpResponse.json({ status: 'slung', target: body.target });\n  }),\n\n  // List rigs\n  http.get('/api/gastown/rigs', async () =\u003e {\n    await delay(100);\n    return HttpResponse.json([\n      { name: 'gastown_ui', status: 'active', path: '/path/to/gastown_ui' }\n    ]);\n  }),\n\n  // Health check\n  http.get('/api/gastown/health', async () =\u003e {\n    await delay(1000);\n    return HttpResponse.json({\n      healthy: true,\n      checks: {\n        gt: { status: 'ok', version: '1.0.0' },\n        bd: { status: 'ok', version: '1.0.0' }\n      }\n    });\n  })\n];\n\n// Error handlers for testing error states\nexport const errorHandlers = [\n  http.get('/api/gastown/status', () =\u003e {\n    return HttpResponse.json({\n      error: {\n        code: 'CLI_ERROR',\n        message: 'gt command not found',\n        category: 'CLI_ERROR',\n        recoverable: false\n      }\n    }, { status: 500 });\n  }),\n\n  http.post('/api/gastown/rigs', () =\u003e {\n    return HttpResponse.json({\n      error: {\n        code: 'TIMEOUT',\n        message: 'Operation timed out after 180s',\n        category: 'TIMEOUT',\n        recoverable: true,\n        suggestedAction: 'Try again in a moment'\n      }\n    }, { status: 504 });\n  })\n];\n```\n\n## Test Setup\n```typescript\n// src/lib/test/setup.ts\nimport { setupServer } from 'msw/node';\nimport { handlers } from './msw-handlers';\n\nexport const server = setupServer(...handlers);\n\nbeforeAll(() =\u003e server.listen({ onUnhandledRequest: 'error' }));\nafterEach(() =\u003e server.resetHandlers());\nafterAll(() =\u003e server.close());\n```\n\n## Acceptance Criteria\n- [ ] All API endpoints have mock handlers\n- [ ] Realistic delays simulate network latency\n- [ ] Error handlers for testing failure states\n- [ ] Known bug simulation (20% rate)\n- [ ] Setup file configures MSW server\n- [ ] Handlers match Zod contract types\n- [ ] Comprehensive logging in handlers\n\n## Files\n- src/lib/test/msw-handlers.ts\n- src/lib/test/setup.ts\n- src/lib/test/index.ts\n\n## Dependencies\n- msw package installed\n- Zod contracts (gu-dze) must be complete\n\n## References\n- INTEGRATION_PLAN: MSW Handlers section","status":"open","priority":1,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-13T01:01:27.970408+05:30","created_by":"Avyukth","updated_at":"2026-01-13T01:01:27.970408+05:30","labels":["layer:testing","phase:1","type:util"]}
{"id":"gu-wisp-0bk","title":"Mechanical rebase","description":"Pick next branch from queue. Attempt mechanical rebase on current main.\n\n**Step 1: Checkout and attempt rebase**\n```bash\ngit checkout -b temp origin/\u003cpolecat-branch\u003e\ngit rebase origin/main\n```\n\n**Step 2: Check rebase result**\n\nThe rebase exits with:\n- Exit code 0: Success - proceed to run-tests\n- Exit code 1 (conflicts): Conflict detected - proceed to Step 3\n\nTo detect conflict state after rebase fails:\n```bash\n# Check if we're in a conflicted rebase state\nls .git/rebase-merge 2\u003e/dev/null \u0026\u0026 echo \"CONFLICT_STATE\"\n```\n\n**Step 3: Handle conflicts (if any)**\n\nIf rebase SUCCEEDED (exit code 0):\n- Skip to run-tests step (continue normal merge flow)\n\nIf rebase FAILED with conflicts:\n\n1. **Abort the rebase** (DO NOT leave repo in conflicted state):\n```bash\ngit rebase --abort\n```\n\n2. **Record conflict metadata**:\n```bash\n# Capture main SHA for reference\nMAIN_SHA=$(git rev-parse origin/main)\nBRANCH_SHA=$(git rev-parse origin/\u003cpolecat-branch\u003e)\n```\n\n3. **Create conflict-resolution task**:\n```bash\nbd create --type=task --priority=1 --title=\"Resolve merge conflicts: \u003coriginal-issue-title\u003e\" --description=\"## Conflict Resolution Required\n\nOriginal MR: \u003cmr-bead-id\u003e\nBranch: \u003cpolecat-branch\u003e\nOriginal Issue: \u003cissue-id\u003e\nConflict with main at: ${MAIN_SHA}\nBranch SHA: ${BRANCH_SHA}\n\n## Instructions\n1. Clone/checkout the branch\n2. Rebase on current main: git rebase origin/main\n3. Resolve conflicts\n4. Force push: git push -f origin \u003cbranch\u003e\n5. Close this task when done\n\nThe MR will be re-queued for processing after conflicts are resolved.\"\n```\n\n4. **Skip this MR** (do NOT delete branch or close MR bead):\n- Leave branch intact for conflict resolution\n- Leave MR bead open (will be re-processed after resolution)\n- Continue to loop-check for next branch\n\n**CRITICAL**: Never delete a branch that has conflicts. The branch contains\nthe original work and must be preserved for conflict resolution.\n\nTrack: rebase result (success/conflict), conflict task ID if created.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-12T21:14:50.870869+05:30","updated_at":"2026-01-12T21:16:00.980373+05:30","closed_at":"2026-01-12T21:16:00.980373+05:30","close_reason":"Closed","ephemeral":true}
{"id":"gu-wisp-1mt","title":"Check refinery mail","description":"Check mail for MERGE_READY submissions, escalations, and messages.\n\n```bash\ngt mail inbox\n```\n\nFor each message:\n\n**MERGE_READY**:\nA polecat's work is ready for merge. Extract details and track for processing.\n\n```bash\n# Parse MERGE_READY message body:\n# Branch: \u003cbranch\u003e\n# Issue: \u003cissue-id\u003e\n# Polecat: \u003cpolecat-name\u003e\n# MR: \u003cmr-bead-id\u003e\n# Verified: clean git state, issue closed\n\n# Track in your merge queue for this patrol cycle:\n# - Branch name\n# - Issue ID\n# - Polecat name (REQUIRED for MERGED notification)\n# - MR bead ID (REQUIRED for closing after merge)\n```\n\n**IMPORTANT**: You MUST track the polecat name, MR bead ID, AND message ID - you will need them\nin merge-push step to send MERGED notification, close the MR bead, and archive the mail.\n\nMark as read. The work will be processed in queue-scan/process-branch.\n**Do NOT archive yet** - archive after merge/reject decision in merge-push step.\n\n**PATROL: Wake up**:\nWitness detected MRs waiting but refinery idle. Acknowledge and archive:\n```bash\ngt mail archive \u003cmessage-id\u003e\n```\n\n**HELP / Blocked**:\nAssess and respond. If you can't help, escalate to Mayor.\nArchive after handling:\n```bash\ngt mail archive \u003cmessage-id\u003e\n```\n\n**HANDOFF**:\nRead predecessor context. Check for in-flight merges.\nArchive after absorbing context:\n```bash\ngt mail archive \u003cmessage-id\u003e\n```\n\n**Hygiene principle**: Archive messages after they're fully processed.\nKeep only: pending MRs in queue. Inbox should be near-empty.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-12T23:05:40.155683+05:30","updated_at":"2026-01-12T23:05:40.155683+05:30","dependencies":[{"issue_id":"gu-wisp-1mt","depends_on_id":"gu-wisp-aka","type":"parent-child","created_at":"2026-01-12T23:05:40.157769+05:30","created_by":"gastown_ui/refinery"}],"ephemeral":true}
{"id":"gu-wisp-1zi","title":"mol-refinery-patrol","description":"Merge queue processor patrol loop.\n\nThe Refinery is the Engineer in the engine room. You process polecat branches, merging them to main one at a time with sequential rebasing.\n\n**The Scotty Test**: Before proceeding past any failure, ask yourself: \"Would Scotty walk past a warp core leak because it existed before his shift?\"\n\n## Merge Flow\n\nThe Refinery receives MERGE_READY mail from Witnesses when polecats complete work:\n\n```\nWitness                    Refinery                      Git\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ MERGE_READY              ‚îÇ                           ‚îÇ\n   ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ                           ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (verify branch)                   ‚îÇ\n   ‚îÇ                          ‚îÇ fetch \u0026 rebase            ‚îÇ\n   ‚îÇ                          ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (run tests)                       ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (if pass)                         ‚îÇ\n   ‚îÇ                          ‚îÇ merge \u0026 push              ‚îÇ\n   ‚îÇ                          ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ MERGED                   ‚îÇ                           ‚îÇ\n   ‚îÇ\u003c‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ                           ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n```\n\nAfter successful merge, Refinery sends MERGED mail back to Witness so it can\ncomplete cleanup (nuke the polecat worktree).","status":"closed","priority":2,"issue_type":"epic","created_at":"2026-01-12T19:49:38.957606+05:30","updated_at":"2026-01-12T20:01:55.707406+05:30","closed_at":"2026-01-12T20:01:55.707406+05:30","close_reason":"Patrol complete: queue empty, no branches to merge"}
{"id":"gu-wisp-2d7","title":"Check for more work","description":"More branches to process?\n\n**Entry paths:**\n- Normal: After successful merge-push\n- Conflict-skip: After process-branch created conflict-resolution task\n\nIf yes: Return to process-branch with next branch.\nIf no: Continue to generate-summary.\n\n**Track for this cycle:**\n- branches_merged: count and names of successfully merged branches\n- branches_conflict: count and names of branches skipped due to conflicts\n- conflict_tasks: IDs of conflict-resolution tasks created\n\nThis tracking feeds into generate-summary for the patrol digest.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-12T22:40:12.462771+05:30","updated_at":"2026-01-12T22:40:12.462771+05:30","dependencies":[{"issue_id":"gu-wisp-2d7","depends_on_id":"gu-wisp-w9j","type":"parent-child","created_at":"2026-01-12T22:40:12.471102+05:30","created_by":"gastown_ui/refinery"},{"issue_id":"gu-wisp-2d7","depends_on_id":"gu-wisp-2ye","type":"blocks","created_at":"2026-01-12T22:40:12.482031+05:30","created_by":"gastown_ui/refinery"}],"ephemeral":true}
{"id":"gu-wisp-2mu","title":"Scan merge queue","description":"Check the beads merge queue - this is the SOURCE OF TRUTH for pending merges.\n\n```bash\ngit fetch --prune origin\ngt mq list \u003crig\u003e\n```\n\nThe beads MQ tracks all pending merge requests. Do NOT rely on `git branch -r | grep polecat`\nas branches may exist without MR beads, or MR beads may exist for already-merged work.\n\nIf queue empty, skip to context-check step.\n\nFor each MR in the queue, verify the branch still exists:\n```bash\ngit branch -r | grep \u003cbranch\u003e\n```\n\nIf branch doesn't exist for a queued MR:\n- Close the MR bead: `bd close \u003cmr-id\u003e --reason \"Branch no longer exists\"`\n- Remove from processing queue\n\nTrack verified MR list for this cycle.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-12T21:48:25.269714+05:30","updated_at":"2026-01-12T21:48:25.269714+05:30","ephemeral":true}
{"id":"gu-wisp-2ye","title":"Merge and push to main","description":"Merge to main and push. CRITICAL: Notifications come IMMEDIATELY after push.\n\n**Step 1: Merge and Push**\n```bash\ngit checkout main\ngit merge --ff-only temp\ngit push origin main\n```\n\n‚ö†Ô∏è **STOP HERE - DO NOT PROCEED UNTIL STEPS 2-3 COMPLETE**\n\n**Step 2: Send MERGED Notification (REQUIRED - DO THIS IMMEDIATELY)**\n\nRIGHT NOW, before any cleanup, send MERGED mail to Witness:\n\n```bash\ngt mail send \u003crig\u003e/witness -s \"MERGED \u003cpolecat-name\u003e\" -m \"Branch: \u003cbranch\u003e\nIssue: \u003cissue-id\u003e\nMerged-At: $(date -u +%Y-%m-%dT%H:%M:%SZ)\"\n```\n\nThis signals the Witness to nuke the polecat worktree. WITHOUT THIS NOTIFICATION,\nPOLECAT WORKTREES ACCUMULATE INDEFINITELY AND THE LIFECYCLE BREAKS.\n\n**Step 3: Close MR Bead (REQUIRED - DO THIS IMMEDIATELY)**\n\n‚ö†Ô∏è **VERIFICATION BEFORE CLOSING**: Confirm the work is actually on main:\n```bash\n# Get the commit message/issue from the branch\ngit log origin/main --oneline | grep \"\u003cissue-id\u003e\"\n# OR verify the commit SHA is on main:\ngit branch --contains \u003ccommit-sha\u003e | grep main\n```\n\nIf work is NOT on main, DO NOT close the MR bead. Investigate first.\n\n```bash\nbd close \u003cmr-bead-id\u003e --reason \"Merged to main at $(git rev-parse --short HEAD)\"\n```\n\nThe MR bead ID was in the MERGE_READY message or find via:\n```bash\nbd list --type=merge-request --status=open | grep \u003cpolecat-name\u003e\n```\n\n**VALIDATION**: The MR bead's source_issue should be a valid bead ID (gt-xxxxx),\nnot a branch name. If source_issue contains a branch name, flag for investigation.\n\n**Step 4: Archive the MERGE_READY mail (REQUIRED)**\n```bash\ngt mail archive \u003cmerge-ready-message-id\u003e\n```\nThe message ID was tracked when you processed inbox-check.\n\n**Step 5: Cleanup (only after Steps 2-4 confirmed)**\n```bash\ngit branch -d temp\ngit push origin --delete \u003cpolecat-branch\u003e\n```\n\n**VERIFICATION GATE**: You CANNOT proceed to loop-check without:\n- [x] MERGED mail sent to witness\n- [x] MR bead closed\n- [x] MERGE_READY mail archived\n\nIf you skipped notifications or archiving, GO BACK AND DO THEM NOW.\n\nMain has moved. Any remaining branches need rebasing on new baseline.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-12T22:40:12.462581+05:30","updated_at":"2026-01-12T22:40:12.462581+05:30","dependencies":[{"issue_id":"gu-wisp-2ye","depends_on_id":"gu-wisp-w9j","type":"parent-child","created_at":"2026-01-12T22:40:12.470103+05:30","created_by":"gastown_ui/refinery"}],"ephemeral":true}
{"id":"gu-wisp-2z0","title":"Check for more work","description":"More branches to process?\n\n**Entry paths:**\n- Normal: After successful merge-push\n- Conflict-skip: After process-branch created conflict-resolution task\n\nIf yes: Return to process-branch with next branch.\nIf no: Continue to generate-summary.\n\n**Track for this cycle:**\n- branches_merged: count and names of successfully merged branches\n- branches_conflict: count and names of branches skipped due to conflicts\n- conflict_tasks: IDs of conflict-resolution tasks created\n\nThis tracking feeds into generate-summary for the patrol digest.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-12T21:06:19.348259+05:30","updated_at":"2026-01-12T21:07:32.507497+05:30","closed_at":"2026-01-12T21:07:32.507497+05:30","close_reason":"Queue empty","ephemeral":true}
{"id":"gu-wisp-39g","title":"mol-refinery-patrol","description":"Merge queue processor patrol loop.\n\nThe Refinery is the Engineer in the engine room. You process polecat branches, merging them to main one at a time with sequential rebasing.\n\n**The Scotty Test**: Before proceeding past any failure, ask yourself: \"Would Scotty walk past a warp core leak because it existed before his shift?\"\n\n## Merge Flow\n\nThe Refinery receives MERGE_READY mail from Witnesses when polecats complete work:\n\n```\nWitness                    Refinery                      Git\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ MERGE_READY              ‚îÇ                           ‚îÇ\n   ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ                           ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (verify branch)                   ‚îÇ\n   ‚îÇ                          ‚îÇ fetch \u0026 rebase            ‚îÇ\n   ‚îÇ                          ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (run tests)                       ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (if pass)                         ‚îÇ\n   ‚îÇ                          ‚îÇ merge \u0026 push              ‚îÇ\n   ‚îÇ                          ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ MERGED                   ‚îÇ                           ‚îÇ\n   ‚îÇ\u003c‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ                           ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n```\n\nAfter successful merge, Refinery sends MERGED mail back to Witness so it can\ncomplete cleanup (nuke the polecat worktree).","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-12T21:53:12.093336+05:30","updated_at":"2026-01-12T21:53:12.093336+05:30","ephemeral":true}
{"id":"gu-wisp-3dg","title":"Scan merge queue","description":"Check the beads merge queue - this is the SOURCE OF TRUTH for pending merges.\n\n```bash\ngit fetch --prune origin\ngt mq list \u003crig\u003e\n```\n\nThe beads MQ tracks all pending merge requests. Do NOT rely on `git branch -r | grep polecat`\nas branches may exist without MR beads, or MR beads may exist for already-merged work.\n\nIf queue empty, skip to context-check step.\n\nFor each MR in the queue, verify the branch still exists:\n```bash\ngit branch -r | grep \u003cbranch\u003e\n```\n\nIf branch doesn't exist for a queued MR:\n- Close the MR bead: `bd close \u003cmr-id\u003e --reason \"Branch no longer exists\"`\n- Remove from processing queue\n\nTrack verified MR list for this cycle.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-12T22:31:33.772522+05:30","updated_at":"2026-01-12T22:32:44.028932+05:30","closed_at":"2026-01-12T22:32:44.028932+05:30","close_reason":"MQ empty, no branches to merge","dependencies":[{"issue_id":"gu-wisp-3dg","depends_on_id":"gu-wisp-7ki","type":"parent-child","created_at":"2026-01-12T22:31:33.775618+05:30","created_by":"gastown_ui/refinery"}],"ephemeral":true}
{"id":"gu-wisp-3n7","title":"Generate handoff summary","description":"Summarize this patrol cycle.\n\n**VERIFICATION**: Before generating summary, confirm for each merged branch:\n- [ ] MERGED mail was sent to witness\n- [ ] MR bead was closed\n- [ ] MERGE_READY mail archived\n\nIf any notifications or archiving were missed, do them now!\n\nInclude in summary:\n- Branches merged (count, names)\n- MERGED mails sent (count - should match branches merged)\n- MR beads closed (count - should match branches merged)\n- MERGE_READY mails archived (count - should match branches merged)\n- Test results (pass/fail)\n- Branches with conflicts (count, names)\n- Conflict-resolution tasks created (IDs)\n- Issues filed (if any)\n- Any escalations sent\n\n**Conflict tracking is important** for monitoring MQ health. If many branches\nconflict, it may indicate main is moving too fast or branches are too stale.\n\nThis becomes the digest when the patrol is squashed.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-12T23:05:40.156952+05:30","updated_at":"2026-01-12T23:05:40.156952+05:30","dependencies":[{"issue_id":"gu-wisp-3n7","depends_on_id":"gu-wisp-aka","type":"parent-child","created_at":"2026-01-12T23:05:40.162817+05:30","created_by":"gastown_ui/refinery"},{"issue_id":"gu-wisp-3n7","depends_on_id":"gu-wisp-sz8","type":"blocks","created_at":"2026-01-12T23:05:40.170379+05:30","created_by":"gastown_ui/refinery"}],"ephemeral":true}
{"id":"gu-wisp-448","title":"Merge and push to main","description":"Merge to main and push. CRITICAL: Notifications come IMMEDIATELY after push.\n\n**Step 1: Merge and Push**\n```bash\ngit checkout main\ngit merge --ff-only temp\ngit push origin main\n```\n\n‚ö†Ô∏è **STOP HERE - DO NOT PROCEED UNTIL STEPS 2-3 COMPLETE**\n\n**Step 2: Send MERGED Notification (REQUIRED - DO THIS IMMEDIATELY)**\n\nRIGHT NOW, before any cleanup, send MERGED mail to Witness:\n\n```bash\ngt mail send \u003crig\u003e/witness -s \"MERGED \u003cpolecat-name\u003e\" -m \"Branch: \u003cbranch\u003e\nIssue: \u003cissue-id\u003e\nMerged-At: $(date -u +%Y-%m-%dT%H:%M:%SZ)\"\n```\n\nThis signals the Witness to nuke the polecat worktree. WITHOUT THIS NOTIFICATION,\nPOLECAT WORKTREES ACCUMULATE INDEFINITELY AND THE LIFECYCLE BREAKS.\n\n**Step 3: Close MR Bead (REQUIRED - DO THIS IMMEDIATELY)**\n\n‚ö†Ô∏è **VERIFICATION BEFORE CLOSING**: Confirm the work is actually on main:\n```bash\n# Get the commit message/issue from the branch\ngit log origin/main --oneline | grep \"\u003cissue-id\u003e\"\n# OR verify the commit SHA is on main:\ngit branch --contains \u003ccommit-sha\u003e | grep main\n```\n\nIf work is NOT on main, DO NOT close the MR bead. Investigate first.\n\n```bash\nbd close \u003cmr-bead-id\u003e --reason \"Merged to main at $(git rev-parse --short HEAD)\"\n```\n\nThe MR bead ID was in the MERGE_READY message or find via:\n```bash\nbd list --type=merge-request --status=open | grep \u003cpolecat-name\u003e\n```\n\n**VALIDATION**: The MR bead's source_issue should be a valid bead ID (gt-xxxxx),\nnot a branch name. If source_issue contains a branch name, flag for investigation.\n\n**Step 4: Archive the MERGE_READY mail (REQUIRED)**\n```bash\ngt mail archive \u003cmerge-ready-message-id\u003e\n```\nThe message ID was tracked when you processed inbox-check.\n\n**Step 5: Cleanup (only after Steps 2-4 confirmed)**\n```bash\ngit branch -d temp\ngit push origin --delete \u003cpolecat-branch\u003e\n```\n\n**VERIFICATION GATE**: You CANNOT proceed to loop-check without:\n- [x] MERGED mail sent to witness\n- [x] MR bead closed\n- [x] MERGE_READY mail archived\n\nIf you skipped notifications or archiving, GO BACK AND DO THEM NOW.\n\nMain has moved. Any remaining branches need rebasing on new baseline.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-12T21:23:21.993437+05:30","updated_at":"2026-01-12T21:24:35.996996+05:30","closed_at":"2026-01-12T21:24:35.996996+05:30","close_reason":"Closed","ephemeral":true}
{"id":"gu-wisp-4uf","title":"Merge and push to main","description":"Merge to main and push. CRITICAL: Notifications come IMMEDIATELY after push.\n\n**Step 1: Merge and Push**\n```bash\ngit checkout main\ngit merge --ff-only temp\ngit push origin main\n```\n\n‚ö†Ô∏è **STOP HERE - DO NOT PROCEED UNTIL STEPS 2-3 COMPLETE**\n\n**Step 2: Send MERGED Notification (REQUIRED - DO THIS IMMEDIATELY)**\n\nRIGHT NOW, before any cleanup, send MERGED mail to Witness:\n\n```bash\ngt mail send \u003crig\u003e/witness -s \"MERGED \u003cpolecat-name\u003e\" -m \"Branch: \u003cbranch\u003e\nIssue: \u003cissue-id\u003e\nMerged-At: $(date -u +%Y-%m-%dT%H:%M:%SZ)\"\n```\n\nThis signals the Witness to nuke the polecat worktree. WITHOUT THIS NOTIFICATION,\nPOLECAT WORKTREES ACCUMULATE INDEFINITELY AND THE LIFECYCLE BREAKS.\n\n**Step 3: Close MR Bead (REQUIRED - DO THIS IMMEDIATELY)**\n\n‚ö†Ô∏è **VERIFICATION BEFORE CLOSING**: Confirm the work is actually on main:\n```bash\n# Get the commit message/issue from the branch\ngit log origin/main --oneline | grep \"\u003cissue-id\u003e\"\n# OR verify the commit SHA is on main:\ngit branch --contains \u003ccommit-sha\u003e | grep main\n```\n\nIf work is NOT on main, DO NOT close the MR bead. Investigate first.\n\n```bash\nbd close \u003cmr-bead-id\u003e --reason \"Merged to main at $(git rev-parse --short HEAD)\"\n```\n\nThe MR bead ID was in the MERGE_READY message or find via:\n```bash\nbd list --type=merge-request --status=open | grep \u003cpolecat-name\u003e\n```\n\n**VALIDATION**: The MR bead's source_issue should be a valid bead ID (gt-xxxxx),\nnot a branch name. If source_issue contains a branch name, flag for investigation.\n\n**Step 4: Archive the MERGE_READY mail (REQUIRED)**\n```bash\ngt mail archive \u003cmerge-ready-message-id\u003e\n```\nThe message ID was tracked when you processed inbox-check.\n\n**Step 5: Cleanup (only after Steps 2-4 confirmed)**\n```bash\ngit branch -d temp\ngit push origin --delete \u003cpolecat-branch\u003e\n```\n\n**VERIFICATION GATE**: You CANNOT proceed to loop-check without:\n- [x] MERGED mail sent to witness\n- [x] MR bead closed\n- [x] MERGE_READY mail archived\n\nIf you skipped notifications or archiving, GO BACK AND DO THEM NOW.\n\nMain has moved. Any remaining branches need rebasing on new baseline.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-12T23:05:40.156605+05:30","updated_at":"2026-01-12T23:05:40.156605+05:30","dependencies":[{"issue_id":"gu-wisp-4uf","depends_on_id":"gu-wisp-aka","type":"parent-child","created_at":"2026-01-12T23:05:40.161432+05:30","created_by":"gastown_ui/refinery"},{"issue_id":"gu-wisp-4uf","depends_on_id":"gu-wisp-c8p","type":"blocks","created_at":"2026-01-12T23:05:40.168567+05:30","created_by":"gastown_ui/refinery"}],"ephemeral":true}
{"id":"gu-wisp-4za","title":"Handle test failures","description":"**VERIFICATION GATE**: This step enforces the Beads Promise.\n\nIf tests PASSED: This step auto-completes. Proceed to merge.\n\nIf tests FAILED:\n1. Diagnose: Is this a branch regression or pre-existing on main?\n2. If branch caused it:\n   - Abort merge\n   - Notify polecat: \"Tests failing. Please fix and resubmit.\"\n   - Skip to loop-check\n3. If pre-existing on main:\n   - Option A: Fix it yourself (you're the Engineer!)\n   - Option B: File a bead: bd create --type=bug --priority=1 --title=\"...\"\n\n**GATE REQUIREMENT**: You CANNOT proceed to merge-push without:\n- Tests passing, OR\n- Fix committed, OR\n- Bead filed for the failure\n\nThis is non-negotiable. Never disavow. Never \"note and proceed.\" ","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-12T21:14:50.871221+05:30","updated_at":"2026-01-12T21:16:01.19938+05:30","closed_at":"2026-01-12T21:16:01.19938+05:30","close_reason":"Closed","ephemeral":true}
{"id":"gu-wisp-50l","title":"Run test suite","description":"Run the test suite.\n\n```bash\ngo test ./...\n```\n\nTrack results: pass count, fail count, specific failures.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-12T23:05:40.156261+05:30","updated_at":"2026-01-12T23:05:40.156261+05:30","dependencies":[{"issue_id":"gu-wisp-50l","depends_on_id":"gu-wisp-aka","type":"parent-child","created_at":"2026-01-12T23:05:40.160066+05:30","created_by":"gastown_ui/refinery"}],"ephemeral":true}
{"id":"gu-wisp-5o0","title":"Check refinery mail","description":"Check mail for MERGE_READY submissions, escalations, and messages.\n\n```bash\ngt mail inbox\n```\n\nFor each message:\n\n**MERGE_READY**:\nA polecat's work is ready for merge. Extract details and track for processing.\n\n```bash\n# Parse MERGE_READY message body:\n# Branch: \u003cbranch\u003e\n# Issue: \u003cissue-id\u003e\n# Polecat: \u003cpolecat-name\u003e\n# MR: \u003cmr-bead-id\u003e\n# Verified: clean git state, issue closed\n\n# Track in your merge queue for this patrol cycle:\n# - Branch name\n# - Issue ID\n# - Polecat name (REQUIRED for MERGED notification)\n# - MR bead ID (REQUIRED for closing after merge)\n```\n\n**IMPORTANT**: You MUST track the polecat name, MR bead ID, AND message ID - you will need them\nin merge-push step to send MERGED notification, close the MR bead, and archive the mail.\n\nMark as read. The work will be processed in queue-scan/process-branch.\n**Do NOT archive yet** - archive after merge/reject decision in merge-push step.\n\n**PATROL: Wake up**:\nWitness detected MRs waiting but refinery idle. Acknowledge and archive:\n```bash\ngt mail archive \u003cmessage-id\u003e\n```\n\n**HELP / Blocked**:\nAssess and respond. If you can't help, escalate to Mayor.\nArchive after handling:\n```bash\ngt mail archive \u003cmessage-id\u003e\n```\n\n**HANDOFF**:\nRead predecessor context. Check for in-flight merges.\nArchive after absorbing context:\n```bash\ngt mail archive \u003cmessage-id\u003e\n```\n\n**Hygiene principle**: Archive messages after they're fully processed.\nKeep only: pending MRs in queue. Inbox should be near-empty.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-12T21:14:50.870479+05:30","updated_at":"2026-01-12T21:15:07.994818+05:30","closed_at":"2026-01-12T21:15:07.994818+05:30","close_reason":"Closed","ephemeral":true}
{"id":"gu-wisp-7ki","title":"mol-refinery-patrol","description":"Merge queue processor patrol loop.\n\nThe Refinery is the Engineer in the engine room. You process polecat branches, merging them to main one at a time with sequential rebasing.\n\n**The Scotty Test**: Before proceeding past any failure, ask yourself: \"Would Scotty walk past a warp core leak because it existed before his shift?\"\n\n## Merge Flow\n\nThe Refinery receives MERGE_READY mail from Witnesses when polecats complete work:\n\n```\nWitness                    Refinery                      Git\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ MERGE_READY              ‚îÇ                           ‚îÇ\n   ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ                           ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (verify branch)                   ‚îÇ\n   ‚îÇ                          ‚îÇ fetch \u0026 rebase            ‚îÇ\n   ‚îÇ                          ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (run tests)                       ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (if pass)                         ‚îÇ\n   ‚îÇ                          ‚îÇ merge \u0026 push              ‚îÇ\n   ‚îÇ                          ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ MERGED                   ‚îÇ                           ‚îÇ\n   ‚îÇ\u003c‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ                           ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n```\n\nAfter successful merge, Refinery sends MERGED mail back to Witness so it can\ncomplete cleanup (nuke the polecat worktree).","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-12T22:31:33.771795+05:30","updated_at":"2026-01-12T22:31:33.771795+05:30","ephemeral":true}
{"id":"gu-wisp-87h","title":"mol-refinery-patrol","description":"Merge queue processor patrol loop.\n\nThe Refinery is the Engineer in the engine room. You process polecat branches, merging them to main one at a time with sequential rebasing.\n\n**The Scotty Test**: Before proceeding past any failure, ask yourself: \"Would Scotty walk past a warp core leak because it existed before his shift?\"\n\n## Merge Flow\n\nThe Refinery receives MERGE_READY mail from Witnesses when polecats complete work:\n\n```\nWitness                    Refinery                      Git\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ MERGE_READY              ‚îÇ                           ‚îÇ\n   ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ                           ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (verify branch)                   ‚îÇ\n   ‚îÇ                          ‚îÇ fetch \u0026 rebase            ‚îÇ\n   ‚îÇ                          ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (run tests)                       ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (if pass)                         ‚îÇ\n   ‚îÇ                          ‚îÇ merge \u0026 push              ‚îÇ\n   ‚îÇ                          ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ MERGED                   ‚îÇ                           ‚îÇ\n   ‚îÇ\u003c‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ                           ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n```\n\nAfter successful merge, Refinery sends MERGED mail back to Witness so it can\ncomplete cleanup (nuke the polecat worktree).","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-12T23:01:28.89588+05:30","updated_at":"2026-01-12T23:01:28.89588+05:30","ephemeral":true}
{"id":"gu-wisp-93o","title":"Run test suite","description":"Run the test suite.\n\n```bash\ngo test ./...\n```\n\nTrack results: pass count, fail count, specific failures.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-12T21:23:21.993101+05:30","updated_at":"2026-01-12T21:24:35.777827+05:30","closed_at":"2026-01-12T21:24:35.777827+05:30","close_reason":"Closed","ephemeral":true}
{"id":"gu-wisp-a91","title":"Check own context limit","description":"Check own context usage.\n\nIf context is HIGH (\u003e80%):\n- Write handoff summary\n- Prepare for burn/respawn\n\nIf context is LOW:\n- Can continue processing","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-12T21:23:21.993948+05:30","updated_at":"2026-01-12T21:25:00.747156+05:30","closed_at":"2026-01-12T21:25:00.747156+05:30","close_reason":"Closed","ephemeral":true}
{"id":"gu-wisp-aka","title":"mol-refinery-patrol","description":"Merge queue processor patrol loop.\n\nThe Refinery is the Engineer in the engine room. You process polecat branches, merging them to main one at a time with sequential rebasing.\n\n**The Scotty Test**: Before proceeding past any failure, ask yourself: \"Would Scotty walk past a warp core leak because it existed before his shift?\"\n\n## Merge Flow\n\nThe Refinery receives MERGE_READY mail from Witnesses when polecats complete work:\n\n```\nWitness                    Refinery                      Git\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ MERGE_READY              ‚îÇ                           ‚îÇ\n   ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ                           ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (verify branch)                   ‚îÇ\n   ‚îÇ                          ‚îÇ fetch \u0026 rebase            ‚îÇ\n   ‚îÇ                          ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (run tests)                       ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (if pass)                         ‚îÇ\n   ‚îÇ                          ‚îÇ merge \u0026 push              ‚îÇ\n   ‚îÇ                          ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ MERGED                   ‚îÇ                           ‚îÇ\n   ‚îÇ\u003c‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ                           ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n```\n\nAfter successful merge, Refinery sends MERGED mail back to Witness so it can\ncomplete cleanup (nuke the polecat worktree).","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-12T23:05:40.1552+05:30","updated_at":"2026-01-12T23:05:40.1552+05:30","ephemeral":true}
{"id":"gu-wisp-ave","title":"mol-refinery-patrol","description":"Merge queue processor patrol loop.\n\nThe Refinery is the Engineer in the engine room. You process polecat branches, merging them to main one at a time with sequential rebasing.\n\n**The Scotty Test**: Before proceeding past any failure, ask yourself: \"Would Scotty walk past a warp core leak because it existed before his shift?\"\n\n## Merge Flow\n\nThe Refinery receives MERGE_READY mail from Witnesses when polecats complete work:\n\n```\nWitness                    Refinery                      Git\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ MERGE_READY              ‚îÇ                           ‚îÇ\n   ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ                           ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (verify branch)                   ‚îÇ\n   ‚îÇ                          ‚îÇ fetch \u0026 rebase            ‚îÇ\n   ‚îÇ                          ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (run tests)                       ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (if pass)                         ‚îÇ\n   ‚îÇ                          ‚îÇ merge \u0026 push              ‚îÇ\n   ‚îÇ                          ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ MERGED                   ‚îÇ                           ‚îÇ\n   ‚îÇ\u003c‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ                           ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n```\n\nAfter successful merge, Refinery sends MERGED mail back to Witness so it can\ncomplete cleanup (nuke the polecat worktree).","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-12T23:06:22.564487+05:30","updated_at":"2026-01-12T23:06:22.564487+05:30","ephemeral":true}
{"id":"gu-wisp-bjz","title":"Scan merge queue","description":"Check the beads merge queue - this is the SOURCE OF TRUTH for pending merges.\n\n```bash\ngit fetch --prune origin\ngt mq list \u003crig\u003e\n```\n\nThe beads MQ tracks all pending merge requests. Do NOT rely on `git branch -r | grep polecat`\nas branches may exist without MR beads, or MR beads may exist for already-merged work.\n\nIf queue empty, skip to context-check step.\n\nFor each MR in the queue, verify the branch still exists:\n```bash\ngit branch -r | grep \u003cbranch\u003e\n```\n\nIf branch doesn't exist for a queued MR:\n- Close the MR bead: `bd close \u003cmr-id\u003e --reason \"Branch no longer exists\"`\n- Remove from processing queue\n\nTrack verified MR list for this cycle.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-12T23:05:40.155889+05:30","updated_at":"2026-01-12T23:05:40.155889+05:30","dependencies":[{"issue_id":"gu-wisp-bjz","depends_on_id":"gu-wisp-aka","type":"parent-child","created_at":"2026-01-12T23:05:40.158652+05:30","created_by":"gastown_ui/refinery"},{"issue_id":"gu-wisp-bjz","depends_on_id":"gu-wisp-1mt","type":"blocks","created_at":"2026-01-12T23:05:40.165597+05:30","created_by":"gastown_ui/refinery"}],"ephemeral":true}
{"id":"gu-wisp-byh","title":"Burn and respawn or loop","description":"End of patrol cycle decision.\n\n**Step 1: Estimate remaining context**\n\nAsk yourself:\n- Have I processed many branches this cycle?\n- Is the conversation getting long?\n- Am I starting to lose track of earlier context?\n\nRule of thumb: If you've done 3+ merges or processed significant cleanup work,\nit's time for a fresh session.\n\n**Step 2: Decision tree**\n\nIf queue non-empty AND context LOW:\n- Squash this wisp to digest\n- Spawn fresh patrol wisp\n- Return to inbox-check\n\nIf queue empty OR context HIGH OR good stopping point:\n- Squash wisp with summary digest\n- Use `gt handoff` for clean session transition:\n\n```bash\ngt handoff -s \"Patrol complete\" -m \"Merged X branches, Y tests passed.\nQueue: empty/N remaining\nNext: [any notes for successor]\"\n```\n\n**Why gt handoff?**\n- Sends handoff mail to yourself with context\n- Respawns with fresh Claude instance\n- SessionStart hook runs gt prime\n- Successor picks up from your hook\n\n**DO NOT just exit.** Always use `gt handoff` for proper lifecycle.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-12T22:40:12.463492+05:30","updated_at":"2026-01-12T22:40:12.463492+05:30","dependencies":[{"issue_id":"gu-wisp-byh","depends_on_id":"gu-wisp-w9j","type":"parent-child","created_at":"2026-01-12T22:40:12.475262+05:30","created_by":"gastown_ui/refinery"}]}
{"id":"gu-wisp-c3g","title":"Mechanical rebase","description":"Pick next branch from queue. Attempt mechanical rebase on current main.\n\n**Step 1: Checkout and attempt rebase**\n```bash\ngit checkout -b temp origin/\u003cpolecat-branch\u003e\ngit rebase origin/main\n```\n\n**Step 2: Check rebase result**\n\nThe rebase exits with:\n- Exit code 0: Success - proceed to run-tests\n- Exit code 1 (conflicts): Conflict detected - proceed to Step 3\n\nTo detect conflict state after rebase fails:\n```bash\n# Check if we're in a conflicted rebase state\nls .git/rebase-merge 2\u003e/dev/null \u0026\u0026 echo \"CONFLICT_STATE\"\n```\n\n**Step 3: Handle conflicts (if any)**\n\nIf rebase SUCCEEDED (exit code 0):\n- Skip to run-tests step (continue normal merge flow)\n\nIf rebase FAILED with conflicts:\n\n1. **Abort the rebase** (DO NOT leave repo in conflicted state):\n```bash\ngit rebase --abort\n```\n\n2. **Record conflict metadata**:\n```bash\n# Capture main SHA for reference\nMAIN_SHA=$(git rev-parse origin/main)\nBRANCH_SHA=$(git rev-parse origin/\u003cpolecat-branch\u003e)\n```\n\n3. **Create conflict-resolution task**:\n```bash\nbd create --type=task --priority=1 --title=\"Resolve merge conflicts: \u003coriginal-issue-title\u003e\" --description=\"## Conflict Resolution Required\n\nOriginal MR: \u003cmr-bead-id\u003e\nBranch: \u003cpolecat-branch\u003e\nOriginal Issue: \u003cissue-id\u003e\nConflict with main at: ${MAIN_SHA}\nBranch SHA: ${BRANCH_SHA}\n\n## Instructions\n1. Clone/checkout the branch\n2. Rebase on current main: git rebase origin/main\n3. Resolve conflicts\n4. Force push: git push -f origin \u003cbranch\u003e\n5. Close this task when done\n\nThe MR will be re-queued for processing after conflicts are resolved.\"\n```\n\n4. **Skip this MR** (do NOT delete branch or close MR bead):\n- Leave branch intact for conflict resolution\n- Leave MR bead open (will be re-processed after resolution)\n- Continue to loop-check for next branch\n\n**CRITICAL**: Never delete a branch that has conflicts. The branch contains\nthe original work and must be preserved for conflict resolution.\n\nTrack: rebase result (success/conflict), conflict task ID if created.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-12T23:05:40.156077+05:30","updated_at":"2026-01-12T23:05:40.156077+05:30","dependencies":[{"issue_id":"gu-wisp-c3g","depends_on_id":"gu-wisp-aka","type":"parent-child","created_at":"2026-01-12T23:05:40.159379+05:30","created_by":"gastown_ui/refinery"},{"issue_id":"gu-wisp-c3g","depends_on_id":"gu-wisp-bjz","type":"blocks","created_at":"2026-01-12T23:05:40.166301+05:30","created_by":"gastown_ui/refinery"}]}
{"id":"gu-wisp-c8p","title":"Handle test failures","description":"**VERIFICATION GATE**: This step enforces the Beads Promise.\n\nIf tests PASSED: This step auto-completes. Proceed to merge.\n\nIf tests FAILED:\n1. Diagnose: Is this a branch regression or pre-existing on main?\n2. If branch caused it:\n   - Abort merge\n   - Notify polecat: \"Tests failing. Please fix and resubmit.\"\n   - Skip to loop-check\n3. If pre-existing on main:\n   - Option A: Fix it yourself (you're the Engineer!)\n   - Option B: File a bead: bd create --type=bug --priority=1 --title=\"...\"\n\n**GATE REQUIREMENT**: You CANNOT proceed to merge-push without:\n- Tests passing, OR\n- Fix committed, OR\n- Bead filed for the failure\n\nThis is non-negotiable. Never disavow. Never \"note and proceed.\" ","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-12T23:05:40.156434+05:30","updated_at":"2026-01-12T23:05:40.156434+05:30","dependencies":[{"issue_id":"gu-wisp-c8p","depends_on_id":"gu-wisp-aka","type":"parent-child","created_at":"2026-01-12T23:05:40.160753+05:30","created_by":"gastown_ui/refinery"},{"issue_id":"gu-wisp-c8p","depends_on_id":"gu-wisp-50l","type":"blocks","created_at":"2026-01-12T23:05:40.167761+05:30","created_by":"gastown_ui/refinery"}],"ephemeral":true}
{"id":"gu-wisp-cgi","title":"Check own context limit","description":"Check own context usage.\n\nIf context is HIGH (\u003e80%):\n- Write handoff summary\n- Prepare for burn/respawn\n\nIf context is LOW:\n- Can continue processing","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-12T23:05:40.157116+05:30","updated_at":"2026-01-12T23:05:40.157116+05:30","dependencies":[{"issue_id":"gu-wisp-cgi","depends_on_id":"gu-wisp-aka","type":"parent-child","created_at":"2026-01-12T23:05:40.163515+05:30","created_by":"gastown_ui/refinery"},{"issue_id":"gu-wisp-cgi","depends_on_id":"gu-wisp-3n7","type":"blocks","created_at":"2026-01-12T23:05:40.171276+05:30","created_by":"gastown_ui/refinery"}],"ephemeral":true}
{"id":"gu-wisp-czp","title":"End-of-cycle inbox hygiene","description":"Verify inbox hygiene before ending patrol cycle.\n\n**Step 1: Check inbox state**\n```bash\ngt mail inbox\n```\n\nInbox should contain ONLY:\n- Unprocessed MERGE_READY messages (will process next cycle)\n- Active work items\n\n**Step 2: Archive any stale messages**\n\nLook for messages that were processed but not archived:\n- PATROL: Wake up that was acknowledged ‚Üí archive\n- HELP/Blocked that was handled ‚Üí archive\n- MERGE_READY where merge completed but archive was missed ‚Üí archive\n\n```bash\n# For each stale message found:\ngt mail archive \u003cmessage-id\u003e\n```\n\n**Step 3: Check for orphaned MR beads**\n\nLook for open MR beads with no corresponding branch:\n```bash\nbd list --type=merge-request --status=open\n```\n\nFor each open MR bead:\n1. Check if branch exists: `git ls-remote origin refs/heads/\u003cbranch\u003e`\n2. If branch gone, verify work is on main: `git log origin/main --oneline | grep \"\u003csource_issue\u003e\"`\n3. If work on main ‚Üí close MR with reason \"Merged (verified on main)\"\n4. If work NOT on main ‚Üí investigate before closing:\n   - Check source_issue validity (should be gt-xxxxx, not branch name)\n   - Search reflog/dangling commits if possible\n   - If unverifiable, close with reason \"Unverifiable - no audit trail\"\n   - File bead if this indicates lost work\n\n**NEVER close an MR bead without verifying the work landed or is unrecoverable.**\n\n**Goal**: Inbox should have ‚â§3 active messages at end of cycle.\nKeep only: pending MRs in queue.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-12T21:14:50.872063+05:30","updated_at":"2026-01-12T21:16:24.850858+05:30","closed_at":"2026-01-12T21:16:24.850858+05:30","close_reason":"Closed","ephemeral":true}
{"id":"gu-wisp-e0l","title":"mol-refinery-patrol","description":"Merge queue processor patrol loop.\n\nThe Refinery is the Engineer in the engine room. You process polecat branches, merging them to main one at a time with sequential rebasing.\n\n**The Scotty Test**: Before proceeding past any failure, ask yourself: \"Would Scotty walk past a warp core leak because it existed before his shift?\"\n\n## Merge Flow\n\nThe Refinery receives MERGE_READY mail from Witnesses when polecats complete work:\n\n```\nWitness                    Refinery                      Git\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ MERGE_READY              ‚îÇ                           ‚îÇ\n   ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ                           ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (verify branch)                   ‚îÇ\n   ‚îÇ                          ‚îÇ fetch \u0026 rebase            ‚îÇ\n   ‚îÇ                          ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (run tests)                       ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (if pass)                         ‚îÇ\n   ‚îÇ                          ‚îÇ merge \u0026 push              ‚îÇ\n   ‚îÇ                          ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ MERGED                   ‚îÇ                           ‚îÇ\n   ‚îÇ\u003c‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ                           ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n```\n\nAfter successful merge, Refinery sends MERGED mail back to Witness so it can\ncomplete cleanup (nuke the polecat worktree).","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-12T22:01:05.193654+05:30","updated_at":"2026-01-12T22:01:05.193654+05:30","ephemeral":true}
{"id":"gu-wisp-ejz","title":"Scan merge queue","description":"Check the beads merge queue - this is the SOURCE OF TRUTH for pending merges.\n\n```bash\ngit fetch --prune origin\ngt mq list \u003crig\u003e\n```\n\nThe beads MQ tracks all pending merge requests. Do NOT rely on `git branch -r | grep polecat`\nas branches may exist without MR beads, or MR beads may exist for already-merged work.\n\nIf queue empty, skip to context-check step.\n\nFor each MR in the queue, verify the branch still exists:\n```bash\ngit branch -r | grep \u003cbranch\u003e\n```\n\nIf branch doesn't exist for a queued MR:\n- Close the MR bead: `bd close \u003cmr-id\u003e --reason \"Branch no longer exists\"`\n- Remove from processing queue\n\nTrack verified MR list for this cycle.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-12T22:40:12.461799+05:30","updated_at":"2026-01-12T22:40:12.461799+05:30","dependencies":[{"issue_id":"gu-wisp-ejz","depends_on_id":"gu-wisp-w9j","type":"parent-child","created_at":"2026-01-12T22:40:12.465734+05:30","created_by":"gastown_ui/refinery"}],"ephemeral":true}
{"id":"gu-wisp-fnf","title":"Burn and respawn or loop","description":"End of patrol cycle decision.\n\n**Step 1: Estimate remaining context**\n\nAsk yourself:\n- Have I processed many branches this cycle?\n- Is the conversation getting long?\n- Am I starting to lose track of earlier context?\n\nRule of thumb: If you've done 3+ merges or processed significant cleanup work,\nit's time for a fresh session.\n\n**Step 2: Decision tree**\n\nIf queue non-empty AND context LOW:\n- Squash this wisp to digest\n- Spawn fresh patrol wisp\n- Return to inbox-check\n\nIf queue empty OR context HIGH OR good stopping point:\n- Squash wisp with summary digest\n- Use `gt handoff` for clean session transition:\n\n```bash\ngt handoff -s \"Patrol complete\" -m \"Merged X branches, Y tests passed.\nQueue: empty/N remaining\nNext: [any notes for successor]\"\n```\n\n**Why gt handoff?**\n- Sends handoff mail to yourself with context\n- Respawns with fresh Claude instance\n- SessionStart hook runs gt prime\n- Successor picks up from your hook\n\n**DO NOT just exit.** Always use `gt handoff` for proper lifecycle.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-12T21:23:21.994274+05:30","updated_at":"2026-01-12T21:25:07.266748+05:30","closed_at":"2026-01-12T21:25:07.266748+05:30","close_reason":"Closed","ephemeral":true}
{"id":"gu-wisp-fog","title":"mol-refinery-patrol","description":"Merge queue processor patrol loop.\n\nThe Refinery is the Engineer in the engine room. You process polecat branches, merging them to main one at a time with sequential rebasing.\n\n**The Scotty Test**: Before proceeding past any failure, ask yourself: \"Would Scotty walk past a warp core leak because it existed before his shift?\"\n\n## Merge Flow\n\nThe Refinery receives MERGE_READY mail from Witnesses when polecats complete work:\n\n```\nWitness                    Refinery                      Git\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ MERGE_READY              ‚îÇ                           ‚îÇ\n   ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ                           ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (verify branch)                   ‚îÇ\n   ‚îÇ                          ‚îÇ fetch \u0026 rebase            ‚îÇ\n   ‚îÇ                          ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (run tests)                       ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (if pass)                         ‚îÇ\n   ‚îÇ                          ‚îÇ merge \u0026 push              ‚îÇ\n   ‚îÇ                          ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ MERGED                   ‚îÇ                           ‚îÇ\n   ‚îÇ\u003c‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ                           ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n```\n\nAfter successful merge, Refinery sends MERGED mail back to Witness so it can\ncomplete cleanup (nuke the polecat worktree).","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-12T23:14:08.948289+05:30","updated_at":"2026-01-12T23:14:08.948289+05:30","ephemeral":true}
{"id":"gu-wisp-qwv","title":"mol-refinery-patrol","description":"Merge queue processor patrol loop.\n\nThe Refinery is the Engineer in the engine room. You process polecat branches, merging them to main one at a time with sequential rebasing.\n\n**The Scotty Test**: Before proceeding past any failure, ask yourself: \"Would Scotty walk past a warp core leak because it existed before his shift?\"\n\n## Merge Flow\n\nThe Refinery receives MERGE_READY mail from Witnesses when polecats complete work:\n\n```\nWitness                    Refinery                      Git\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ MERGE_READY              ‚îÇ                           ‚îÇ\n   ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ                           ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (verify branch)                   ‚îÇ\n   ‚îÇ                          ‚îÇ fetch \u0026 rebase            ‚îÇ\n   ‚îÇ                          ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (run tests)                       ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (if pass)                         ‚îÇ\n   ‚îÇ                          ‚îÇ merge \u0026 push              ‚îÇ\n   ‚îÇ                          ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ MERGED                   ‚îÇ                           ‚îÇ\n   ‚îÇ\u003c‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ                           ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n```\n\nAfter successful merge, Refinery sends MERGED mail back to Witness so it can\ncomplete cleanup (nuke the polecat worktree).","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-12T23:18:26.593348+05:30","updated_at":"2026-01-12T23:18:26.593348+05:30","ephemeral":true}
{"id":"gu-wisp-r8f","title":"mol-refinery-patrol","description":"Merge queue processor patrol loop.\n\nThe Refinery is the Engineer in the engine room. You process polecat branches, merging them to main one at a time with sequential rebasing.\n\n**The Scotty Test**: Before proceeding past any failure, ask yourself: \"Would Scotty walk past a warp core leak because it existed before his shift?\"\n\n## Merge Flow\n\nThe Refinery receives MERGE_READY mail from Witnesses when polecats complete work:\n\n```\nWitness                    Refinery                      Git\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ MERGE_READY              ‚îÇ                           ‚îÇ\n   ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ                           ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (verify branch)                   ‚îÇ\n   ‚îÇ                          ‚îÇ fetch \u0026 rebase            ‚îÇ\n   ‚îÇ                          ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (run tests)                       ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (if pass)                         ‚îÇ\n   ‚îÇ                          ‚îÇ merge \u0026 push              ‚îÇ\n   ‚îÇ                          ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ MERGED                   ‚îÇ                           ‚îÇ\n   ‚îÇ\u003c‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ                           ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n```\n\nAfter successful merge, Refinery sends MERGED mail back to Witness so it can\ncomplete cleanup (nuke the polecat worktree).","status":"hooked","priority":2,"issue_type":"epic","assignee":"gastown_ui/refinery","created_at":"2026-01-12T23:22:41.688982+05:30","updated_at":"2026-01-12T23:22:55.359537+05:30","ephemeral":true}
{"id":"gu-wisp-rkn","title":"mol-refinery-patrol","description":"Merge queue processor patrol loop.\n\nThe Refinery is the Engineer in the engine room. You process polecat branches, merging them to main one at a time with sequential rebasing.\n\n**The Scotty Test**: Before proceeding past any failure, ask yourself: \"Would Scotty walk past a warp core leak because it existed before his shift?\"\n\n## Merge Flow\n\nThe Refinery receives MERGE_READY mail from Witnesses when polecats complete work:\n\n```\nWitness                    Refinery                      Git\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ MERGE_READY              ‚îÇ                           ‚îÇ\n   ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ                           ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (verify branch)                   ‚îÇ\n   ‚îÇ                          ‚îÇ fetch \u0026 rebase            ‚îÇ\n   ‚îÇ                          ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (run tests)                       ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (if pass)                         ‚îÇ\n   ‚îÇ                          ‚îÇ merge \u0026 push              ‚îÇ\n   ‚îÇ                          ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ MERGED                   ‚îÇ                           ‚îÇ\n   ‚îÇ\u003c‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ                           ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n```\n\nAfter successful merge, Refinery sends MERGED mail back to Witness so it can\ncomplete cleanup (nuke the polecat worktree).","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-12T21:57:27.924997+05:30","updated_at":"2026-01-12T21:57:27.924997+05:30","ephemeral":true}
{"id":"gu-wisp-rqi","title":"mol-refinery-patrol","description":"Merge queue processor patrol loop.\n\nThe Refinery is the Engineer in the engine room. You process polecat branches, merging them to main one at a time with sequential rebasing.\n\n**The Scotty Test**: Before proceeding past any failure, ask yourself: \"Would Scotty walk past a warp core leak because it existed before his shift?\"\n\n## Merge Flow\n\nThe Refinery receives MERGE_READY mail from Witnesses when polecats complete work:\n\n```\nWitness                    Refinery                      Git\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ MERGE_READY              ‚îÇ                           ‚îÇ\n   ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ                           ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (verify branch)                   ‚îÇ\n   ‚îÇ                          ‚îÇ fetch \u0026 rebase            ‚îÇ\n   ‚îÇ                          ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (run tests)                       ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (if pass)                         ‚îÇ\n   ‚îÇ                          ‚îÇ merge \u0026 push              ‚îÇ\n   ‚îÇ                          ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ MERGED                   ‚îÇ                           ‚îÇ\n   ‚îÇ\u003c‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ                           ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n```\n\nAfter successful merge, Refinery sends MERGED mail back to Witness so it can\ncomplete cleanup (nuke the polecat worktree).","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-12T22:57:05.646063+05:30","updated_at":"2026-01-12T22:57:05.646063+05:30","ephemeral":true}
{"id":"gu-wisp-rxa","title":"Generate handoff summary","description":"Summarize this patrol cycle.\n\n**VERIFICATION**: Before generating summary, confirm for each merged branch:\n- [ ] MERGED mail was sent to witness\n- [ ] MR bead was closed\n- [ ] MERGE_READY mail archived\n\nIf any notifications or archiving were missed, do them now!\n\nInclude in summary:\n- Branches merged (count, names)\n- MERGED mails sent (count - should match branches merged)\n- MR beads closed (count - should match branches merged)\n- MERGE_READY mails archived (count - should match branches merged)\n- Test results (pass/fail)\n- Branches with conflicts (count, names)\n- Conflict-resolution tasks created (IDs)\n- Issues filed (if any)\n- Any escalations sent\n\n**Conflict tracking is important** for monitoring MQ health. If many branches\nconflict, it may indicate main is moving too fast or branches are too stale.\n\nThis becomes the digest when the patrol is squashed.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-12T21:14:50.871736+05:30","updated_at":"2026-01-12T21:16:07.127422+05:30","closed_at":"2026-01-12T21:16:07.127422+05:30","close_reason":"Closed","ephemeral":true}
{"id":"gu-wisp-sz8","title":"Check for more work","description":"More branches to process?\n\n**Entry paths:**\n- Normal: After successful merge-push\n- Conflict-skip: After process-branch created conflict-resolution task\n\nIf yes: Return to process-branch with next branch.\nIf no: Continue to generate-summary.\n\n**Track for this cycle:**\n- branches_merged: count and names of successfully merged branches\n- branches_conflict: count and names of branches skipped due to conflicts\n- conflict_tasks: IDs of conflict-resolution tasks created\n\nThis tracking feeds into generate-summary for the patrol digest.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-12T23:05:40.156778+05:30","updated_at":"2026-01-12T23:05:40.156778+05:30","dependencies":[{"issue_id":"gu-wisp-sz8","depends_on_id":"gu-wisp-aka","type":"parent-child","created_at":"2026-01-12T23:05:40.162131+05:30","created_by":"gastown_ui/refinery"},{"issue_id":"gu-wisp-sz8","depends_on_id":"gu-wisp-4uf","type":"blocks","created_at":"2026-01-12T23:05:40.169509+05:30","created_by":"gastown_ui/refinery"}],"ephemeral":true}
{"id":"gu-wisp-u94","title":"mol-refinery-patrol","description":"Merge queue processor patrol loop.\n\nThe Refinery is the Engineer in the engine room. You process polecat branches, merging them to main one at a time with sequential rebasing.\n\n**The Scotty Test**: Before proceeding past any failure, ask yourself: \"Would Scotty walk past a warp core leak because it existed before his shift?\"\n\n## Merge Flow\n\nThe Refinery receives MERGE_READY mail from Witnesses when polecats complete work:\n\n```\nWitness                    Refinery                      Git\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ MERGE_READY              ‚îÇ                           ‚îÇ\n   ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ                           ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (verify branch)                   ‚îÇ\n   ‚îÇ                          ‚îÇ fetch \u0026 rebase            ‚îÇ\n   ‚îÇ                          ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (run tests)                       ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (if pass)                         ‚îÇ\n   ‚îÇ                          ‚îÇ merge \u0026 push              ‚îÇ\n   ‚îÇ                          ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ MERGED                   ‚îÇ                           ‚îÇ\n   ‚îÇ\u003c‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ                           ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n```\n\nAfter successful merge, Refinery sends MERGED mail back to Witness so it can\ncomplete cleanup (nuke the polecat worktree).","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-12T22:05:26.701778+05:30","updated_at":"2026-01-12T22:05:26.701778+05:30","ephemeral":true}
{"id":"gu-wisp-w9j","title":"mol-refinery-patrol","description":"Merge queue processor patrol loop.\n\nThe Refinery is the Engineer in the engine room. You process polecat branches, merging them to main one at a time with sequential rebasing.\n\n**The Scotty Test**: Before proceeding past any failure, ask yourself: \"Would Scotty walk past a warp core leak because it existed before his shift?\"\n\n## Merge Flow\n\nThe Refinery receives MERGE_READY mail from Witnesses when polecats complete work:\n\n```\nWitness                    Refinery                      Git\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ MERGE_READY              ‚îÇ                           ‚îÇ\n   ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ                           ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (verify branch)                   ‚îÇ\n   ‚îÇ                          ‚îÇ fetch \u0026 rebase            ‚îÇ\n   ‚îÇ                          ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (run tests)                       ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (if pass)                         ‚îÇ\n   ‚îÇ                          ‚îÇ merge \u0026 push              ‚îÇ\n   ‚îÇ                          ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ MERGED                   ‚îÇ                           ‚îÇ\n   ‚îÇ\u003c‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ                           ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n```\n\nAfter successful merge, Refinery sends MERGED mail back to Witness so it can\ncomplete cleanup (nuke the polecat worktree).","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-12T22:40:12.460956+05:30","updated_at":"2026-01-12T22:40:12.460956+05:30","ephemeral":true}
{"id":"gu-x1zc","title":"Implement /api/gastown/workflows/molecules endpoint","description":"## Overview\nImplement the molecules listing endpoint for workflow management.\n\n## API Specification (from INTEGRATION_PLAN.md v5.1)\n- **Route**: `/api/gastown/workflows/molecules`\n- **Method**: GET\n- **CLI Command**: `bd list --type=molecule`\n- **Response**: `GtMolecule[]`\n- **Timeout**: 1s (fast - beads is local)\n- **Cache TTL**: 10s\n\n## Implementation Requirements\n\n### 1. SvelteKit Route Handler\n```typescript\n// src/routes/api/gastown/workflows/molecules/+server.ts\nimport { json, error } from '@sveltejs/kit';\nimport { processSupervisor } from '$lib/server/process-supervisor';\nimport { withCircuitBreaker } from '$lib/server/circuit-breaker';\nimport { GtMoleculeArraySchema } from '$lib/contracts/workflows';\n\nexport async function GET({ setHeaders }) {\n  const result = await withCircuitBreaker(\n    'molecule-list',\n    () =\u003e processSupervisor.exec('bd', ['list', '--type=molecule', '--json']),\n    { timeout: 1000 }\n  );\n  \n  const molecules = GtMoleculeArraySchema.parse(JSON.parse(result.stdout));\n  \n  setHeaders({\n    'Cache-Control': 'public, max-age=10, stale-while-revalidate=30'\n  });\n  \n  return json(molecules);\n}\n```\n\n### 2. Zod Contract\n```typescript\n// Add to lib/contracts/workflows.ts\nexport const GtMoleculeSchema = z.object({\n  id: z.string(),\n  name: z.string(),\n  type: z.literal('molecule'),\n  status: z.enum(['pending', 'in_progress', 'completed', 'blocked']),\n  steps: z.array(z.object({\n    id: z.string(),\n    name: z.string(),\n    status: z.enum(['pending', 'in_progress', 'completed', 'blocked'])\n  })),\n  assignee: z.string().optional(),\n  created: z.string(),\n  updated: z.string()\n});\n\nexport const GtMoleculeArraySchema = z.array(GtMoleculeSchema);\n```\n\n### 3. Two-Phase Feedback (if called from UI)\n- Phase 1: \"Loading molecules...\"\n- Phase 2: \"Loaded {count} molecules ({active} active)\"\n\n### 4. Error Handling\n- Timeout after 1s (beads is local, should be fast)\n- Circuit breaker prevents cascade failures\n- Log stderr to server logs for debugging\n\n## Acceptance Criteria\n- [ ] Route returns valid JSON array of molecules\n- [ ] Response validates against Zod schema\n- [ ] Timeout properly configured (1s)\n- [ ] Cache headers set (10s TTL, 30s stale-while-revalidate)\n- [ ] Uses Process Supervisor (no execSync)\n- [ ] Circuit breaker protects against failures\n- [ ] Errors return proper ApiErrorResponse format\n\n## Testing\n- [ ] Unit test: mock CLI output, verify parsing\n- [ ] Integration test: call real bd list --type=molecule, verify response\n- [ ] Error test: verify timeout handling\n- [ ] Contract test: verify Zod schema matches real output","status":"closed","priority":1,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-13T00:56:53.843048+05:30","created_by":"Avyukth","updated_at":"2026-01-13T01:17:43.888418+05:30","closed_at":"2026-01-13T01:17:43.888418+05:30","close_reason":"Already implemented: /api/gastown/workflows/molecules exists","labels":["layer:api","phase:1"]}
{"id":"gu-x78k","title":"Implement CopyCLI component","description":"# CopyCLI Component\n\n## Background\nPower users want to see and copy the equivalent CLI command for any action.\nThis aids debugging and learning the CLI.\n\n## Component API\n```svelte\n\u003cCopyCli command=\"gt\" args={['peek', agent.id]} /\u003e\n\u003c!-- Renders: gt peek abc123 [üìã] --\u003e\n```\n\n## Behavior\n- Shows full command as monospace text\n- Click anywhere to copy to clipboard\n- Brief \"Copied!\" feedback\n- Keyboard accessible (Enter/Space to copy)\n\n## Implementation\n```svelte\n\u003cscript lang=\"ts\"\u003e\n  export let command: 'gt' | 'bd';\n  export let args: string[];\n  \n  let copied = $state(false);\n  \n  const fullCommand = [command, ...args].join(' ');\n  \n  async function copy() {\n    await navigator.clipboard.writeText(fullCommand);\n    copied = true;\n    setTimeout(() =\u003e copied = false, 2000);\n  }\n\u003c/script\u003e\n\n\u003cbutton\n  class=\"copy-cli\"\n  onclick={copy}\n  title=\"Copy CLI command\"\n  aria-label=\"Copy: {fullCommand}\"\n  data-testid=\"copy-cli\"\n\u003e\n  \u003ccode\u003e{fullCommand}\u003c/code\u003e\n  \u003cspan class=\"icon\"\u003e{copied ? '‚úì' : 'üìã'}\u003c/span\u003e\n\u003c/button\u003e\n```\n\n## Usage Locations\n- Agent cards (gt peek)\n- Work item details (bd show)\n- Convoy details (gt convoy show)\n- Error messages (full command that failed)\n- Operation Center (running commands)\n\n## Acceptance Criteria\n- [ ] Renders command with args\n- [ ] Click copies to clipboard\n- [ ] Visual feedback on copy\n- [ ] Keyboard accessible\n- [ ] Monospace font for command\n- [ ] data-testid for testing\n- [ ] Works with long commands (truncation?)\n\n## Files\n- src/lib/components/CopyCli.svelte\n\n## References\n- INTEGRATION_PLAN: Power-User Ergonomics section","status":"open","priority":2,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-13T00:32:14.066552+05:30","created_by":"Avyukth","updated_at":"2026-01-13T00:32:14.066552+05:30","labels":["layer:ui","phase:1"]}
{"id":"gu-xcm","title":"Implement Svelte 5 reactive stores with runes","description":"# Svelte 5 Reactive Stores Implementation\n\n## Background\nSvelte 5 introduces runes ($state, $derived, $effect) for reactive state management.\nAll stores should use runes for consistency and optimal reactivity.\n\n## Why This Matters\n- Svelte 5 runes are more efficient than stores\n- Consistent reactivity model across app\n- Better TypeScript inference\n- Fine-grained updates (only affected components re-render)\n\n## Implementation Requirements\n\n### Store Pattern\n```typescript\n// src/lib/stores/work.svelte.ts\n\nimport { SWRCache } from '$lib/server/cache/swr';\n\nclass WorkStore {\n  items = $state\u003cWorkItem[]\u003e([]);\n  loading = $state(false);\n  error = $state\u003cstring | null\u003e(null);\n  \n  // Derived state\n  openItems = $derived(this.items.filter(i =\u003e i.status === 'open'));\n  highPriority = $derived(this.items.filter(i =\u003e i.priority \u003c= 1));\n  byType = $derived(\n    this.items.reduce((acc, item) =\u003e {\n      acc[item.issue_type] = [...(acc[item.issue_type] || []), item];\n      return acc;\n    }, {} as Record\u003cstring, WorkItem[]\u003e)\n  );\n  \n  async fetch() {\n    this.loading = true;\n    this.error = null;\n    try {\n      const response = await fetch('/api/gastown/work');\n      if (!response.ok) throw new Error(await response.text());\n      this.items = await response.json();\n    } catch (e) {\n      this.error = e instanceof Error ? e.message : 'Unknown error';\n    } finally {\n      this.loading = false;\n    }\n  }\n  \n  invalidate() {\n    // Called when server-side cache is invalidated\n    this.fetch();\n  }\n}\n\nexport const workStore = new WorkStore();\n```\n\n### Stores to Create\n1. **workStore**: Work items (tasks, issues, etc.)\n2. **convoyStore**: Convoys and their items\n3. **agentStore**: Agent status and health\n4. **mailStore**: Mail messages\n5. **rigStore**: Rig list and details\n6. **queueStore**: Merge queue items\n7. **operationsStore**: Running operations (Operation Center)\n\n### SSE Integration\n```typescript\n// Subscribe to SSE for real-time updates\nconst eventSource = new EventSource('/api/gastown/feed/stream');\neventSource.onmessage = (event) =\u003e {\n  const data = JSON.parse(event.data);\n  switch (data.type) {\n    case 'work_changed':\n      workStore.invalidate();\n      break;\n    case 'convoy_changed':\n      convoyStore.invalidate();\n      break;\n    // ...\n  }\n};\n```\n\n## Acceptance Criteria\n- [ ] All stores use Svelte 5 runes\n- [ ] Derived states computed automatically\n- [ ] Loading and error states tracked\n- [ ] SSE integration for real-time updates\n- [ ] TypeScript types inferred correctly\n- [ ] No reactivity warnings in console\n\n## Files\n- src/lib/stores/work.svelte.ts\n- src/lib/stores/convoys.svelte.ts\n- src/lib/stores/agents.svelte.ts\n- src/lib/stores/mail.svelte.ts\n- src/lib/stores/rigs.svelte.ts\n- src/lib/stores/queue.svelte.ts\n- src/lib/stores/operations.svelte.ts\n- src/lib/stores/sse.ts\n\n## References\n- INTEGRATION_PLAN: Reactive Stores section\n- Svelte 5 runes docs\n\n(Moved from hq-bpb.2)","status":"open","priority":1,"issue_type":"task","estimated_minutes":180,"created_at":"2026-01-12T23:12:58.470438+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:12:58.470438+05:30","labels":["layer:data","phase:1"]}
{"id":"gu-xif","title":"Implement SWR cache with configurable TTLs","description":"# SWR Cache Implementation\n\n## Background\nStale-While-Revalidate (SWR) serves cached data immediately while revalidating\nin the background. This provides instant perceived performance even when CLI\ncommands are slow.\n\n## Why This Matters\n- CLI commands take 500ms-2s\n- Users expect instant response\n- SWR shows stale data immediately\n- Background revalidation keeps data fresh\n- Cache hit rate \u003e 80% in steady state\n\n## Implementation Requirements\n\n### Core API\n```typescript\ninterface SWRCache\u003cT\u003e {\n  get(key: string, fetcher: () =\u003e Promise\u003cT\u003e, options?: SWROptions): Promise\u003cT\u003e;\n  invalidate(key: string): void;\n  invalidatePrefix(prefix: string): void;\n  getStats(): CacheStats;\n}\n\ninterface SWROptions {\n  staleTime?: number;      // Time before data is considered stale (default 30s)\n  cacheTime?: number;      // Time before cache entry is deleted (default 5m)\n  revalidateOnMount?: boolean;  // Revalidate when first accessed\n}\n\ninterface CacheStats {\n  hits: number;\n  misses: number;\n  staleHits: number;      // Served stale, revalidating\n  size: number;\n  entries: Map\u003cstring, CacheEntryStats\u003e;\n}\n```\n\n### Behavior\n```\nCache Hit (fresh) ‚Üí Return immediately\nCache Hit (stale) ‚Üí Return immediately + trigger background revalidation\nCache Miss ‚Üí Fetch + cache + return\n```\n\n### Invalidation Cascades\n```typescript\n// When work item changes, invalidate related caches\nonWorkItemChange(id) {\n  cache.invalidate(`work:${id}`);\n  cache.invalidate('work:list');\n  cache.invalidate('convoys:list'); // Convoy might include this item\n}\n```\n\n### TTL Presets\n```typescript\nconst TTL_PRESETS = {\n  status: 5000,        // System status (changes frequently)\n  agents: 10000,       // Agent list (changes occasionally)\n  convoys: 30000,      // Convoy list (changes rarely)\n  work: 10000,         // Work items (changes with activity)\n  mail: 5000,          // Mail (new messages)\n  capabilities: 3600000 // Capabilities (rarely changes)\n};\n```\n\n## Acceptance Criteria\n- [ ] Fresh cache hits return immediately\n- [ ] Stale hits return immediately + revalidate\n- [ ] Cache misses fetch and cache\n- [ ] TTLs configurable per cache key\n- [ ] Invalidation works for single keys and prefixes\n- [ ] Stats track hits/misses/stale\n- [ ] Unit tests cover all scenarios\n\n## Files\n- src/lib/server/cache/swr.ts\n- src/lib/server/cache/__tests__/swr.test.ts\n\n## References\n- INTEGRATION_PLAN D0.4: SWR Stale-While-Revalidate Caching\n- SWR library: https://swr.vercel.app/\n\n(Moved from hq-bpb.1)","status":"open","priority":1,"issue_type":"task","estimated_minutes":120,"created_at":"2026-01-12T23:12:58.569104+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:12:58.569104+05:30","labels":["layer:data","phase:1","priority:critical"]}
{"id":"gu-yd8","title":"Implement /api/gastown/status endpoint","description":"# Enhance /api/gastown/status endpoint\n\n## EXISTING IMPLEMENTATION\nThe endpoint EXISTS at `src/routes/api/gastown/status/+server.ts` but needs enhancements.\n\n### Current State (PARTIAL)\n- ‚úÖ Basic GET endpoint exists\n- ‚úÖ Calls `gt status --json`\n- ‚úÖ Returns JSON response\n- ‚ùå Uses `exec()` shell execution (SECURITY RISK)\n- ‚ùå Missing `--fast` flag (240ms slower)\n- ‚ùå No timeout handling\n- ‚ùå No circuit breaker\n- ‚ùå No Known Bug Detection integration\n- ‚ùå No cache headers\n\n## REQUIRED ENHANCEMENTS\n\n### 1. Migrate to Process Supervisor (CRITICAL)\nReplace shell execution with execFile:\n```typescript\n// BEFORE (INSECURE)\nconst { stdout } = await execAsync('gt status --json');\n\n// AFTER (SECURE)\nimport { processSupervisor } from '$lib/server/process-supervisor';\nconst result = await processSupervisor.exec('gt', ['status', '--fast', '--json']);\n```\n\n### 2. Add --fast flag\nPer INTEGRATION_PLAN v5.1, `--fast` flag skips mail lookups (~240ms faster):\n```typescript\n['status', '--fast', '--json']\n```\n\n### 3. Add Circuit Breaker\n```typescript\nconst result = await withCircuitBreaker(\n  'gt-status',\n  () =\u003e processSupervisor.exec('gt', ['status', '--fast', '--json']),\n  { timeout: 3000 }\n);\n```\n\n### 4. Add Known Bug Detection\n```typescript\nimport { identifyKnownBug } from '$lib/errors/known-bugs';\n\ncatch (error) {\n  const bug = identifyKnownBug(error.stderr);\n  return json({\n    error: {\n      code: bug?.id ?? 'CLI_ERROR',\n      message: bug?.userMessage ?? 'Status check failed',\n      category: bug?.category ?? 'CLI_ERROR',\n      recoverable: true,\n      suggestedAction: bug?.workaround ?? 'Check daemon status'\n    }\n  }, { status: 500 });\n}\n```\n\n### 5. Add Cache Headers\n```typescript\nsetHeaders({\n  'Cache-Control': 'public, max-age=10, stale-while-revalidate=30'\n});\n```\n\n### 6. Zod Validation\n```typescript\nconst status = GtStatusSchema.parse(JSON.parse(result.stdout));\n```\n\n## Acceptance Criteria\n- [ ] Uses Process Supervisor (execFile, not exec)\n- [ ] Uses --fast flag\n- [ ] Timeout: 3s\n- [ ] Cache-Control headers set\n- [ ] Circuit breaker protection\n- [ ] Known Bug Detection for errors\n- [ ] Response validates against GtStatusSchema\n- [ ] Unit tests with mocked CLI\n\n## Testing\n- [ ] Unit test: verify --fast flag is used\n- [ ] Unit test: verify timeout handling\n- [ ] Unit test: verify error response format\n- [ ] Integration test: call real endpoint\n\n## Files to Modify\n- src/routes/api/gastown/status/+server.ts (enhance existing)\n\n## Dependencies\n- gu-9t4: Process Supervisor (must be complete first)\n- gu-m5o: Circuit Breaker\n- gu-034d: Known Bug Detection\n- gu-dze: Zod Contracts","status":"open","priority":1,"issue_type":"task","estimated_minutes":60,"created_at":"2026-01-12T23:12:58.15537+05:30","created_by":"Avyukth","updated_at":"2026-01-13T01:14:57.206318+05:30","labels":["layer:api","phase:1"]}
{"id":"gu-ygmi","title":"Implement /api/gastown/snapshot coherent data endpoint","description":"# Snapshot Endpoint (Coherent Data Fetch)\n\n## Background\nDashboard needs multiple pieces of data (status, convoys, queue) that should\nbe fetched atomically to prevent UI inconsistency.\n\n## Endpoint\n```\nGET /api/gastown/snapshot\n```\n\n## Why This Matters\nWithout atomic fetch:\n- Status shows 5 agents\n- Convoys fetched 2 seconds later shows different counts\n- UI appears broken even though both are \"correct\"\n\n## Response\n```typescript\ninterface SnapshotResponse {\n  fetchedAt: string;  // ISO timestamp\n  status: GtStatus;\n  convoys: GtConvoy[];\n  queue: GtQueueSummary;\n  mail: { unread: number; total: number };\n  health: { status: 'healthy' | 'degraded' | 'unhealthy' };\n}\n```\n\n## Implementation\n```typescript\n// src/routes/api/gastown/snapshot/+server.ts\n\nexport async function GET({ request }) {\n  const requestId = crypto.randomUUID();\n  const fetchedAt = new Date().toISOString();\n  \n  // Fetch all data concurrently but return as atomic unit\n  const [statusResult, convoysResult, mailResult] = await Promise.all([\n    runGt(['status', '--json'], { schema: GtStatusSchema }),\n    runGt(['convoy', 'list', '--json'], { schema: z.array(GtConvoySchema) }),\n    runBd(['list', '--type=message', '--json'], { schema: z.array(GtMailMessageSchema) }),\n  ]);\n  \n  // Even if some fail, return what we have with degraded health\n  const health = computeHealth(statusResult, convoysResult, mailResult);\n  \n  return json({\n    fetchedAt,\n    status: statusResult.success ? statusResult.data : null,\n    convoys: convoysResult.success ? convoysResult.data : [],\n    queue: statusResult.success ? statusResult.data.queue : { pending: 0, in_progress: 0, total: 0 },\n    mail: {\n      unread: mailResult.success ? mailResult.data.filter(m =\u003e \\!m.read).length : 0,\n      total: mailResult.success ? mailResult.data.length : 0\n    },\n    health,\n    requestId\n  });\n}\n```\n\n## Caching\n- Cache entire snapshot for 5s (staleTime)\n- Single SWR key: 'snapshot'\n- Invalidate on any watched file change\n\n## Acceptance Criteria\n- [ ] Returns atomic snapshot of all dashboard data\n- [ ] Concurrent fetches for speed\n- [ ] Graceful degradation if some fail\n- [ ] Health status reflects data completeness\n- [ ] fetchedAt timestamp for staleness detection\n- [ ] Cached for 5 seconds\n- [ ] Single Zod schema for response\n\n## Files\n- src/routes/api/gastown/snapshot/+server.ts\n\n## References\n- INTEGRATION_PLAN: Coherent Data Fetch pattern","status":"open","priority":1,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-13T00:33:17.641102+05:30","created_by":"Avyukth","updated_at":"2026-01-13T00:33:17.641102+05:30","labels":["layer:api","phase:1"]}
{"id":"gu-yk5","title":"Phase 1 API Routes Sprint","description":"# Phase 1 API Routes Sprint\n\nAll /api/gastown/* endpoint implementations.\n\n## Scope\n- Status, Work, Convoys, Mail, Rigs, Queue, Agents endpoints\n- Diagnostics and Capabilities endpoints\n- SSE Feed stream\n\n## Dependencies\nFoundation (hq-ve0) and Data Layer (hq-bto) convoys\n\n## Exit Criteria\nAll API routes implemented with proper error handling.\n\n(Moved from hq-43u)","status":"open","priority":1,"issue_type":"convoy","created_at":"2026-01-12T23:11:40.571053+05:30","created_by":"Avyukth","updated_at":"2026-01-12T23:11:40.571053+05:30","labels":["phase:1","sprint:api"],"dependencies":[{"issue_id":"gu-yk5","depends_on_id":"gu-yd8","type":"blocks","created_at":"2026-01-12T23:23:20.444304+05:30","created_by":"Avyukth"},{"issue_id":"gu-yk5","depends_on_id":"gu-4po","type":"blocks","created_at":"2026-01-12T23:23:20.552732+05:30","created_by":"Avyukth"},{"issue_id":"gu-yk5","depends_on_id":"gu-5hp","type":"blocks","created_at":"2026-01-12T23:23:20.659548+05:30","created_by":"Avyukth"},{"issue_id":"gu-yk5","depends_on_id":"gu-ru7","type":"blocks","created_at":"2026-01-12T23:23:20.770703+05:30","created_by":"Avyukth"},{"issue_id":"gu-yk5","depends_on_id":"gu-enx","type":"blocks","created_at":"2026-01-12T23:23:20.887267+05:30","created_by":"Avyukth"},{"issue_id":"gu-yk5","depends_on_id":"gu-21j","type":"blocks","created_at":"2026-01-12T23:23:20.99889+05:30","created_by":"Avyukth"},{"issue_id":"gu-yk5","depends_on_id":"gu-r30","type":"blocks","created_at":"2026-01-12T23:23:21.10816+05:30","created_by":"Avyukth"},{"issue_id":"gu-yk5","depends_on_id":"gu-bwp","type":"blocks","created_at":"2026-01-12T23:23:21.217324+05:30","created_by":"Avyukth"},{"issue_id":"gu-yk5","depends_on_id":"gu-l2t","type":"blocks","created_at":"2026-01-12T23:23:21.32725+05:30","created_by":"Avyukth"},{"issue_id":"gu-yk5","depends_on_id":"gu-280","type":"blocks","created_at":"2026-01-12T23:23:21.433304+05:30","created_by":"Avyukth"},{"issue_id":"gu-yk5","depends_on_id":"gu-yoh","type":"blocks","created_at":"2026-01-12T23:23:21.538384+05:30","created_by":"Avyukth"},{"issue_id":"gu-yk5","depends_on_id":"gu-0tj","type":"blocks","created_at":"2026-01-12T23:23:21.644984+05:30","created_by":"Avyukth"},{"issue_id":"gu-yk5","depends_on_id":"gu-u4e","type":"blocks","created_at":"2026-01-12T23:23:21.748656+05:30","created_by":"Avyukth"},{"issue_id":"gu-yk5","depends_on_id":"gu-mao","type":"blocks","created_at":"2026-01-12T23:23:21.851457+05:30","created_by":"Avyukth"},{"issue_id":"gu-yk5","depends_on_id":"gu-0hi","type":"blocks","created_at":"2026-01-12T23:23:21.95556+05:30","created_by":"Avyukth"},{"issue_id":"gu-yk5","depends_on_id":"gu-pod","type":"blocks","created_at":"2026-01-12T23:25:18.190951+05:30","created_by":"Avyukth"},{"issue_id":"gu-yk5","depends_on_id":"gu-4si","type":"blocks","created_at":"2026-01-12T23:25:18.302272+05:30","created_by":"Avyukth"},{"issue_id":"gu-yk5","depends_on_id":"gu-i5j","type":"blocks","created_at":"2026-01-13T00:03:42.807484+05:30","created_by":"Avyukth"},{"issue_id":"gu-yk5","depends_on_id":"gu-9wo","type":"blocks","created_at":"2026-01-13T00:03:42.910841+05:30","created_by":"Avyukth"},{"issue_id":"gu-yk5","depends_on_id":"gu-963","type":"blocks","created_at":"2026-01-13T00:03:43.01943+05:30","created_by":"Avyukth"},{"issue_id":"gu-yk5","depends_on_id":"gu-nba","type":"blocks","created_at":"2026-01-13T00:03:43.119102+05:30","created_by":"Avyukth"},{"issue_id":"gu-yk5","depends_on_id":"gu-mri","type":"blocks","created_at":"2026-01-13T00:03:43.226305+05:30","created_by":"Avyukth"},{"issue_id":"gu-yk5","depends_on_id":"gu-ygmi","type":"blocks","created_at":"2026-01-13T00:37:28.756328+05:30","created_by":"Avyukth"},{"issue_id":"gu-yk5","depends_on_id":"gu-6gcr","type":"blocks","created_at":"2026-01-13T00:57:24.930229+05:30","created_by":"Avyukth"},{"issue_id":"gu-yk5","depends_on_id":"gu-x1zc","type":"blocks","created_at":"2026-01-13T00:57:25.036613+05:30","created_by":"Avyukth"}]}
{"id":"gu-yoh","title":"Implement /api/gastown/snapshot composite endpoint","description":"# Composite Snapshot Endpoint (v5.1 Priority)\n\n## Background (from INTEGRATION_PLAN v5.1)\nThe snapshot endpoint reduces dashboard load time by combining multiple queries\ninto a single request with server-side caching.\n\n## CLI Commands Combined\n```\ngt status --fast --json      ‚Üí status\nbd list --type=message --status=open --json | .length ‚Üí mailCount\ngt mq list --json | .length  ‚Üí queueCount\ntail -100 .events.jsonl      ‚Üí recentActivity\n```\n\n## Response Schema\n```typescript\ninterface GtSnapshot {\n  status: GtStatus;           // From: gt status --fast --json\n  mailCount: number;          // Unread mail count\n  queueCount: number;         // Merge queue size\n  recentActivity: GtFeedItem[]; // Last 100 events\n  freshness: {\n    fetchedAt: string;\n    ttlMs: number;\n  };\n}\n```\n\n## Performance Impact\n- Single HTTP request instead of 4 parallel requests\n- Server-side caching (10s TTL) amortizes CLI cost\n- Reduces dashboard P95 from ~2.5s to ~1.2s (first load)\n- Cached loads: \u003c100ms\n\n## Implementation Notes\n- Use --fast flag for gt status (skips mail lookups, saves ~240ms)\n- Cache TTL: 10 seconds\n- Use Process Supervisor for all CLI calls\n- Parallel execution of independent commands\n\n## Acceptance Criteria\n- [ ] Combines 4 data sources efficiently\n- [ ] Uses gt status --fast flag\n- [ ] 10s cache TTL\n- [ ] Returns freshness metadata\n- [ ] Dashboard uses this endpoint\n- [ ] Unit test with mocked CLI\n\n## Files\n- src/routes/api/gastown/snapshot/+server.ts\n- src/routes/api/gastown/snapshot/__tests__/server.test.ts\n\n## References\n- INTEGRATION_PLAN: Composite Snapshot Endpoint section\n- INTEGRATION_PLAN: CLI Performance Baselines\n\n(Moved from hq-0er.11)","status":"closed","priority":1,"issue_type":"task","estimated_minutes":90,"created_at":"2026-01-12T23:12:55.304419+05:30","created_by":"Avyukth","updated_at":"2026-01-13T01:12:39.962387+05:30","closed_at":"2026-01-13T01:12:39.962387+05:30","close_reason":"Duplicate of gu-ygmi (snapshot endpoint)","labels":["layer:api","phase:1","priority:critical"]}
{"id":"gu-yw5","title":"Digest: mol-refinery-patrol","description":"Patrol: queue empty, no branches processed","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-12T21:33:13.841695+05:30","updated_at":"2026-01-12T21:33:13.841695+05:30","closed_at":"2026-01-12T21:33:13.841645+05:30","close_reason":"Squashed from 11 wisps"}
{"id":"gu-z6je","title":"Implement Test ID Selectors constants","description":"# Test ID Selectors Constants\n\n## Background\nCentralized test selectors ensure consistency between component data-testid attributes and test queries.\n\n## Implementation\n```typescript\n// src/lib/test/selectors.ts\n\nexport const SELECTORS = {\n  // Navigation\n  NAV_RIGS: '[data-testid=\"nav-rigs\"]',\n  NAV_WORK: '[data-testid=\"nav-work\"]',\n  NAV_MAIL: '[data-testid=\"nav-mail\"]',\n  NAV_DASHBOARD: '[data-testid=\"nav-dashboard\"]',\n\n  // Rig Management\n  ADD_RIG_BTN: '[data-testid=\"add-rig-btn\"]',\n  RIG_NAME_INPUT: '[data-testid=\"rig-name-input\"]',\n  RIG_URL_INPUT: '[data-testid=\"rig-url-input\"]',\n  RIG_SUBMIT_BTN: '[data-testid=\"rig-submit-btn\"]',\n  RIG_LIST: '[data-testid=\"rig-list\"]',\n  RIG_ITEM: '[data-testid=\"rig-item\"]',\n\n  // Work Items\n  NEW_WORK_BTN: '[data-testid=\"new-work-btn\"]',\n  WORK_TITLE_INPUT: '[data-testid=\"work-title-input\"]',\n  WORK_PRIORITY_SELECT: '[data-testid=\"work-priority-select\"]',\n  WORK_LABELS_INPUT: '[data-testid=\"work-labels-input\"]',\n  WORK_SUBMIT_BTN: '[data-testid=\"work-submit-btn\"]',\n  WORK_LIST: '[data-testid=\"work-list\"]',\n  WORK_ITEM: '[data-testid=\"work-item\"]',\n\n  // Sling\n  SLING_BTN: '[data-testid=\"sling-btn\"]',\n  SLING_TARGET_SELECT: '[data-testid=\"sling-target-select\"]',\n  SLING_CONFIRM_BTN: '[data-testid=\"sling-confirm-btn\"]',\n\n  // Toast\n  TOAST: '[data-testid=\"toast\"]',\n  TOAST_MESSAGE: '[data-testid=\"toast-message\"]',\n  TOAST_ACTION: '[data-testid=\"toast-action\"]',\n\n  // Dynamic selectors\n  BEAD_ID: (id: string) =\u003e \\`[data-bead-id=\"\\${id}\"]\\`,\n  RIG_NAME: (name: string) =\u003e \\`[data-rig-name=\"\\${name}\"]\\`,\n  AGENT_NAME: (name: string) =\u003e \\`[data-agent-name=\"\\${name}\"]\\`,\n} as const;\n\n// Type for selector keys\nexport type SelectorKey = keyof typeof SELECTORS;\n```\n\n## Usage in Tests\n```typescript\nimport { SELECTORS } from '$lib/test/selectors';\nimport { screen } from '@testing-library/svelte';\n\n// Query elements\nconst addBtn = screen.getByTestId('add-rig-btn');\n// Or using selector\ndocument.querySelector(SELECTORS.ADD_RIG_BTN);\n```\n\n## Acceptance Criteria\n- [ ] All selectors from INTEGRATION_PLAN implemented\n- [ ] Type-safe selector keys\n- [ ] Dynamic selector helpers for IDs\n- [ ] Exported from $lib/test/index.ts\n- [ ] Used consistently across all tests\n\n## Files\n- src/lib/test/selectors.ts\n- src/lib/test/index.ts\n\n## References\n- INTEGRATION_PLAN: Test ID Conventions section","status":"open","priority":1,"issue_type":"task","owner":"subhrajit.makur@hotmail.com","created_at":"2026-01-13T01:01:27.625596+05:30","created_by":"Avyukth","updated_at":"2026-01-13T01:01:27.625596+05:30","labels":["layer:testing","phase:1","type:util"]}
{"id":"gu-zp7","title":"Digest: mol-refinery-patrol","description":"Patrol: MQ empty, no branches to process","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-12T19:46:00.119986+05:30","updated_at":"2026-01-12T19:46:00.119986+05:30","closed_at":"2026-01-12T19:46:00.119927+05:30","close_reason":"Squashed from 11 wisps"}
